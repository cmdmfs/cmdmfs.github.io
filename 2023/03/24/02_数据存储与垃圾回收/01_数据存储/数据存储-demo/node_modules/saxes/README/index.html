<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.8.0" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.8.0" type="image/png" sizes="32x32"><meta name="description" content="saxes       A sax-style non-validating parser for XML. Saxes is a fork of sax 1.2.4. All mentionsof sax in this project’s documentation are references to sax 1.2.4. Designed with n">
<meta property="og:type" content="article">
<meta property="og:title" content="汪汪队">
<meta property="og:url" content="http://example.com/2023/03/24/02_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E4%B8%8E%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/01_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8-demo/node_modules/saxes/README/index.html">
<meta property="og:site_name" content="汪汪队">
<meta property="og:description" content="saxes       A sax-style non-validating parser for XML. Saxes is a fork of sax 1.2.4. All mentionsof sax in this project’s documentation are references to sax 1.2.4. Designed with n">
<meta property="og:locale">
<meta property="article:published_time" content="2023-03-24T12:24:41.432Z">
<meta property="article:modified_time" content="1985-10-26T08:15:00.000Z">
<meta property="article:author" content="汪汪队">
<meta name="twitter:card" content="summary"><title>[ Untitled ] | 汪汪队</title><link ref="canonical" href="http://example.com/2023/03/24/02_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E4%B8%8E%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/01_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8-demo/node_modules/saxes/README/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.8.0"><link rel="stylesheet" href="css/custom.css"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"Copy","copySuccess":"Copy Success","copyError":"Copy Error"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 6.3.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">Home</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">Archives</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">Hello Stun</div><div class="header-banner-info__subtitle">An elegant theme for Hexo</div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">[ Untitled ]</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2023-03-24</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">1985-10-26</span></span></div></header><div class="post-body">
        <h1 id="saxes"   >
          <a href="#saxes" class="heading-link"><i class="fas fa-link"></i></a><a href="#saxes" class="headerlink" title="saxes"></a>saxes</h1>
      <p>A sax-style non-validating parser for XML.</p>
<p>Saxes is a fork of <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/isaacs/sax-js" >sax</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> 1.2.4. All mentions<br>of sax in this project’s documentation are references to sax 1.2.4.</p>
<p>Designed with <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://nodejs.org/" >node</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> in mind, but should work fine in the<br>browser or other CommonJS implementations.</p>
<p>Saxes does not support Node versions older than 10.</p>

        <h2 id="Notable-Differences-from-Sax"   >
          <a href="#Notable-Differences-from-Sax" class="heading-link"><i class="fas fa-link"></i></a><a href="#Notable-Differences-from-Sax" class="headerlink" title="Notable Differences from Sax."></a>Notable Differences from Sax.</h2>
      <ul>
<li><p>Saxes aims to be much stricter than sax with regards to XML<br>well-formedness. Sax, even in its so-called “strict mode”, is not strict. It<br>silently accepts structures that are not well-formed XML. Projects that need<br>better compliance with well-formedness constraints cannot use sax as-is.</p>
<p>Consequently, saxes does not support HTML, or pseudo-XML, or bad XML. Saxes<br>will report well-formedness errors in all these cases but it won’t try to<br>extract data from malformed documents like sax does.</p>
</li>
<li><p>Saxes is much much faster than sax, mostly because of a substantial redesign<br>of the internal parsing logic. The speed improvement is not merely due to<br>removing features that were supported by sax. That helped a bit, but saxes<br>adds some expensive checks in its aim for conformance with the XML<br>specification. Redesigning the parsing logic is what accounts for most of the<br>performance improvement.</p>
</li>
<li><p>Saxes does not aim to support antiquated platforms. We will not pollute the<br>source or the default build with support for antiquated platforms. If you want<br>support for IE 11, you are welcome to produce a PR that adds a <em>new build</em><br>transpiled to ES5.</p>
</li>
<li><p>Saxes handles errors differently from sax: it provides a default onerror<br>handler which throws. You can replace it with your own handler if you want. If<br>your handler does nothing, there is no <code>resume</code> method to call.</p>
</li>
<li><p>There’s no <code>Stream</code> API. A revamped API may be introduced later. (It is still<br>a “streaming parser” in the general sense that you write a character stream to<br>it.)</p>
</li>
<li><p>Saxes does not have facilities for limiting the size the data chunks passed to<br>event handlers. See the FAQ entry for more details.</p>
</li>
</ul>

        <h2 id="Conformance"   >
          <a href="#Conformance" class="heading-link"><i class="fas fa-link"></i></a><a href="#Conformance" class="headerlink" title="Conformance"></a>Conformance</h2>
      <p>Saxes supports:</p>
<ul>
<li><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.w3.org/TR/2008/REC-xml-20081126/" >XML 1.0 fifth edition</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
<li><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.w3.org/TR/2006/REC-xml11-20060816/" >XML 1.1 second edition</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
<li><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.w3.org/TR/2009/REC-xml-names-20091208/" >Namespaces in XML 1.0 (Third Edition)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>.</li>
<li><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.w3.org/TR/2006/REC-xml-names11-20060816/" >Namespaces in XML 1.1 (Second Edition)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>.</li>
</ul>

        <h2 id="Limitations"   >
          <a href="#Limitations" class="heading-link"><i class="fas fa-link"></i></a><a href="#Limitations" class="headerlink" title="Limitations"></a>Limitations</h2>
      <p>This is a non-validating parser so it only verifies whether the document is<br>well-formed. We do aim to raise errors for all malformed constructs<br>encountered. However, this parser does not thorougly parse the contents of<br>DTDs. So most malformedness errors caused by errors <strong>in DTDs</strong> cannot be<br>reported.</p>

        <h2 id="Regarding-lt-DOCTYPE-and-lt-ENTITY"   >
          <a href="#Regarding-lt-DOCTYPE-and-lt-ENTITY" class="heading-link"><i class="fas fa-link"></i></a><a href="#Regarding-lt-DOCTYPE-and-lt-ENTITY" class="headerlink" title="Regarding &lt;!DOCTYPE and &lt;!ENTITY"></a>Regarding <code>&lt;!DOCTYPE</code> and <code>&lt;!ENTITY</code></h2>
      <p>The parser will handle the basic XML entities in text nodes and attribute<br>values: <code>&amp;amp; &amp;lt; &amp;gt; &amp;apos; &amp;quot;</code>. It’s possible to define additional<br>entities in XML by putting them in the DTD. This parser doesn’t do anything with<br>that. If you want to listen to the <code>doctype</code> event, and then fetch the<br>doctypes, and read the entities and add them to <code>parser.ENTITIES</code>, then be my<br>guest.</p>

        <h2 id="Documentation"   >
          <a href="#Documentation" class="heading-link"><i class="fas fa-link"></i></a><a href="#Documentation" class="headerlink" title="Documentation"></a>Documentation</h2>
      <p>The source code contains JSDOC comments. Use them. What follows is a brief<br>summary of what is available. The final authority is the source code.</p>
<p><strong>PAY CLOSE ATTENTION TO WHAT IS PUBLIC AND WHAT IS PRIVATE.</strong></p>
<p>The move to TypeScript makes it so that everything is now formally private,<br>protected, or public.</p>
<p>If you use anything not public, that’s at your own peril.</p>
<p>If there’s a mistake in the documentation, raise an issue. If you just assume,<br>you may assume incorrectly.</p>

        <h2 id="Summary-Usage-Information"   >
          <a href="#Summary-Usage-Information" class="heading-link"><i class="fas fa-link"></i></a><a href="#Summary-Usage-Information" class="headerlink" title="Summary Usage Information"></a>Summary Usage Information</h2>
      
        <h3 id="Example"   >
          <a href="#Example" class="heading-link"><i class="fas fa-link"></i></a><a href="#Example" class="headerlink" title="Example"></a>Example</h3>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> saxes = <span class="built_in">require</span>(<span class="string">&quot;./lib/saxes&quot;</span>),</span><br><span class="line">  parser = <span class="keyword">new</span> saxes.<span class="title class_">SaxesParser</span>();</span><br><span class="line"></span><br><span class="line">parser.<span class="title function_">on</span>(<span class="string">&quot;error&quot;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="comment">// an error happened.</span></span><br><span class="line">&#125;);</span><br><span class="line">parser.<span class="title function_">on</span>(<span class="string">&quot;text&quot;</span>, <span class="keyword">function</span> (<span class="params">t</span>) &#123;</span><br><span class="line">  <span class="comment">// got some text.  t is the string of text.</span></span><br><span class="line">&#125;);</span><br><span class="line">parser.<span class="title function_">on</span>(<span class="string">&quot;opentag&quot;</span>, <span class="keyword">function</span> (<span class="params">node</span>) &#123;</span><br><span class="line">  <span class="comment">// opened a tag.  node has &quot;name&quot; and &quot;attributes&quot;</span></span><br><span class="line">&#125;);</span><br><span class="line">parser.<span class="title function_">on</span>(<span class="string">&quot;end&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// parser stream is done, and ready to have more stuff written to it.</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">parser.<span class="title function_">write</span>(<span class="string">&#x27;&lt;xml&gt;Hello, &lt;who name=&quot;world&quot;&gt;world&lt;/who&gt;!&lt;/xml&gt;&#x27;</span>).<span class="title function_">close</span>();</span><br></pre></td></tr></table></div></figure>


        <h3 id="Constructor-Arguments"   >
          <a href="#Constructor-Arguments" class="heading-link"><i class="fas fa-link"></i></a><a href="#Constructor-Arguments" class="headerlink" title="Constructor Arguments"></a>Constructor Arguments</h3>
      <p>Settings supported:</p>
<ul>
<li><p><code>xmlns</code> - Boolean. If <code>true</code>, then namespaces are supported. Default<br>is <code>false</code>.</p>
</li>
<li><p><code>position</code> - Boolean. If <code>false</code>, then don’t track line&#x2F;col&#x2F;position. Unset is<br>treated as <code>true</code>. Default is unset. Currently, setting this to <code>false</code> only<br>results in a cosmetic change: the errors reported do not contain position<br>information. sax-js would literally turn off the position-computing logic if<br>this flag was set to false. The notion was that it would optimize<br>execution. In saxes at least it turns out that continually testing this flag<br>causes a cost that offsets the benefits of turning off this logic.</p>
</li>
<li><p><code>fileName</code> - String. Set a file name for error reporting. This is useful only<br>when tracking positions. You may leave it unset.</p>
</li>
<li><p><code>fragment</code> - Boolean. If <code>true</code>, parse the XML as an XML fragment. Default is<br><code>false</code>.</p>
</li>
<li><p><code>additionalNamespaces</code> - A plain object whose key, value pairs define<br> namespaces known before parsing the XML file. It is not legal to pass<br> bindings for the namespaces <code>&quot;xml&quot;</code> or <code>&quot;xmlns&quot;</code>.</p>
</li>
<li><p><code>defaultXMLVersion</code> - The default version of the XML specification to use if<br>the document contains no XML declaration. If the document does contain an XML<br>declaration, then this setting is ignored. Must be <code>&quot;1.0&quot;</code> or <code>&quot;1.1&quot;</code>. The<br>default is <code>&quot;1.0&quot;</code>.</p>
</li>
<li><p><code>forceXMLVersion</code> - Boolean. A flag indicating whether to force the XML<br>version used for parsing to the value of <code>defaultXMLVersion</code>. When this flag<br>is <code>true</code>, <code>defaultXMLVersion</code> must be specified. If unspecified, the<br>default value of this flag is <code>false</code>.</p>
<p>Example: suppose you are parsing a document that has an XML declaration<br>specifying XML version 1.1.</p>
<p>If you set <code>defaultXMLVersion</code> to <code>&quot;1.0&quot;</code> without setting<br><code>forceXMLVersion</code> then the XML declaration will override the value of<br><code>defaultXMLVersion</code> and the document will be parsed according to XML 1.1.</p>
<p>If you set <code>defaultXMLVersion</code> to <code>&quot;1.0&quot;</code> and set <code>forceXMLVersion</code> to<br><code>true</code>, then the XML declaration will be ignored and the document will be<br>parsed according to XML 1.0.</p>
</li>
</ul>

        <h3 id="Methods"   >
          <a href="#Methods" class="heading-link"><i class="fas fa-link"></i></a><a href="#Methods" class="headerlink" title="Methods"></a>Methods</h3>
      <p><code>write</code> - Write bytes onto the stream. You don’t have to pass the whole document<br>in one <code>write</code> call. You can read your source chunk by chunk and call <code>write</code><br>with each chunk.</p>
<p><code>close</code> - Close the stream. Once closed, no more data may be written until it is<br>done processing the buffer, which is signaled by the <code>end</code> event.</p>

        <h3 id="Properties"   >
          <a href="#Properties" class="heading-link"><i class="fas fa-link"></i></a><a href="#Properties" class="headerlink" title="Properties"></a>Properties</h3>
      <p>The parser has the following properties:</p>
<p><code>line</code>, <code>column</code>, <code>columnIndex</code>, <code>position</code> - Indications of the position in the<br>XML document where the parser currently is looking. The <code>columnIndex</code> property<br>counts columns as if indexing into a JavaScript string, whereas the <code>column</code><br>property counts Unicode characters.</p>
<p><code>closed</code> - Boolean indicating whether or not the parser can be written to.  If<br>it’s <code>true</code>, then wait for the <code>ready</code> event to write again.</p>
<p><code>opt</code> - Any options passed into the constructor.</p>
<p><code>xmlDecl</code> - The XML declaration for this document. It contains the fields<br><code>version</code>, <code>encoding</code> and <code>standalone</code>. They are all <code>undefined</code> before<br>encountering the XML declaration. If they are undefined after the XML<br>declaration, the corresponding value was not set by the declaration. There is no<br>event associated with the XML declaration. In a well-formed document, the XML<br>declaration may be preceded only by an optional BOM. So by the time any event<br>generated by the parser happens, the declaration has been processed if present<br>at all. Otherwise, you have a malformed document, and as stated above, you<br>cannot rely on the parser data!</p>

        <h3 id="Error-Handling"   >
          <a href="#Error-Handling" class="heading-link"><i class="fas fa-link"></i></a><a href="#Error-Handling" class="headerlink" title="Error Handling"></a>Error Handling</h3>
      <p>The parser continues to parse even upon encountering errors, and does its best<br>to continue reporting errors. You should heed all errors reported. After an<br>error, however, saxes may interpret your document incorrectly. For instance<br><code>&lt;foo a=bc=&quot;d&quot;/&gt;</code> is invalid XML. Did you mean to have <code>&lt;foo a=&quot;bc=d&quot;/&gt;</code> or<br><code>&lt;foo a=&quot;b&quot; c=&quot;d&quot;/&gt;</code> or some other variation?  For the sake of continuing to<br>provide errors, saxes will continue parsing the document, but the structure it<br>reports may be incorrect. It is only after the errors are fixed in the document<br>that saxes can provide a reliable interpretation of the document.</p>
<p>That leaves you with two rules of thumb when using saxes:</p>
<ul>
<li><p>Pay attention to the errors that saxes report. The default <code>onerror</code> handler<br>throws, so by default, you cannot miss errors.</p>
</li>
<li><p><strong>ONCE AN ERROR HAS BEEN ENCOUNTERED, STOP RELYING ON THE EVENT HANDLERS OTHER<br>THAN <code>onerror</code>.</strong> As explained above, when saxes runs into a well-formedness<br>problem, it makes a guess in order to continue reporting more errors. The guess<br>may be wrong.</p>
</li>
</ul>

        <h3 id="Events"   >
          <a href="#Events" class="heading-link"><i class="fas fa-link"></i></a><a href="#Events" class="headerlink" title="Events"></a>Events</h3>
      <p>To listen to an event, override <code>on&lt;eventname&gt;</code>. The list of supported events<br>are also in the exported <code>EVENTS</code> array.</p>
<p>See the JSDOC comments in the source code for a description of each supported<br>event.</p>

        <h3 id="Parsing-XML-Fragments"   >
          <a href="#Parsing-XML-Fragments" class="heading-link"><i class="fas fa-link"></i></a><a href="#Parsing-XML-Fragments" class="headerlink" title="Parsing XML Fragments"></a>Parsing XML Fragments</h3>
      <p>The XML specification does not define any method by which to parse XML<br>fragments. However, there are usage scenarios in which it is desirable to parse<br>fragments. In order to allow this, saxes provides three initialization options.</p>
<p>If you pass the option <code>fragment: true</code> to the parser constructor, the parser<br>will expect an XML fragment. It essentially starts with a parsing state<br>equivalent to the one it would be in if <code>parser.write(&quot;&lt;foo&quot;&gt;)</code> had been called<br>right after initialization. In other words, it expects content which is<br>acceptable inside an element. This also turns off well-formedness checks that<br>are inappropriate when parsing a fragment.</p>
<p>The option <code>additionalNamespaces</code> allows you to define additional prefix-to-URI<br>bindings known before parsing starts. You would use this over <code>resolvePrefix</code> if<br>you have at the ready a series of namespaces bindings to use.</p>
<p>The option <code>resolvePrefix</code> allows you to pass a function which saxes will use if<br>it is unable to resolve a namespace prefix by itself. You would use this over<br><code>additionalNamespaces</code> in a context where getting a complete list of defined<br>namespaces is onerous.</p>
<p>Note that you can use <code>additionalNamespaces</code> and <code>resolvePrefix</code> together if you<br>want. <code>additionalNamespaces</code> applies before <code>resolvePrefix</code>.</p>
<p>The options <code>additionalNamespaces</code> and <code>resolvePrefix</code> are really meant to be<br>used for parsing fragments. However, saxes won’t prevent you from using them<br>with <code>fragment: false</code>. Note that if you do this, your document may parse<br>without errors and yet be malformed because the document can refer to namespaces<br>which are not defined <em>in</em> the document.</p>
<p>Of course, <code>additionalNamespaces</code> and <code>resolvePrefix</code> are used only if <code>xmlns</code><br>is <code>true</code>. If you are parsing a fragment that does not use namespaces, there’s<br>no point in setting these options.</p>

        <h3 id="Performance-Tips"   >
          <a href="#Performance-Tips" class="heading-link"><i class="fas fa-link"></i></a><a href="#Performance-Tips" class="headerlink" title="Performance Tips"></a>Performance Tips</h3>
      <ul>
<li><p>saxes works faster on files that use newlines (<code>\u000A</code>) as end of line<br>markers than files that use other end of line markers (like <code>\r</code> or<br><code>\r\n</code>). The XML specification requires that conformant applications behave<br>as if all characters that are to be treated as end of line characters are<br>converted to <code>\u000A</code> prior to parsing. The optimal code path for saxes is a<br>file in which all end of line characters are already <code>\u000A</code>.</p>
</li>
<li><p>Don’t split Unicode strings you feed to saxes across surrogates. When you<br>naively split a string in JavaScript, you run the risk of splitting a Unicode<br>character into two surrogates. e.g.  In the following example <code>a</code> and <code>b</code><br>each contain half of a single Unicode character: <code>const a = &quot;\u&#123;1F4A9&#125;&quot;[0]; const b = &quot;\u&#123;1F4A9&#125;&quot;[1]</code> If you feed such split surrogates to versions of<br>saxes prior to 4, you’d get errors. Saxes version 4 and over are able to<br>detect when a chunk of data ends with a surrogate and carry over the surrogate<br>to the next chunk. However this operation entails slicing and concatenating<br>strings. If you can feed your data in a way that does not split surrogates,<br>you should do it. (Obviously, feeding all the data at once with a single write<br>is fastest.)</p>
</li>
<li><p>Don’t set event handlers you don’t need. Saxes has always aimed to avoid doing<br>work that will just be tossed away but future improvements hope to do this<br>more aggressively. One way saxes knows whether or not some data is needed is<br>by checking whether a handler has been set for a specific event.</p>
</li>
</ul>

        <h2 id="FAQ"   >
          <a href="#FAQ" class="heading-link"><i class="fas fa-link"></i></a><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2>
      <p>Q. Why has saxes dropped support for limiting the size of data chunks passed to<br>event handlers?</p>
<p>A. With sax you could set <code>MAX_BUFFER_LENGTH</code> to cause the parser to limit the<br>size of data chunks passed to event handlers. So if you ran into a span of text<br>above the limit, multiple <code>text</code> events with smaller data chunks were fired<br>instead of a single event with a large chunk.</p>
<p>However, that functionality had some problematic characteristics. It had an<br>arbitrary default value. It was library-wide so all parsers created from a<br>single instance of the <code>sax</code> library shared it. This could potentially cause<br>conflicts among libraries running in the same VM but using sax for different<br>purposes.</p>
<p>These issues could have been easily fixed, but there were larger issues. The<br>buffer limit arbitrarily applied to some events but not others. It would split<br><code>text</code>, <code>cdata</code> and <code>script</code> events. However, if a <code>comment</code>,<br><code>doctype</code>, <code>attribute</code> or <code>processing instruction</code> were more than the<br>limit, the parser would generate an error and you were left picking up the<br>pieces.</p>
<p>It was not intuitive to use. You’d think setting the limit to 1K would prevent<br>chunks bigger than 1K to be passed to event handlers. But that was not the<br>case. A comment in the source code told you that you might go over the limit if<br>you passed large chunks to <code>write</code>. So if you want a 1K limit, don’t pass 64K<br>chunks to <code>write</code>. Fair enough. You know what limit you want so you can<br>control the size of the data you pass to <code>write</code>. So you limit the chunks to<br><code>write</code> to 1K at a time. Even if you do this, your event handlers may get data<br>chunks that are 2K in size. Suppose on the previous <code>write</code> the parser has<br>just finished processing an open tag, so it is ready for text. Your <code>write</code><br>passes 1K of text. You are not above the limit yet, so no event is generated<br>yet. The next <code>write</code> passes another 1K of text. It so happens that sax checks<br>buffer limits only once per <code>write</code>, after the chunk of data has been<br>processed. Now you’ve hit the limit and you get a <code>text</code> event with 2K of<br>data. So even if you limit your <code>write</code> calls to the buffer limit you’ve set,<br>you may still get events with chunks at twice the buffer size limit you’ve<br>specified.</p>
<p>We may consider reinstating an equivalent functionality, provided that it<br>addresses the issues above and does not cause a huge performance drop for<br>use-case scenarios that don’t need it.</p>
</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ END ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">Author: </span><span class="copyright-author__value"><a href="http://example.com">汪汪队</a></span></div><div class="copyright-link"><span class="copyright-link__name">Link: </span><span class="copyright-link__value"><a href="http://example.com/2023/03/24/02_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E4%B8%8E%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/01_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8-demo/node_modules/saxes/README/">http://example.com/2023/03/24/02_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E4%B8%8E%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/01_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8-demo/node_modules/saxes/README/</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">Copyright: </span><span class="copyright-notice__value">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="external nofollow" target="_blank">BY-NC-SA</a> unless stating additionally</span></div></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/2023/03/24/02_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E4%B8%8E%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/01_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8-demo/node_modules/source-map/CHANGELOG/"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">[ Untitled ]</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/2023/03/24/02_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E4%B8%8E%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/01_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8-demo/node_modules/safer-buffer/Readme/"><span class="paginator-prev__text">[ Untitled ]</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">Catalog</span><span class="sidebar-nav-ov">Overview</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#saxes"><span class="toc-number">1.</span> <span class="toc-text">
          saxes</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Notable-Differences-from-Sax"><span class="toc-number">1.1.</span> <span class="toc-text">
          Notable Differences from Sax.</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Conformance"><span class="toc-number">1.2.</span> <span class="toc-text">
          Conformance</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Limitations"><span class="toc-number">1.3.</span> <span class="toc-text">
          Limitations</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Regarding-lt-DOCTYPE-and-lt-ENTITY"><span class="toc-number">1.4.</span> <span class="toc-text">
          Regarding &lt;!DOCTYPE and &lt;!ENTITY</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Documentation"><span class="toc-number">1.5.</span> <span class="toc-text">
          Documentation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Summary-Usage-Information"><span class="toc-number">1.6.</span> <span class="toc-text">
          Summary Usage Information</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Example"><span class="toc-number">1.6.1.</span> <span class="toc-text">
          Example</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Constructor-Arguments"><span class="toc-number">1.6.2.</span> <span class="toc-text">
          Constructor Arguments</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Methods"><span class="toc-number">1.6.3.</span> <span class="toc-text">
          Methods</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Properties"><span class="toc-number">1.6.4.</span> <span class="toc-text">
          Properties</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Error-Handling"><span class="toc-number">1.6.5.</span> <span class="toc-text">
          Error Handling</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Events"><span class="toc-number">1.6.6.</span> <span class="toc-text">
          Events</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Parsing-XML-Fragments"><span class="toc-number">1.6.7.</span> <span class="toc-text">
          Parsing XML Fragments</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Performance-Tips"><span class="toc-number">1.6.8.</span> <span class="toc-text">
          Performance Tips</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FAQ"><span class="toc-number">1.7.</span> <span class="toc-text">
          FAQ</span></a></li></ol></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/icons/cat.jpg" alt="avatar"></div><p class="sidebar-ov-author__text">Hello Stun</p></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">144</div><div class="sidebar-ov-state-item__name">Archives</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="Creative Commons" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">You have read </span><span class="sidebar-reading-info__num">0</span><span class="sidebar-reading-info__perc">%</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2023</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>汪汪队</span></div><div><span>Powered by <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a></span><span> v6.3.0</span><span class="footer__devider">|</span><span>Theme - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.8.0</span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="/js/utils.js?v=2.8.0"></script><script src="/js/stun-boot.js?v=2.8.0"></script><script src="/js/scroll.js?v=2.8.0"></script><script src="/js/header.js?v=2.8.0"></script><script src="/js/sidebar.js?v=2.8.0"></script></body></html>