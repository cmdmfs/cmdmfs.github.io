<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.8.0" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.8.0" type="image/png" sizes="32x32"><meta name="description" content="have a try try">
<meta property="og:type" content="website">
<meta property="og:title" content="汪汪队">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="汪汪队">
<meta property="og:description" content="have a try try">
<meta property="og:locale">
<meta property="article:author" content="汪汪队">
<meta name="twitter:card" content="summary"><title>汪汪队</title><link ref="canonical" href="http://example.com/page/2/index.html"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.8.0"><link rel="stylesheet" href="css/custom.css"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"Copy","copySuccess":"Copy Success","copyError":"Copy Error"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 6.3.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">Home</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">Archives</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">Hello Stun</div><div class="header-banner-info__subtitle">An elegant theme for Hexo</div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content content-home" id="content"><section class="postlist"><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2023/03/24/02_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E4%B8%8E%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/01_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8-demo/node_modules/xml-name-validator/README/">[ Untitled ]</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2023-03-24</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2015-02-25</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="Validate-XML-Names-and-Qualified-Names"   >
          <a href="#Validate-XML-Names-and-Qualified-Names" class="heading-link"><i class="fas fa-link"></i></a><a href="#Validate-XML-Names-and-Qualified-Names" class="headerlink" title="Validate XML Names and Qualified Names"></a>Validate XML Names and Qualified Names</h1>
      <p>This package simply tells you whether or not a string matches the <a target="_blank" rel="noopener" href="http://www.w3.org/TR/xml/#NT-Name"><code>Name</code></a> or <a target="_blank" rel="noopener" href="http://www.w3.org/TR/xml-names/#NT-QName"><code>QName</code></a> productions in the XML Namespaces specification. We use it for implementing the <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://dom.spec.whatwg.org/#validate" >validate</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> algorithm in jsdom, but you can use it for whatever you want.</p>

        <h2 id="Usage"   >
          <a href="#Usage" class="heading-link"><i class="fas fa-link"></i></a><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2>
      <p>This package’s main module’s default export takes a string and will return an object of the form <code>&#123; success, error &#125;</code>, where <code>success</code> is a boolean and if it is <code>false</code>, then <code>error</code> is a string containing some hint as to where the match went wrong.</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span>:</span><br><span class="line"><span class="keyword">var</span> xnv = <span class="built_in">require</span>(<span class="string">&quot;xml-name-validator&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> assert = <span class="built_in">require</span>(<span class="string">&quot;assert&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Will return &#123; success: true, error: undefined &#125;</span></span><br><span class="line">xnv.<span class="title function_">name</span>(<span class="string">&quot;x&quot;</span>);</span><br><span class="line">xnv.<span class="title function_">name</span>(<span class="string">&quot;:&quot;</span>);</span><br><span class="line">xnv.<span class="title function_">name</span>(<span class="string">&quot;a:0&quot;</span>);</span><br><span class="line">xnv.<span class="title function_">name</span>(<span class="string">&quot;a:b:c&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Will return &#123; success: false, error: &lt;an explanatory string&gt; &#125;</span></span><br><span class="line">xnv.<span class="title function_">name</span>(<span class="string">&quot;\\&quot;</span>);</span><br><span class="line">xnv.<span class="title function_">name</span>(<span class="string">&quot;&#x27;&quot;</span>);</span><br><span class="line">xnv.<span class="title function_">name</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">xnv.<span class="title function_">name</span>(<span class="string">&quot;a!&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Will return &#123; success: true, error: undefined &#125;</span></span><br><span class="line">xnv.<span class="title function_">qname</span>(<span class="string">&quot;x&quot;</span>);</span><br><span class="line">xnv.<span class="title function_">qname</span>(<span class="string">&quot;a0&quot;</span>);</span><br><span class="line">xnv.<span class="title function_">qname</span>(<span class="string">&quot;a:b&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Will return &#123; success: false, error: &lt;an explanatory string&gt; &#125;</span></span><br><span class="line">xnv.<span class="title function_">qname</span>(<span class="string">&quot;:a&quot;</span>);</span><br><span class="line">xnv.<span class="title function_">qname</span>(<span class="string">&quot;:b&quot;</span>);</span><br><span class="line">xnv.<span class="title function_">qname</span>(<span class="string">&quot;a:b:c&quot;</span>);</span><br><span class="line">xnv.<span class="title function_">qname</span>(<span class="string">&quot;a:0&quot;</span>);</span><br></pre></td></tr></table></div></figure>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2023/03/24/02_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E4%B8%8E%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/01_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8-demo/node_modules/ws/README/">[ Untitled ]</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2023-03-24</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">1985-10-26</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="ws-a-Node-js-WebSocket-library"   >
          <a href="#ws-a-Node-js-WebSocket-library" class="heading-link"><i class="fas fa-link"></i></a><a href="#ws-a-Node-js-WebSocket-library" class="headerlink" title="ws: a Node.js WebSocket library"></a>ws: a Node.js WebSocket library</h1>
      <p><a target="_blank" rel="noopener" href="https://www.npmjs.com/package/ws"><img   src="https://img.shields.io/npm/v/ws.svg?logo=npm" style=""  alt="Version npm"></a><br><a target="_blank" rel="noopener" href="https://github.com/websockets/ws/actions?query=workflow:CI+branch:master"><img   src="https://img.shields.io/github/workflow/status/websockets/ws/CI/master?label=build&logo=github" style=""  alt="Build"></a><br><a target="_blank" rel="noopener" href="https://ci.appveyor.com/project/lpinca/ws"><img   src="https://img.shields.io/appveyor/ci/lpinca/ws/master.svg?logo=appveyor" style=""  alt="Windows x86 Build"></a><br><a target="_blank" rel="noopener" href="https://coveralls.io/github/websockets/ws"><img src="https://img.shields.io/coveralls/websockets/ws/master.svg" alt="Coverage Status"></a></p>
<p>ws is a simple to use, blazing fast, and thoroughly tested WebSocket client and<br>server implementation.</p>
<p>Passes the quite extensive Autobahn test suite: <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://websockets.github.io/ws/autobahn/servers/" >server</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>,<br><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://websockets.github.io/ws/autobahn/clients/" >client</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>.</p>
<p><strong>Note</strong>: This module does not work in the browser. The client in the docs is a<br>reference to a back end with the role of a client in the WebSocket<br>communication. Browser clients must use the native<br><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/WebSocket"><code>WebSocket</code></a><br>object. To make the same code work seamlessly on Node.js and the browser, you<br>can use one of the many wrappers available on npm, like<br><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/heineiuo/isomorphic-ws" >isomorphic-ws</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>.</p>

        <h2 id="Table-of-Contents"   >
          <a href="#Table-of-Contents" class="heading-link"><i class="fas fa-link"></i></a><a href="#Table-of-Contents" class="headerlink" title="Table of Contents"></a>Table of Contents</h2>
      <ul>
<li><a href="#protocol-support">Protocol support</a></li>
<li><a href="#installing">Installing</a><ul>
<li><a href="#opt-in-for-performance-and-spec-compliance">Opt-in for performance and spec compliance</a></li>
</ul>
</li>
<li><a href="#api-docs">API docs</a></li>
<li><a href="#websocket-compression">WebSocket compression</a></li>
<li><a href="#usage-examples">Usage examples</a><ul>
<li><a href="#sending-and-receiving-text-data">Sending and receiving text data</a></li>
<li><a href="#sending-binary-data">Sending binary data</a></li>
<li><a href="#simple-server">Simple server</a></li>
<li><a href="#external-https-server">External HTTP&#x2F;S server</a></li>
<li><a href="#multiple-servers-sharing-a-single-https-server">Multiple servers sharing a single HTTP&#x2F;S server</a></li>
<li><a href="#client-authentication">Client authentication</a></li>
<li><a href="#server-broadcast">Server broadcast</a></li>
<li><a href="#echowebsocketorg-demo">echo.websocket.org demo</a></li>
<li><a href="#use-the-nodejs-streams-api">Use the Node.js streams API</a></li>
<li><a href="#other-examples">Other examples</a></li>
</ul>
</li>
<li><a href="#faq">FAQ</a><ul>
<li><a href="#how-to-get-the-ip-address-of-the-client">How to get the IP address of the client?</a></li>
<li><a href="#how-to-detect-and-close-broken-connections">How to detect and close broken connections?</a></li>
<li><a href="#how-to-connect-via-a-proxy">How to connect via a proxy?</a></li>
</ul>
</li>
<li><a href="#changelog">Changelog</a></li>
<li><a href="#license">License</a></li>
</ul>

        <h2 id="Protocol-support"   >
          <a href="#Protocol-support" class="heading-link"><i class="fas fa-link"></i></a><a href="#Protocol-support" class="headerlink" title="Protocol support"></a>Protocol support</h2>
      <ul>
<li><strong>HyBi drafts 07-12</strong> (Use the option <code>protocolVersion: 8</code>)</li>
<li><strong>HyBi drafts 13-17</strong> (Current default, alternatively option<br><code>protocolVersion: 13</code>)</li>
</ul>

        <h2 id="Installing"   >
          <a href="#Installing" class="heading-link"><i class="fas fa-link"></i></a><a href="#Installing" class="headerlink" title="Installing"></a>Installing</h2>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install ws</span><br></pre></td></tr></table></div></figure>


        <h3 id="Opt-in-for-performance"   >
          <a href="#Opt-in-for-performance" class="heading-link"><i class="fas fa-link"></i></a><a href="#Opt-in-for-performance" class="headerlink" title="Opt-in for performance"></a>Opt-in for performance</h3>
      <p>There are 2 optional modules that can be installed along side with the ws<br>module. These modules are binary addons which improve certain operations.<br>Prebuilt binaries are available for the most popular platforms so you don’t<br>necessarily need to have a C++ compiler installed on your machine.</p>
<ul>
<li><code>npm install --save-optional bufferutil</code>: Allows to efficiently perform<br>operations such as masking and unmasking the data payload of the WebSocket<br>frames.</li>
<li><code>npm install --save-optional utf-8-validate</code>: Allows to efficiently check if a<br>message contains valid UTF-8.</li>
</ul>

        <h2 id="API-docs"   >
          <a href="#API-docs" class="heading-link"><i class="fas fa-link"></i></a><a href="#API-docs" class="headerlink" title="API docs"></a>API docs</h2>
      <p>See <a href="./doc/ws.md"><code>/doc/ws.md</code></a> for Node.js-like documentation of ws classes and<br>utility functions.</p>

        <h2 id="WebSocket-compression"   >
          <a href="#WebSocket-compression" class="heading-link"><i class="fas fa-link"></i></a><a href="#WebSocket-compression" class="headerlink" title="WebSocket compression"></a>WebSocket compression</h2>
      <p>ws supports the <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc7692" >permessage-deflate extension</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> which enables<br>the client and server to negotiate a compression algorithm and its parameters,<br>and then selectively apply it to the data payloads of each WebSocket message.</p>
<p>The extension is disabled by default on the server and enabled by default on the<br>client. It adds a significant overhead in terms of performance and memory<br>consumption so we suggest to enable it only if it is really needed.</p>
<p>Note that Node.js has a variety of issues with high-performance compression,<br>where increased concurrency, especially on Linux, can lead to <a target="_blank" rel="noopener" href="https://github.com/nodejs/node/issues/8871">catastrophic<br>memory fragmentation</a> and slow performance. If you intend to use<br>permessage-deflate in production, it is worthwhile to set up a test<br>representative of your workload and ensure Node.js&#x2F;zlib will handle it with<br>acceptable performance and memory usage.</p>
<p>Tuning of permessage-deflate can be done via the options defined below. You can<br>also use <code>zlibDeflateOptions</code> and <code>zlibInflateOptions</code>, which is passed directly<br>into the creation of <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://nodejs.org/api/zlib.html#zlib_zlib_createdeflateraw_options" >raw deflate&#x2F;inflate streams</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>.</p>
<p>See <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/websockets/ws/blob/master/doc/ws.md#new-websocketserveroptions-callback" >the docs</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> for more options.</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">WebSocket</span> = <span class="built_in">require</span>(<span class="string">&#x27;ws&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> wss = <span class="keyword">new</span> <span class="title class_">WebSocket</span>.<span class="title class_">Server</span>(&#123;</span><br><span class="line">  <span class="attr">port</span>: <span class="number">8080</span>,</span><br><span class="line">  <span class="attr">perMessageDeflate</span>: &#123;</span><br><span class="line">    <span class="attr">zlibDeflateOptions</span>: &#123;</span><br><span class="line">      <span class="comment">// See zlib defaults.</span></span><br><span class="line">      <span class="attr">chunkSize</span>: <span class="number">1024</span>,</span><br><span class="line">      <span class="attr">memLevel</span>: <span class="number">7</span>,</span><br><span class="line">      <span class="attr">level</span>: <span class="number">3</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">zlibInflateOptions</span>: &#123;</span><br><span class="line">      <span class="attr">chunkSize</span>: <span class="number">10</span> * <span class="number">1024</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// Other options settable:</span></span><br><span class="line">    <span class="attr">clientNoContextTakeover</span>: <span class="literal">true</span>, <span class="comment">// Defaults to negotiated value.</span></span><br><span class="line">    <span class="attr">serverNoContextTakeover</span>: <span class="literal">true</span>, <span class="comment">// Defaults to negotiated value.</span></span><br><span class="line">    <span class="attr">serverMaxWindowBits</span>: <span class="number">10</span>, <span class="comment">// Defaults to negotiated value.</span></span><br><span class="line">    <span class="comment">// Below options specified as default values.</span></span><br><span class="line">    <span class="attr">concurrencyLimit</span>: <span class="number">10</span>, <span class="comment">// Limits zlib concurrency for perf.</span></span><br><span class="line">    <span class="attr">threshold</span>: <span class="number">1024</span> <span class="comment">// Size (in bytes) below which messages</span></span><br><span class="line">    <span class="comment">// should not be compressed.</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></div></figure>

<p>The client will only use the extension if it is supported and enabled on the<br>server. To always disable the extension on the client set the<br><code>perMessageDeflate</code> option to <code>false</code>.</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">WebSocket</span> = <span class="built_in">require</span>(<span class="string">&#x27;ws&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ws = <span class="keyword">new</span> <span class="title class_">WebSocket</span>(<span class="string">&#x27;ws://www.host.com/path&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">perMessageDeflate</span>: <span class="literal">false</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></div></figure>


        <h2 id="Usage-examples"   >
          <a href="#Usage-examples" class="heading-link"><i class="fas fa-link"></i></a><a href="#Usage-examples" class="headerlink" title="Usage examples"></a>Usage examples</h2>
      
        <h3 id="Sending-and-receiving-text-data"   >
          <a href="#Sending-and-receiving-text-data" class="heading-link"><i class="fas fa-link"></i></a><a href="#Sending-and-receiving-text-data" class="headerlink" title="Sending and receiving text data"></a>Sending and receiving text data</h3>
      <figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">WebSocket</span> = <span class="built_in">require</span>(<span class="string">&#x27;ws&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ws = <span class="keyword">new</span> <span class="title class_">WebSocket</span>(<span class="string">&#x27;ws://www.host.com/path&#x27;</span>);</span><br><span class="line"></span><br><span class="line">ws.<span class="title function_">on</span>(<span class="string">&#x27;open&#x27;</span>, <span class="keyword">function</span> <span class="title function_">open</span>(<span class="params"></span>) &#123;</span><br><span class="line">  ws.<span class="title function_">send</span>(<span class="string">&#x27;something&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">ws.<span class="title function_">on</span>(<span class="string">&#x27;message&#x27;</span>, <span class="keyword">function</span> <span class="title function_">incoming</span>(<span class="params">data</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></div></figure>


        <h3 id="Sending-binary-data"   >
          <a href="#Sending-binary-data" class="heading-link"><i class="fas fa-link"></i></a><a href="#Sending-binary-data" class="headerlink" title="Sending binary data"></a>Sending binary data</h3>
      <figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">WebSocket</span> = <span class="built_in">require</span>(<span class="string">&#x27;ws&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ws = <span class="keyword">new</span> <span class="title class_">WebSocket</span>(<span class="string">&#x27;ws://www.host.com/path&#x27;</span>);</span><br><span class="line"></span><br><span class="line">ws.<span class="title function_">on</span>(<span class="string">&#x27;open&#x27;</span>, <span class="keyword">function</span> <span class="title function_">open</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> array = <span class="keyword">new</span> <span class="title class_">Float32Array</span>(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; array.<span class="property">length</span>; ++i) &#123;</span><br><span class="line">    array[i] = i / <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ws.<span class="title function_">send</span>(array);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></div></figure>


        <h3 id="Simple-server"   >
          <a href="#Simple-server" class="heading-link"><i class="fas fa-link"></i></a><a href="#Simple-server" class="headerlink" title="Simple server"></a>Simple server</h3>
      <figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">WebSocket</span> = <span class="built_in">require</span>(<span class="string">&#x27;ws&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> wss = <span class="keyword">new</span> <span class="title class_">WebSocket</span>.<span class="title class_">Server</span>(&#123; <span class="attr">port</span>: <span class="number">8080</span> &#125;);</span><br><span class="line"></span><br><span class="line">wss.<span class="title function_">on</span>(<span class="string">&#x27;connection&#x27;</span>, <span class="keyword">function</span> <span class="title function_">connection</span>(<span class="params">ws</span>) &#123;</span><br><span class="line">  ws.<span class="title function_">on</span>(<span class="string">&#x27;message&#x27;</span>, <span class="keyword">function</span> <span class="title function_">incoming</span>(<span class="params">message</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;received: %s&#x27;</span>, message);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  ws.<span class="title function_">send</span>(<span class="string">&#x27;something&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></div></figure>


        <h3 id="External-HTTP-x2F-S-server"   >
          <a href="#External-HTTP-x2F-S-server" class="heading-link"><i class="fas fa-link"></i></a><a href="#External-HTTP-x2F-S-server" class="headerlink" title="External HTTP&#x2F;S server"></a>External HTTP&#x2F;S server</h3>
      <figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> https = <span class="built_in">require</span>(<span class="string">&#x27;https&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">WebSocket</span> = <span class="built_in">require</span>(<span class="string">&#x27;ws&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = https.<span class="title function_">createServer</span>(&#123;</span><br><span class="line">  <span class="attr">cert</span>: fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;/path/to/cert.pem&#x27;</span>),</span><br><span class="line">  <span class="attr">key</span>: fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;/path/to/key.pem&#x27;</span>)</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> wss = <span class="keyword">new</span> <span class="title class_">WebSocket</span>.<span class="title class_">Server</span>(&#123; server &#125;);</span><br><span class="line"></span><br><span class="line">wss.<span class="title function_">on</span>(<span class="string">&#x27;connection&#x27;</span>, <span class="keyword">function</span> <span class="title function_">connection</span>(<span class="params">ws</span>) &#123;</span><br><span class="line">  ws.<span class="title function_">on</span>(<span class="string">&#x27;message&#x27;</span>, <span class="keyword">function</span> <span class="title function_">incoming</span>(<span class="params">message</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;received: %s&#x27;</span>, message);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  ws.<span class="title function_">send</span>(<span class="string">&#x27;something&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.<span class="title function_">listen</span>(<span class="number">8080</span>);</span><br></pre></td></tr></table></div></figure>


        <h3 id="Multiple-servers-sharing-a-single-HTTP-x2F-S-server"   >
          <a href="#Multiple-servers-sharing-a-single-HTTP-x2F-S-server" class="heading-link"><i class="fas fa-link"></i></a><a href="#Multiple-servers-sharing-a-single-HTTP-x2F-S-server" class="headerlink" title="Multiple servers sharing a single HTTP&#x2F;S server"></a>Multiple servers sharing a single HTTP&#x2F;S server</h3>
      <figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">WebSocket</span> = <span class="built_in">require</span>(<span class="string">&#x27;ws&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> url = <span class="built_in">require</span>(<span class="string">&#x27;url&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = http.<span class="title function_">createServer</span>();</span><br><span class="line"><span class="keyword">const</span> wss1 = <span class="keyword">new</span> <span class="title class_">WebSocket</span>.<span class="title class_">Server</span>(&#123; <span class="attr">noServer</span>: <span class="literal">true</span> &#125;);</span><br><span class="line"><span class="keyword">const</span> wss2 = <span class="keyword">new</span> <span class="title class_">WebSocket</span>.<span class="title class_">Server</span>(&#123; <span class="attr">noServer</span>: <span class="literal">true</span> &#125;);</span><br><span class="line"></span><br><span class="line">wss1.<span class="title function_">on</span>(<span class="string">&#x27;connection&#x27;</span>, <span class="keyword">function</span> <span class="title function_">connection</span>(<span class="params">ws</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">wss2.<span class="title function_">on</span>(<span class="string">&#x27;connection&#x27;</span>, <span class="keyword">function</span> <span class="title function_">connection</span>(<span class="params">ws</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.<span class="title function_">on</span>(<span class="string">&#x27;upgrade&#x27;</span>, <span class="keyword">function</span> <span class="title function_">upgrade</span>(<span class="params">request, socket, head</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> pathname = url.<span class="title function_">parse</span>(request.<span class="property">url</span>).<span class="property">pathname</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (pathname === <span class="string">&#x27;/foo&#x27;</span>) &#123;</span><br><span class="line">    wss1.<span class="title function_">handleUpgrade</span>(request, socket, head, <span class="keyword">function</span> <span class="title function_">done</span>(<span class="params">ws</span>) &#123;</span><br><span class="line">      wss1.<span class="title function_">emit</span>(<span class="string">&#x27;connection&#x27;</span>, ws, request);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (pathname === <span class="string">&#x27;/bar&#x27;</span>) &#123;</span><br><span class="line">    wss2.<span class="title function_">handleUpgrade</span>(request, socket, head, <span class="keyword">function</span> <span class="title function_">done</span>(<span class="params">ws</span>) &#123;</span><br><span class="line">      wss2.<span class="title function_">emit</span>(<span class="string">&#x27;connection&#x27;</span>, ws, request);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    socket.<span class="title function_">destroy</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.<span class="title function_">listen</span>(<span class="number">8080</span>);</span><br></pre></td></tr></table></div></figure>


        <h3 id="Client-authentication"   >
          <a href="#Client-authentication" class="heading-link"><i class="fas fa-link"></i></a><a href="#Client-authentication" class="headerlink" title="Client authentication"></a>Client authentication</h3>
      <figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">WebSocket</span> = <span class="built_in">require</span>(<span class="string">&#x27;ws&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = http.<span class="title function_">createServer</span>();</span><br><span class="line"><span class="keyword">const</span> wss = <span class="keyword">new</span> <span class="title class_">WebSocket</span>.<span class="title class_">Server</span>(&#123; <span class="attr">noServer</span>: <span class="literal">true</span> &#125;);</span><br><span class="line"></span><br><span class="line">wss.<span class="title function_">on</span>(<span class="string">&#x27;connection&#x27;</span>, <span class="keyword">function</span> <span class="title function_">connection</span>(<span class="params">ws, request, client</span>) &#123;</span><br><span class="line">  ws.<span class="title function_">on</span>(<span class="string">&#x27;message&#x27;</span>, <span class="keyword">function</span> <span class="title function_">message</span>(<span class="params">msg</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Received message <span class="subst">$&#123;msg&#125;</span> from user <span class="subst">$&#123;client&#125;</span>`</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.<span class="title function_">on</span>(<span class="string">&#x27;upgrade&#x27;</span>, <span class="keyword">function</span> <span class="title function_">upgrade</span>(<span class="params">request, socket, head</span>) &#123;</span><br><span class="line">  <span class="comment">// This function is not defined on purpose. Implement it with your own logic.</span></span><br><span class="line">  <span class="title function_">authenticate</span>(request, <span class="function">(<span class="params">err, client</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err || !client) &#123;</span><br><span class="line">      socket.<span class="title function_">write</span>(<span class="string">&#x27;HTTP/1.1 401 Unauthorized\r\n\r\n&#x27;</span>);</span><br><span class="line">      socket.<span class="title function_">destroy</span>();</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    wss.<span class="title function_">handleUpgrade</span>(request, socket, head, <span class="keyword">function</span> <span class="title function_">done</span>(<span class="params">ws</span>) &#123;</span><br><span class="line">      wss.<span class="title function_">emit</span>(<span class="string">&#x27;connection&#x27;</span>, ws, request, client);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.<span class="title function_">listen</span>(<span class="number">8080</span>);</span><br></pre></td></tr></table></div></figure>

<p>Also see the provided <a href="./examples/express-session-parse">example</a> using <code>express-session</code>.</p>

        <h3 id="Server-broadcast"   >
          <a href="#Server-broadcast" class="heading-link"><i class="fas fa-link"></i></a><a href="#Server-broadcast" class="headerlink" title="Server broadcast"></a>Server broadcast</h3>
      <p>A client WebSocket broadcasting to all connected WebSocket clients, including<br>itself.</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">WebSocket</span> = <span class="built_in">require</span>(<span class="string">&#x27;ws&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> wss = <span class="keyword">new</span> <span class="title class_">WebSocket</span>.<span class="title class_">Server</span>(&#123; <span class="attr">port</span>: <span class="number">8080</span> &#125;);</span><br><span class="line"></span><br><span class="line">wss.<span class="title function_">on</span>(<span class="string">&#x27;connection&#x27;</span>, <span class="keyword">function</span> <span class="title function_">connection</span>(<span class="params">ws</span>) &#123;</span><br><span class="line">  ws.<span class="title function_">on</span>(<span class="string">&#x27;message&#x27;</span>, <span class="keyword">function</span> <span class="title function_">incoming</span>(<span class="params">data</span>) &#123;</span><br><span class="line">    wss.<span class="property">clients</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span> <span class="title function_">each</span>(<span class="params">client</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (client.<span class="property">readyState</span> === <span class="title class_">WebSocket</span>.<span class="property">OPEN</span>) &#123;</span><br><span class="line">        client.<span class="title function_">send</span>(data);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></div></figure>

<p>A client WebSocket broadcasting to every other connected WebSocket clients,<br>excluding itself.</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">WebSocket</span> = <span class="built_in">require</span>(<span class="string">&#x27;ws&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> wss = <span class="keyword">new</span> <span class="title class_">WebSocket</span>.<span class="title class_">Server</span>(&#123; <span class="attr">port</span>: <span class="number">8080</span> &#125;);</span><br><span class="line"></span><br><span class="line">wss.<span class="title function_">on</span>(<span class="string">&#x27;connection&#x27;</span>, <span class="keyword">function</span> <span class="title function_">connection</span>(<span class="params">ws</span>) &#123;</span><br><span class="line">  ws.<span class="title function_">on</span>(<span class="string">&#x27;message&#x27;</span>, <span class="keyword">function</span> <span class="title function_">incoming</span>(<span class="params">data</span>) &#123;</span><br><span class="line">    wss.<span class="property">clients</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span> <span class="title function_">each</span>(<span class="params">client</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (client !== ws &amp;&amp; client.<span class="property">readyState</span> === <span class="title class_">WebSocket</span>.<span class="property">OPEN</span>) &#123;</span><br><span class="line">        client.<span class="title function_">send</span>(data);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></div></figure>


        <h3 id="echo-websocket-org-demo"   >
          <a href="#echo-websocket-org-demo" class="heading-link"><i class="fas fa-link"></i></a><a href="#echo-websocket-org-demo" class="headerlink" title="echo.websocket.org demo"></a>echo.websocket.org demo</h3>
      <figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">WebSocket</span> = <span class="built_in">require</span>(<span class="string">&#x27;ws&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ws = <span class="keyword">new</span> <span class="title class_">WebSocket</span>(<span class="string">&#x27;wss://echo.websocket.org/&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">origin</span>: <span class="string">&#x27;https://websocket.org&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">ws.<span class="title function_">on</span>(<span class="string">&#x27;open&#x27;</span>, <span class="keyword">function</span> <span class="title function_">open</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;connected&#x27;</span>);</span><br><span class="line">  ws.<span class="title function_">send</span>(<span class="title class_">Date</span>.<span class="title function_">now</span>());</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">ws.<span class="title function_">on</span>(<span class="string">&#x27;close&#x27;</span>, <span class="keyword">function</span> <span class="title function_">close</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;disconnected&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">ws.<span class="title function_">on</span>(<span class="string">&#x27;message&#x27;</span>, <span class="keyword">function</span> <span class="title function_">incoming</span>(<span class="params">data</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Roundtrip time: <span class="subst">$&#123;<span class="built_in">Date</span>.now() - data&#125;</span> ms`</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="keyword">function</span> <span class="title function_">timeout</span>(<span class="params"></span>) &#123;</span><br><span class="line">    ws.<span class="title function_">send</span>(<span class="title class_">Date</span>.<span class="title function_">now</span>());</span><br><span class="line">  &#125;, <span class="number">500</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></div></figure>


        <h3 id="Use-the-Node-js-streams-API"   >
          <a href="#Use-the-Node-js-streams-API" class="heading-link"><i class="fas fa-link"></i></a><a href="#Use-the-Node-js-streams-API" class="headerlink" title="Use the Node.js streams API"></a>Use the Node.js streams API</h3>
      <figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">WebSocket</span> = <span class="built_in">require</span>(<span class="string">&#x27;ws&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ws = <span class="keyword">new</span> <span class="title class_">WebSocket</span>(<span class="string">&#x27;wss://echo.websocket.org/&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">origin</span>: <span class="string">&#x27;https://websocket.org&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> duplex = <span class="title class_">WebSocket</span>.<span class="title function_">createWebSocketStream</span>(ws, &#123; <span class="attr">encoding</span>: <span class="string">&#x27;utf8&#x27;</span> &#125;);</span><br><span class="line"></span><br><span class="line">duplex.<span class="title function_">pipe</span>(process.<span class="property">stdout</span>);</span><br><span class="line">process.<span class="property">stdin</span>.<span class="title function_">pipe</span>(duplex);</span><br></pre></td></tr></table></div></figure>


        <h3 id="Other-examples"   >
          <a href="#Other-examples" class="heading-link"><i class="fas fa-link"></i></a><a href="#Other-examples" class="headerlink" title="Other examples"></a>Other examples</h3>
      <p>For a full example with a browser client communicating with a ws server, see the<br>examples folder.</p>
<p>Otherwise, see the test cases.</p>

        <h2 id="FAQ"   >
          <a href="#FAQ" class="heading-link"><i class="fas fa-link"></i></a><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2>
      
        <h3 id="How-to-get-the-IP-address-of-the-client"   >
          <a href="#How-to-get-the-IP-address-of-the-client" class="heading-link"><i class="fas fa-link"></i></a><a href="#How-to-get-the-IP-address-of-the-client" class="headerlink" title="How to get the IP address of the client?"></a>How to get the IP address of the client?</h3>
      <p>The remote IP address can be obtained from the raw socket.</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">WebSocket</span> = <span class="built_in">require</span>(<span class="string">&#x27;ws&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> wss = <span class="keyword">new</span> <span class="title class_">WebSocket</span>.<span class="title class_">Server</span>(&#123; <span class="attr">port</span>: <span class="number">8080</span> &#125;);</span><br><span class="line"></span><br><span class="line">wss.<span class="title function_">on</span>(<span class="string">&#x27;connection&#x27;</span>, <span class="keyword">function</span> <span class="title function_">connection</span>(<span class="params">ws, req</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> ip = req.<span class="property">socket</span>.<span class="property">remoteAddress</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></div></figure>

<p>When the server runs behind a proxy like NGINX, the de-facto standard is to use<br>the <code>X-Forwarded-For</code> header.</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wss.<span class="title function_">on</span>(<span class="string">&#x27;connection&#x27;</span>, <span class="keyword">function</span> <span class="title function_">connection</span>(<span class="params">ws, req</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> ip = req.<span class="property">headers</span>[<span class="string">&#x27;x-forwarded-for&#x27;</span>].<span class="title function_">split</span>(<span class="regexp">/\s*,\s*/</span>)[<span class="number">0</span>];</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></div></figure>


        <h3 id="How-to-detect-and-close-broken-connections"   >
          <a href="#How-to-detect-and-close-broken-connections" class="heading-link"><i class="fas fa-link"></i></a><a href="#How-to-detect-and-close-broken-connections" class="headerlink" title="How to detect and close broken connections?"></a>How to detect and close broken connections?</h3>
      <p>Sometimes the link between the server and the client can be interrupted in a way<br>that keeps both the server and the client unaware of the broken state of the<br>connection (e.g. when pulling the cord).</p>
<p>In these cases ping messages can be used as a means to verify that the remote<br>endpoint is still responsive.</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">WebSocket</span> = <span class="built_in">require</span>(<span class="string">&#x27;ws&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">noop</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">heartbeat</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">isAlive</span> = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> wss = <span class="keyword">new</span> <span class="title class_">WebSocket</span>.<span class="title class_">Server</span>(&#123; <span class="attr">port</span>: <span class="number">8080</span> &#125;);</span><br><span class="line"></span><br><span class="line">wss.<span class="title function_">on</span>(<span class="string">&#x27;connection&#x27;</span>, <span class="keyword">function</span> <span class="title function_">connection</span>(<span class="params">ws</span>) &#123;</span><br><span class="line">  ws.<span class="property">isAlive</span> = <span class="literal">true</span>;</span><br><span class="line">  ws.<span class="title function_">on</span>(<span class="string">&#x27;pong&#x27;</span>, heartbeat);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> interval = <span class="built_in">setInterval</span>(<span class="keyword">function</span> <span class="title function_">ping</span>(<span class="params"></span>) &#123;</span><br><span class="line">  wss.<span class="property">clients</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span> <span class="title function_">each</span>(<span class="params">ws</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (ws.<span class="property">isAlive</span> === <span class="literal">false</span>) <span class="keyword">return</span> ws.<span class="title function_">terminate</span>();</span><br><span class="line"></span><br><span class="line">    ws.<span class="property">isAlive</span> = <span class="literal">false</span>;</span><br><span class="line">    ws.<span class="title function_">ping</span>(noop);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;, <span class="number">30000</span>);</span><br><span class="line"></span><br><span class="line">wss.<span class="title function_">on</span>(<span class="string">&#x27;close&#x27;</span>, <span class="keyword">function</span> <span class="title function_">close</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="built_in">clearInterval</span>(interval);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></div></figure>

<p>Pong messages are automatically sent in response to ping messages as required by<br>the spec.</p>
<p>Just like the server example above your clients might as well lose connection<br>without knowing it. You might want to add a ping listener on your clients to<br>prevent that. A simple implementation would be:</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">WebSocket</span> = <span class="built_in">require</span>(<span class="string">&#x27;ws&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">heartbeat</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="built_in">clearTimeout</span>(<span class="variable language_">this</span>.<span class="property">pingTimeout</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Use `WebSocket#terminate()`, which immediately destroys the connection,</span></span><br><span class="line">  <span class="comment">// instead of `WebSocket#close()`, which waits for the close timer.</span></span><br><span class="line">  <span class="comment">// Delay should be equal to the interval at which your server</span></span><br><span class="line">  <span class="comment">// sends out pings plus a conservative assumption of the latency.</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">pingTimeout</span> = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">terminate</span>();</span><br><span class="line">  &#125;, <span class="number">30000</span> + <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> client = <span class="keyword">new</span> <span class="title class_">WebSocket</span>(<span class="string">&#x27;wss://echo.websocket.org/&#x27;</span>);</span><br><span class="line"></span><br><span class="line">client.<span class="title function_">on</span>(<span class="string">&#x27;open&#x27;</span>, heartbeat);</span><br><span class="line">client.<span class="title function_">on</span>(<span class="string">&#x27;ping&#x27;</span>, heartbeat);</span><br><span class="line">client.<span class="title function_">on</span>(<span class="string">&#x27;close&#x27;</span>, <span class="keyword">function</span> <span class="title function_">clear</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="built_in">clearTimeout</span>(<span class="variable language_">this</span>.<span class="property">pingTimeout</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></div></figure>


        <h3 id="How-to-connect-via-a-proxy"   >
          <a href="#How-to-connect-via-a-proxy" class="heading-link"><i class="fas fa-link"></i></a><a href="#How-to-connect-via-a-proxy" class="headerlink" title="How to connect via a proxy?"></a>How to connect via a proxy?</h3>
      <p>Use a custom <code>http.Agent</code> implementation like <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/TooTallNate/node-https-proxy-agent" >https-proxy-agent</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> or<br><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/TooTallNate/node-socks-proxy-agent" >socks-proxy-agent</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>.</p>

        <h2 id="Changelog"   >
          <a href="#Changelog" class="heading-link"><i class="fas fa-link"></i></a><a href="#Changelog" class="headerlink" title="Changelog"></a>Changelog</h2>
      <p>We’re using the GitHub <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/websockets/ws/releases" >releases</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> for changelog entries.</p>

        <h2 id="License"   >
          <a href="#License" class="heading-link"><i class="fas fa-link"></i></a><a href="#License" class="headerlink" title="License"></a>License</h2>
      <p><a href="LICENSE">MIT</a></p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2023/03/24/02_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E4%B8%8E%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/01_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8-demo/node_modules/word-wrap/README/">[ Untitled ]</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2023-03-24</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2016-12-29</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="word-wrap"   >
          <a href="#word-wrap" class="heading-link"><i class="fas fa-link"></i></a><a href="#word-wrap" class="headerlink" title="word-wrap    "></a>word-wrap <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/word-wrap"><img   src="https://img.shields.io/npm/v/word-wrap.svg?style=flat" style=""  alt="NPM version"></a> <a target="_blank" rel="noopener" href="https://npmjs.org/package/word-wrap"><img   src="https://img.shields.io/npm/dm/word-wrap.svg?style=flat" style=""  alt="NPM monthly downloads"></a> <a target="_blank" rel="noopener" href="https://npmjs.org/package/word-wrap"><img   src="https://img.shields.io/npm/dt/word-wrap.svg?style=flat" style=""  alt="NPM total downloads"></a> <a target="_blank" rel="noopener" href="https://travis-ci.org/jonschlinkert/word-wrap"><img   src="https://img.shields.io/travis/jonschlinkert/word-wrap.svg?style=flat&label=Travis" style=""  alt="Linux Build Status"></a></h1>
      <blockquote>
<p>Wrap words to a specified length.</p>
</blockquote>

        <h2 id="Install"   >
          <a href="#Install" class="heading-link"><i class="fas fa-link"></i></a><a href="#Install" class="headerlink" title="Install"></a>Install</h2>
      <p>Install with <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.npmjs.com/" >npm</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>:</p>
<figure class="highlight sh"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install --save word-wrap</span><br></pre></td></tr></table></div></figure>


        <h2 id="Usage"   >
          <a href="#Usage" class="heading-link"><i class="fas fa-link"></i></a><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2>
      <figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> wrap = <span class="built_in">require</span>(<span class="string">&#x27;word-wrap&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">wrap</span>(<span class="string">&#x27;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.&#x27;</span>);</span><br></pre></td></tr></table></div></figure>

<p>Results in:</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Lorem ipsum dolor sit amet, consectetur adipiscing</span><br><span class="line">elit, sed do eiusmod tempor incididunt ut labore</span><br><span class="line">et dolore magna aliqua. Ut enim ad minim veniam,</span><br><span class="line">quis nostrud exercitation ullamco laboris nisi ut</span><br><span class="line">aliquip ex ea commodo consequat.</span><br></pre></td></tr></table></div></figure>


        <h2 id="Options"   >
          <a href="#Options" class="heading-link"><i class="fas fa-link"></i></a><a href="#Options" class="headerlink" title="Options"></a>Options</h2>
      <p><img src="https://cloud.githubusercontent.com/assets/383994/6543728/7a381c08-c4f6-11e4-8b7d-b6ba197569c9.png" alt="image"></p>

        <h3 id="options-width"   >
          <a href="#options-width" class="heading-link"><i class="fas fa-link"></i></a><a href="#options-width" class="headerlink" title="options.width"></a>options.width</h3>
      <p>Type: <code>Number</code></p>
<p>Default: <code>50</code></p>
<p>The width of the text before wrapping to a new line.</p>
<p><strong>Example:</strong></p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">wrap</span>(str, &#123;<span class="attr">width</span>: <span class="number">60</span>&#125;);</span><br></pre></td></tr></table></div></figure>


        <h3 id="options-indent"   >
          <a href="#options-indent" class="heading-link"><i class="fas fa-link"></i></a><a href="#options-indent" class="headerlink" title="options.indent"></a>options.indent</h3>
      <p>Type: <code>String</code></p>
<p>Default: &#96;&#96; (two spaces)</p>
<p>The string to use at the beginning of each line.</p>
<p><strong>Example:</strong></p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">wrap</span>(str, &#123;<span class="attr">indent</span>: <span class="string">&#x27;      &#x27;</span>&#125;);</span><br></pre></td></tr></table></div></figure>


        <h3 id="options-newline"   >
          <a href="#options-newline" class="heading-link"><i class="fas fa-link"></i></a><a href="#options-newline" class="headerlink" title="options.newline"></a>options.newline</h3>
      <p>Type: <code>String</code></p>
<p>Default: <code>\n</code></p>
<p>The string to use at the end of each line.</p>
<p><strong>Example:</strong></p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">wrap</span>(str, &#123;<span class="attr">newline</span>: <span class="string">&#x27;\n\n&#x27;</span>&#125;);</span><br></pre></td></tr></table></div></figure>


        <h3 id="options-escape"   >
          <a href="#options-escape" class="heading-link"><i class="fas fa-link"></i></a><a href="#options-escape" class="headerlink" title="options.escape"></a>options.escape</h3>
      <p>Type: <code>function</code></p>
<p>Default: <code>function(str)&#123;return str;&#125;</code></p>
<p>An escape function to run on each line after splitting them.</p>
<p><strong>Example:</strong></p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xmlescape = <span class="built_in">require</span>(<span class="string">&#x27;xml-escape&#x27;</span>);</span><br><span class="line"><span class="title function_">wrap</span>(str, &#123;</span><br><span class="line">  <span class="attr">escape</span>: <span class="keyword">function</span>(<span class="params">string</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">xmlescape</span>(string);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></div></figure>


        <h3 id="options-trim"   >
          <a href="#options-trim" class="heading-link"><i class="fas fa-link"></i></a><a href="#options-trim" class="headerlink" title="options.trim"></a>options.trim</h3>
      <p>Type: <code>Boolean</code></p>
<p>Default: <code>false</code></p>
<p>Trim trailing whitespace from the returned string. This option is included since <code>.trim()</code> would also strip the leading indentation from the first line.</p>
<p><strong>Example:</strong></p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">wrap</span>(str, &#123;<span class="attr">trim</span>: <span class="literal">true</span>&#125;);</span><br></pre></td></tr></table></div></figure>


        <h3 id="options-cut"   >
          <a href="#options-cut" class="heading-link"><i class="fas fa-link"></i></a><a href="#options-cut" class="headerlink" title="options.cut"></a>options.cut</h3>
      <p>Type: <code>Boolean</code></p>
<p>Default: <code>false</code></p>
<p>Break a word between any two letters when the word is longer than the specified width.</p>
<p><strong>Example:</strong></p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">wrap</span>(str, &#123;<span class="attr">cut</span>: <span class="literal">true</span>&#125;);</span><br></pre></td></tr></table></div></figure>


        <h2 id="About"   >
          <a href="#About" class="heading-link"><i class="fas fa-link"></i></a><a href="#About" class="headerlink" title="About"></a>About</h2>
      
        <h3 id="Related-projects"   >
          <a href="#Related-projects" class="heading-link"><i class="fas fa-link"></i></a><a href="#Related-projects" class="headerlink" title="Related projects"></a>Related projects</h3>
      <ul>
<li><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.npmjs.com/package/common-words" >common-words</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>: Updated list (JSON) of the 100 most common words in the English language. Useful for… <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/jonschlinkert/common-words" >more</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> | <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/jonschlinkert/common-words"  title="Updated list (JSON) of the 100 most common words in the English language. Useful for excluding these words from arrays.">homepage</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
<li><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.npmjs.com/package/shuffle-words" >shuffle-words</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>: Shuffle the words in a string and optionally the letters in each word using the… <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/jonschlinkert/shuffle-words" >more</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> | <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/jonschlinkert/shuffle-words"  title="Shuffle the words in a string and optionally the letters in each word using the Fisher-Yates algorithm. Useful for creating test fixtures, benchmarking samples, etc.">homepage</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
<li><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.npmjs.com/package/unique-words" >unique-words</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>: Return the unique words in a string or array. | <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/jonschlinkert/unique-words"  title="Return the unique words in a string or array.">homepage</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
<li><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.npmjs.com/package/wordcount" >wordcount</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>: Count the words in a string. Support for english, CJK and Cyrillic. | <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/jonschlinkert/wordcount"  title="Count the words in a string. Support for english, CJK and Cyrillic.">homepage</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
</ul>

        <h3 id="Contributing"   >
          <a href="#Contributing" class="heading-link"><i class="fas fa-link"></i></a><a href="#Contributing" class="headerlink" title="Contributing"></a>Contributing</h3>
      <p>Pull requests and stars are always welcome. For bugs and feature requests, <a href="../../issues/new">please create an issue</a>.</p>

        <h3 id="Contributors"   >
          <a href="#Contributors" class="heading-link"><i class="fas fa-link"></i></a><a href="#Contributors" class="headerlink" title="Contributors"></a>Contributors</h3>
      <div class="table-container"><table>
<thead>
<tr>
<th><strong>Commits</strong></th>
<th><strong>Contributor</strong></th>
</tr>
</thead>
<tbody><tr>
<td>43</td>
<td><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/jonschlinkert" >jonschlinkert</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></td>
</tr>
<tr>
<td>2</td>
<td><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/lordvlad" >lordvlad</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></td>
</tr>
<tr>
<td>2</td>
<td><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/hildjj" >hildjj</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></td>
</tr>
<tr>
<td>1</td>
<td><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/danilosampaio" >danilosampaio</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></td>
</tr>
<tr>
<td>1</td>
<td><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/2fd" >2fd</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></td>
</tr>
<tr>
<td>1</td>
<td><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/toddself" >toddself</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></td>
</tr>
<tr>
<td>1</td>
<td><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/wolfgang42" >wolfgang42</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></td>
</tr>
<tr>
<td>1</td>
<td><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/zachhale" >zachhale</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></td>
</tr>
</tbody></table></div>

        <h3 id="Building-docs"   >
          <a href="#Building-docs" class="heading-link"><i class="fas fa-link"></i></a><a href="#Building-docs" class="headerlink" title="Building docs"></a>Building docs</h3>
      <p><em>(This project’s readme.md is generated by <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/verbose/verb-generate-readme" >verb</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>, please don’t edit the readme directly. Any changes to the readme must be made in the <a href=".verb.md">.verb.md</a> readme template.)</em></p>
<p>To generate the readme, run the following command:</p>
<figure class="highlight sh"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g verbose/verb<span class="comment">#dev verb-generate-readme &amp;&amp; verb</span></span><br></pre></td></tr></table></div></figure>


        <h3 id="Running-tests"   >
          <a href="#Running-tests" class="heading-link"><i class="fas fa-link"></i></a><a href="#Running-tests" class="headerlink" title="Running tests"></a>Running tests</h3>
      <p>Running and reviewing unit tests is a great way to get familiarized with a library and its API. You can install dependencies and run tests with the following command:</p>
<figure class="highlight sh"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install &amp;&amp; npm <span class="built_in">test</span></span><br></pre></td></tr></table></div></figure>


        <h3 id="Author"   >
          <a href="#Author" class="heading-link"><i class="fas fa-link"></i></a><a href="#Author" class="headerlink" title="Author"></a>Author</h3>
      <p><strong>Jon Schlinkert</strong></p>
<ul>
<li><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/jonschlinkert" >github&#x2F;jonschlinkert</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
<li><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://twitter.com/jonschlinkert" >twitter&#x2F;jonschlinkert</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
</ul>

        <h3 id="License"   >
          <a href="#License" class="heading-link"><i class="fas fa-link"></i></a><a href="#License" class="headerlink" title="License"></a>License</h3>
      <p>Copyright © 2017, <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/jonschlinkert" >Jon Schlinkert</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>.<br>Released under the <a href="LICENSE">MIT License</a>.</p>
<hr>
<p><em>This file was generated by <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/verbose/verb-generate-readme" >verb-generate-readme</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>, v0.6.0, on June 02, 2017.</em></p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2023/03/24/02_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E4%B8%8E%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/01_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8-demo/node_modules/whatwg-url/README/">[ Untitled ]</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2023-03-24</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">1985-10-26</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="whatwg-url"   >
          <a href="#whatwg-url" class="heading-link"><i class="fas fa-link"></i></a><a href="#whatwg-url" class="headerlink" title="whatwg-url"></a>whatwg-url</h1>
      <p>whatwg-url is a full implementation of the WHATWG <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://url.spec.whatwg.org/" >URL Standard</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>. It can be used standalone, but it also exposes a lot of the internal algorithms that are useful for integrating a URL parser into a project like <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/jsdom/jsdom" >jsdom</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>.</p>

        <h2 id="Specification-conformance"   >
          <a href="#Specification-conformance" class="heading-link"><i class="fas fa-link"></i></a><a href="#Specification-conformance" class="headerlink" title="Specification conformance"></a>Specification conformance</h2>
      <p>whatwg-url is currently up to date with the URL spec up to commit <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/whatwg/url/commit/0915d886bbf409331857f56e6d2bfd0cb5e01de7" >0915d88</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>.</p>
<p>For <code>file:</code> URLs, whose <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#concept-url-origin" >origin is left unspecified</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>, whatwg-url chooses to use a new opaque origin (which serializes to <code>&quot;null&quot;</code>).</p>
<p>whatwg-url does not yet implement any encoding handling beyond UTF-8. That is, the <em>encoding override</em> parameter does not exist in our API.</p>

        <h2 id="API"   >
          <a href="#API" class="heading-link"><i class="fas fa-link"></i></a><a href="#API" class="headerlink" title="API"></a>API</h2>
      
        <h3 id="The-URL-and-URLSearchParams-classes"   >
          <a href="#The-URL-and-URLSearchParams-classes" class="heading-link"><i class="fas fa-link"></i></a><a href="#The-URL-and-URLSearchParams-classes" class="headerlink" title="The URL and URLSearchParams classes"></a>The <code>URL</code> and <code>URLSearchParams</code> classes</h3>
      <p>The main API is provided by the <a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#url-class"><code>URL</code></a> and <a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#interface-urlsearchparams"><code>URLSearchParams</code></a> exports, which follows the spec’s behavior in all ways (including e.g. <code>USVString</code> conversion). Most consumers of this library will want to use these.</p>

        <h3 id="Low-level-URL-Standard-API"   >
          <a href="#Low-level-URL-Standard-API" class="heading-link"><i class="fas fa-link"></i></a><a href="#Low-level-URL-Standard-API" class="headerlink" title="Low-level URL Standard API"></a>Low-level URL Standard API</h3>
      <p>The following methods are exported for use by places like jsdom that need to implement things like <a target="_blank" rel="noopener" href="https://html.spec.whatwg.org/#htmlhyperlinkelementutils"><code>HTMLHyperlinkElementUtils</code></a>. They mostly operate on or return an “internal URL” or <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#concept-url" >“URL record”</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> type.</p>
<ul>
<li><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#concept-url-parser" >URL parser</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>: <code>parseURL(input, &#123; baseURL &#125;)</code></li>
<li><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#concept-basic-url-parser" >Basic URL parser</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>: <code>basicURLParse(input, &#123; baseURL, url, stateOverride &#125;)</code></li>
<li><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#concept-url-serializer" >URL serializer</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>: <code>serializeURL(urlRecord, excludeFragment)</code></li>
<li><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#concept-host-serializer" >Host serializer</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>: <code>serializeHost(hostFromURLRecord)</code></li>
<li><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#serialize-an-integer" >Serialize an integer</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>: <code>serializeInteger(number)</code></li>
<li><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#concept-url-origin" >Origin</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://html.spec.whatwg.org/multipage/origin.html#ascii-serialisation-of-an-origin" >serializer</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>: <code>serializeURLOrigin(urlRecord)</code></li>
<li><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#set-the-username" >Set the username</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>: <code>setTheUsername(urlRecord, usernameString)</code></li>
<li><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#set-the-password" >Set the password</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>: <code>setThePassword(urlRecord, passwordString)</code></li>
<li><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#cannot-have-a-username-password-port" >Cannot have a username&#x2F;password&#x2F;port</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>: <code>cannotHaveAUsernamePasswordPort(urlRecord)</code></li>
<li><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#percent-decode" >Percent decode</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>: <code>percentDecode(buffer)</code></li>
</ul>
<p>The <code>stateOverride</code> parameter is one of the following strings:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#scheme-start-state"><code>&quot;scheme start&quot;</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#scheme-state"><code>&quot;scheme&quot;</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#no-scheme-state"><code>&quot;no scheme&quot;</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#special-relative-or-authority-state"><code>&quot;special relative or authority&quot;</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#path-or-authority-state"><code>&quot;path or authority&quot;</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#relative-state"><code>&quot;relative&quot;</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#relative-slash-state"><code>&quot;relative slash&quot;</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#special-authority-slashes-state"><code>&quot;special authority slashes&quot;</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#special-authority-ignore-slashes-state"><code>&quot;special authority ignore slashes&quot;</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#authority-state"><code>&quot;authority&quot;</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#host-state"><code>&quot;host&quot;</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#hostname-state"><code>&quot;hostname&quot;</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#port-state"><code>&quot;port&quot;</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#file-state"><code>&quot;file&quot;</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#file-slash-state"><code>&quot;file slash&quot;</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#file-host-state"><code>&quot;file host&quot;</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#path-start-state"><code>&quot;path start&quot;</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#path-state"><code>&quot;path&quot;</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#cannot-be-a-base-url-path-state"><code>&quot;cannot-be-a-base-URL path&quot;</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#query-state"><code>&quot;query&quot;</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#fragment-state"><code>&quot;fragment&quot;</code></a></li>
</ul>
<p>The URL record type has the following API:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#concept-url-scheme"><code>scheme</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#concept-url-username"><code>username</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#concept-url-password"><code>password</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#concept-url-host"><code>host</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#concept-url-port"><code>port</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#concept-url-path"><code>path</code></a> (as an array)</li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#concept-url-query"><code>query</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#concept-url-fragment"><code>fragment</code></a></li>
<li><a target="_blank" rel="noopener" href="https://url.spec.whatwg.org/#url-cannot-be-a-base-url-flag"><code>cannotBeABaseURL</code></a> (as a boolean)</li>
</ul>
<p>These properties should be treated with care, as in general changing them will cause the URL record to be in an inconsistent state until the appropriate invocation of <code>basicURLParse</code> is used to fix it up. You can see examples of this in the URL Standard, where there are many step sequences like “4. Set context object’s url’s fragment to the empty string. 5. Basic URL parse <em>input</em> with context object’s url as <em>url</em> and fragment state as <em>state override</em>.” In between those two steps, a URL record is in an unusable state.</p>
<p>The return value of “failure” in the spec is represented by <code>null</code>. That is, functions like <code>parseURL</code> and <code>basicURLParse</code> can return <em>either</em> a URL record <em>or</em> <code>null</code>.</p>

        <h3 id="whatwg-url-webidl2js-wrapper-module"   >
          <a href="#whatwg-url-webidl2js-wrapper-module" class="heading-link"><i class="fas fa-link"></i></a><a href="#whatwg-url-webidl2js-wrapper-module" class="headerlink" title="whatwg-url/webidl2js-wrapper module"></a><code>whatwg-url/webidl2js-wrapper</code> module</h3>
      <p>This module exports the <code>URL</code> and <code>URLSearchParams</code> <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/jsdom/webidl2js#for-interfaces" >interface wrappers API</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> generated by <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/jsdom/webidl2js" >webidl2js</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>.</p>

        <h2 id="Development-instructions"   >
          <a href="#Development-instructions" class="heading-link"><i class="fas fa-link"></i></a><a href="#Development-instructions" class="headerlink" title="Development instructions"></a>Development instructions</h2>
      <p>First, install <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://nodejs.org/" >Node.js</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>. Then, fetch the dependencies of whatwg-url, by running from this directory:</p>
<pre><code>npm install
</code></pre>
<p>To run tests:</p>
<pre><code>npm test
</code></pre>
<p>To generate a coverage report:</p>
<pre><code>npm run coverage
</code></pre>
<p>To build and run the live viewer:</p>
<pre><code>npm run prepare
npm run build-live-viewer
</code></pre>
<p>Serve the contents of the <code>live-viewer</code> directory using any web server.</p>

        <h2 id="Supporting-whatwg-url"   >
          <a href="#Supporting-whatwg-url" class="heading-link"><i class="fas fa-link"></i></a><a href="#Supporting-whatwg-url" class="headerlink" title="Supporting whatwg-url"></a>Supporting whatwg-url</h2>
      <p>The jsdom project (including whatwg-url) is a community-driven project maintained by a team of <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/orgs/jsdom/people" >volunteers</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>. You could support us by:</p>
<ul>
<li><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://tidelift.com/subscription/pkg/npm-whatwg-url?utm_source=npm-whatwg-url&utm_medium=referral&utm_campaign=readme" >Getting professional support for whatwg-url</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> as part of a Tidelift subscription. Tidelift helps making open source sustainable for us while giving teams assurances for maintenance, licensing, and security.</li>
<li>Contributing directly to the project.</li>
</ul>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2023/03/24/02_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E4%B8%8E%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/01_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8-demo/node_modules/whatwg-mimetype/README/">[ Untitled ]</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2023-03-24</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">1985-10-26</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="Parse-serialize-and-manipulate-MIME-types"   >
          <a href="#Parse-serialize-and-manipulate-MIME-types" class="heading-link"><i class="fas fa-link"></i></a><a href="#Parse-serialize-and-manipulate-MIME-types" class="headerlink" title="Parse, serialize, and manipulate MIME types"></a>Parse, serialize, and manipulate MIME types</h1>
      <p>This package will parse <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://mimesniff.spec.whatwg.org/#understanding-mime-types" >MIME types</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> into a structured format, which can then be manipulated and serialized:</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">MIMEType</span> = <span class="built_in">require</span>(<span class="string">&quot;whatwg-mimetype&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mimeType = <span class="keyword">new</span> <span class="title class_">MIMEType</span>(<span class="string">`Text/HTML;Charset=&quot;utf-8&quot;`</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">assert</span>(mimeType.<span class="title function_">toString</span>() === <span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">assert</span>(mimeType.<span class="property">type</span> === <span class="string">&quot;text&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">assert</span>(mimeType.<span class="property">subtype</span> === <span class="string">&quot;html&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">assert</span>(mimeType.<span class="property">essence</span> === <span class="string">&quot;text/html&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">assert</span>(mimeType.<span class="property">parameters</span>.<span class="title function_">get</span>(<span class="string">&quot;charset&quot;</span>) === <span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">mimeType.<span class="property">parameters</span>.<span class="title function_">set</span>(<span class="string">&quot;charset&quot;</span>, <span class="string">&quot;windows-1252&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">assert</span>(mimeType.<span class="property">parameters</span>.<span class="title function_">get</span>(<span class="string">&quot;charset&quot;</span>) === <span class="string">&quot;windows-1252&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">assert</span>(mimeType.<span class="title function_">toString</span>() === <span class="string">&quot;text/html;charset=windows-1252&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">assert</span>(mimeType.<span class="title function_">isHTML</span>() === <span class="literal">true</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">assert</span>(mimeType.<span class="title function_">isXML</span>() === <span class="literal">false</span>);</span><br></pre></td></tr></table></div></figure>

<p>Parsing is a fairly complex process; see <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://mimesniff.spec.whatwg.org/#parsing-a-mime-type" >the specification</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> for details (and similarly <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://mimesniff.spec.whatwg.org/#serializing-a-mime-type" >for serialization</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>).</p>
<p>This package’s algorithms conform to those of the WHATWG <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://mimesniff.spec.whatwg.org/" >MIME Sniffing Standard</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>, and is aligned up to commit <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/whatwg/mimesniff/commit/126286ab2dcf3e2d541349ed93539a88bf394ad5" >126286a</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>.</p>

        <h2 id="MIMEType-API"   >
          <a href="#MIMEType-API" class="heading-link"><i class="fas fa-link"></i></a><a href="#MIMEType-API" class="headerlink" title="MIMEType API"></a><code>MIMEType</code> API</h2>
      <p>This package’s main module’s default export is a class, <code>MIMEType</code>. Its constructor takes a string which it will attempt to parse into a MIME type; if parsing fails, an <code>Error</code> will be thrown.</p>

        <h3 id="The-parse-static-factory-method"   >
          <a href="#The-parse-static-factory-method" class="heading-link"><i class="fas fa-link"></i></a><a href="#The-parse-static-factory-method" class="headerlink" title="The parse() static factory method"></a>The <code>parse()</code> static factory method</h3>
      <p>As an alternative to the constructor, you can use <code>MIMEType.parse(string)</code>. The only difference is that <code>parse()</code> will return <code>null</code> on failed parsing, whereas the constructor will throw. It thus makes the most sense to use the constructor in cases where unparseable MIME types would be exceptional, and use <code>parse()</code> when dealing with input from some unconstrained source.</p>

        <h3 id="Properties"   >
          <a href="#Properties" class="heading-link"><i class="fas fa-link"></i></a><a href="#Properties" class="headerlink" title="Properties"></a>Properties</h3>
      <ul>
<li><code>type</code>: the MIME type’s <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://mimesniff.spec.whatwg.org/#mime-type-type" >type</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>, e.g. <code>&quot;text&quot;</code></li>
<li><code>subtype</code>: the MIME type’s <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://mimesniff.spec.whatwg.org/#mime-type-subtype" >subtype</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>, e.g. <code>&quot;html&quot;</code></li>
<li><code>essence</code>: the MIME type’s <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://mimesniff.spec.whatwg.org/#mime-type-essence" >essence</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>, e.g. <code>&quot;text/html&quot;</code></li>
<li><code>parameters</code>: an instance of <code>MIMETypeParameters</code>, containing this MIME type’s <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://mimesniff.spec.whatwg.org/#mime-type-parameters" >parameters</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
</ul>
<p><code>type</code> and <code>subtype</code> can be changed. They will be validated to be non-empty and only contain <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://mimesniff.spec.whatwg.org/#http-token-code-point" >HTTP token code points</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>.</p>
<p><code>essence</code> is only a getter, and cannot be changed.</p>
<p><code>parameters</code> is also a getter, but the contents of the <code>MIMETypeParameters</code> object are mutable, as described below.</p>

        <h3 id="Methods"   >
          <a href="#Methods" class="heading-link"><i class="fas fa-link"></i></a><a href="#Methods" class="headerlink" title="Methods"></a>Methods</h3>
      <ul>
<li><code>toString()</code> serializes the MIME type to a string</li>
<li><code>isHTML()</code>: returns true if this instance represents <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://mimesniff.spec.whatwg.org/#html-mime-type" >a HTML MIME type</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
<li><code>isXML()</code>: returns true if this instance represents <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://mimesniff.spec.whatwg.org/#xml-mime-type" >an XML MIME type</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
<li><code>isJavaScript(&#123; allowParameters &#125;)</code>: returns true if this instance represents <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://html.spec.whatwg.org/multipage/scripting.html#javascript-mime-type" >a JavaScript MIME type</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>; <code>allowParameters</code> can be set to true to allow arbitrary parameters, instead of their presence causing the method to return <code>false</code></li>
</ul>
<p><em>Note: the <code>isHTML()</code>, <code>isXML()</code>, and <code>isJavaScript()</code> methods are speculative, and may be removed or changed in future major versions. See <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/whatwg/mimesniff/issues/48" >whatwg&#x2F;mimesniff#48</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> for brainstorming in this area. Currently we implement these mainly because they are useful in jsdom.</em></p>

        <h2 id="MIMETypeParameters-API"   >
          <a href="#MIMETypeParameters-API" class="heading-link"><i class="fas fa-link"></i></a><a href="#MIMETypeParameters-API" class="headerlink" title="MIMETypeParameters API"></a><code>MIMETypeParameters</code> API</h2>
      <p>The <code>MIMETypeParameters</code> class, instances of which are returned by <code>mimeType.parameters</code>, has equivalent surface API to a <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map">JavaScript <code>Map</code></a>.</p>
<p>However, <code>MIMETypeParameters</code> methods will always interpret their arguments as appropriate for MIME types, so e.g. parameter names will be lowercased, and attempting to set invalid characters will throw.</p>
<p>Some examples:</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mimeType = <span class="keyword">new</span> <span class="title class_">MIMEType</span>(<span class="string">`x/x;a=b;c=D;E=&quot;F&quot;`</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Logs:</span></span><br><span class="line"><span class="comment">// a b</span></span><br><span class="line"><span class="comment">// c D</span></span><br><span class="line"><span class="comment">// e F</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> [name, value] <span class="keyword">of</span> mimeType.<span class="property">parameters</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(name, value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">assert</span>(mimeType.<span class="property">parameters</span>.<span class="title function_">has</span>(<span class="string">&quot;a&quot;</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">assert</span>(mimeType.<span class="property">parameters</span>.<span class="title function_">has</span>(<span class="string">&quot;A&quot;</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">assert</span>(mimeType.<span class="property">parameters</span>.<span class="title function_">get</span>(<span class="string">&quot;A&quot;</span>) === <span class="string">&quot;b&quot;</span>);</span><br><span class="line"></span><br><span class="line">mimeType.<span class="property">parameters</span>.<span class="title function_">set</span>(<span class="string">&quot;Q&quot;</span>, <span class="string">&quot;X&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">assert</span>(mimeType.<span class="property">parameters</span>.<span class="title function_">get</span>(<span class="string">&quot;q&quot;</span>) === <span class="string">&quot;X&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">assert</span>(mimeType.<span class="title function_">toString</span>() === <span class="string">&quot;x/x;a=b;c=d;e=F;q=X&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Throws:</span></span><br><span class="line">mimeType.<span class="property">parameters</span>.<span class="title function_">set</span>(<span class="string">&quot;@&quot;</span>, <span class="string">&quot;x&quot;</span>);</span><br></pre></td></tr></table></div></figure>


        <h2 id="Raw-parsing-x2F-serialization-APIs"   >
          <a href="#Raw-parsing-x2F-serialization-APIs" class="heading-link"><i class="fas fa-link"></i></a><a href="#Raw-parsing-x2F-serialization-APIs" class="headerlink" title="Raw parsing&#x2F;serialization APIs"></a>Raw parsing&#x2F;serialization APIs</h2>
      <p>If you want primitives on which to build your own API, you can get direct access to the parsing and serialization algorithms as follows:</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> parse = <span class="built_in">require</span>(<span class="string">&quot;whatwg-mimetype/parser&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> serialize = <span class="built_in">require</span>(<span class="string">&quot;whatwg-mimetype/serialize&quot;</span>);</span><br></pre></td></tr></table></div></figure>

<p><code>parse(string)</code> returns an object containing the <code>type</code> and <code>subtype</code> strings, plus <code>parameters</code>, which is a <code>Map</code>. This is roughly our equivalent of the spec’s <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://mimesniff.spec.whatwg.org/#mime-type" >MIME type record</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>. If parsing fails, it instead returns <code>null</code>.</p>
<p><code>serialize(record)</code> operates on the such an object, giving back a string according to the serialization algorithm.</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2023/03/24/02_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E4%B8%8E%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/01_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8-demo/node_modules/whatwg-encoding/README/">[ Untitled ]</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2023-03-24</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">1985-10-26</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="Decode-According-to-the-WHATWG-Encoding-Standard"   >
          <a href="#Decode-According-to-the-WHATWG-Encoding-Standard" class="heading-link"><i class="fas fa-link"></i></a><a href="#Decode-According-to-the-WHATWG-Encoding-Standard" class="headerlink" title="Decode According to the WHATWG Encoding Standard"></a>Decode According to the WHATWG Encoding Standard</h1>
      <p>This package provides a thin layer on top of <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/ashtuchkin/iconv-lite" >iconv-lite</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> which makes it expose some of the same primitives as the <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://encoding.spec.whatwg.org/" >Encoding Standard</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>.</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> whatwgEncoding = <span class="built_in">require</span>(<span class="string">&quot;whatwg-encoding&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">assert</span>(whatwgEncoding.<span class="title function_">labelToName</span>(<span class="string">&quot;latin1&quot;</span>) === <span class="string">&quot;windows-1252&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">assert</span>(whatwgEncoding.<span class="title function_">labelToName</span>(<span class="string">&quot;  CYRILLic &quot;</span>) === <span class="string">&quot;ISO-8859-5&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">assert</span>(whatwgEncoding.<span class="title function_">isSupported</span>(<span class="string">&quot;IBM866&quot;</span>) === <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Not supported by the Encoding Standard</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">assert</span>(whatwgEncoding.<span class="title function_">isSupported</span>(<span class="string">&quot;UTF-32&quot;</span>) === <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// In the Encoding Standard, but this package can&#x27;t decode it</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">assert</span>(whatwgEncoding.<span class="title function_">isSupported</span>(<span class="string">&quot;x-mac-cyrillic&quot;</span>) === <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">assert</span>(whatwgEncoding.<span class="title function_">getBOMEncoding</span>(<span class="keyword">new</span> <span class="title class_">Buffer</span>([<span class="number">0xFE</span>, <span class="number">0xFF</span>])) === <span class="string">&quot;UTF-16BE&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">assert</span>(whatwgEncoding.<span class="title function_">getBOMEncoding</span>(<span class="keyword">new</span> <span class="title class_">Buffer</span>([<span class="number">0x48</span>, <span class="number">0x69</span>])) === <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">assert</span>(whatwgEncoding.<span class="title function_">decode</span>(<span class="keyword">new</span> <span class="title class_">Buffer</span>([<span class="number">0x48</span>, <span class="number">0x69</span>]), <span class="string">&quot;UTF-8&quot;</span>) === <span class="string">&quot;Hi&quot;</span>);</span><br></pre></td></tr></table></div></figure>


        <h2 id="API"   >
          <a href="#API" class="heading-link"><i class="fas fa-link"></i></a><a href="#API" class="headerlink" title="API"></a>API</h2>
      <ul>
<li><code>decode(buffer, fallbackEncodingName)</code>: performs the <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://encoding.spec.whatwg.org/#decode" >decode</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> algorithm (in which any BOM will override the passed fallback encoding), and returns the resulting string</li>
<li><code>labelToName(label)</code>: performs the <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://encoding.spec.whatwg.org/#concept-encoding-get" >get an encoding</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> algorithm and returns the resulting encoding’s name, or <code>null</code> for failure</li>
<li><code>isSupported(name)</code>: returns whether the encoding is one of <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://encoding.spec.whatwg.org/#names-and-labels" >the encodings</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> of the Encoding Standard, <em>and</em> is an encoding that this package can decode (via iconv-lite)</li>
<li><code>getBOMEncoding(buffer)</code>: sniffs the first 2–3 bytes of the supplied <code>Buffer</code>, returning one of the encoding names <code>&quot;UTF-8&quot;</code>, <code>&quot;UTF-16LE&quot;</code>, or <code>&quot;UTF-16BE&quot;</code> if the appropriate BOM is present, or <code>null</code> if no BOM is present</li>
</ul>

        <h2 id="Unsupported-encodings"   >
          <a href="#Unsupported-encodings" class="heading-link"><i class="fas fa-link"></i></a><a href="#Unsupported-encodings" class="headerlink" title="Unsupported encodings"></a>Unsupported encodings</h2>
      <p>Since we rely on iconv-lite, we are limited to support only the encodings that they support. Currently we are missing support for:</p>
<ul>
<li>ISO-2022-JP</li>
<li>ISO-8859-8-I</li>
<li>replacement</li>
<li>x-mac-cyrillic</li>
<li>x-user-defined</li>
</ul>
<p>Passing these encoding names will return <code>false</code> when calling <code>isSupported</code>, and passing any of the possible labels for these encodings to <code>labelToName</code> will return <code>null</code>.</p>

        <h2 id="Credits"   >
          <a href="#Credits" class="heading-link"><i class="fas fa-link"></i></a><a href="#Credits" class="headerlink" title="Credits"></a>Credits</h2>
      <p>This package was originally based on the excellent work of <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/nicolashenry" >@nicolashenry</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>, <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/tmpvar/jsdom/blob/7ce11776ce161e8d5921a7a183585327400f786b/lib/jsdom/living/helpers/encoding.js" >in jsdom</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>. It has since been pulled out into this separate package.</p>

        <h2 id="Alternatives"   >
          <a href="#Alternatives" class="heading-link"><i class="fas fa-link"></i></a><a href="#Alternatives" class="headerlink" title="Alternatives"></a>Alternatives</h2>
      <p>If you are looking for a JavaScript implementation of the Encoding Standard’s <code>TextEncoder</code> and <code>TextDecoder</code> APIs, you’ll want <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/inexorabletash" >@inexorabletash</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>‘s <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/inexorabletash/text-encoding" >text-encoding</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> package.</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2023/03/24/02_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E4%B8%8E%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/01_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8-demo/node_modules/webidl-conversions/README/">[ Untitled ]</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2023-03-24</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">1985-10-26</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="Web-IDL-Type-Conversions-on-JavaScript-Values"   >
          <a href="#Web-IDL-Type-Conversions-on-JavaScript-Values" class="heading-link"><i class="fas fa-link"></i></a><a href="#Web-IDL-Type-Conversions-on-JavaScript-Values" class="headerlink" title="Web IDL Type Conversions on JavaScript Values"></a>Web IDL Type Conversions on JavaScript Values</h1>
      <p>This package implements, in JavaScript, the algorithms to convert a given JavaScript value according to a given <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://heycam.github.io/webidl/" >Web IDL</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://heycam.github.io/webidl/#idl-types" >type</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>.</p>
<p>The goal is that you should be able to write code like</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> conversions = <span class="built_in">require</span>(<span class="string">&quot;webidl-conversions&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">doStuff</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">    x = conversions[<span class="string">&quot;boolean&quot;</span>](x);</span><br><span class="line">    y = conversions[<span class="string">&quot;unsigned long&quot;</span>](y);</span><br><span class="line">    <span class="comment">// actual algorithm code here</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>and your function <code>doStuff</code> will behave the same as a Web IDL operation declared as</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void doStuff(boolean x, unsigned long y);</span><br></pre></td></tr></table></div></figure>


        <h2 id="API"   >
          <a href="#API" class="heading-link"><i class="fas fa-link"></i></a><a href="#API" class="headerlink" title="API"></a>API</h2>
      <p>This package’s main module’s default export is an object with a variety of methods, each corresponding to a different Web IDL type. Each method, when invoked on a JavaScript value, will give back the new JavaScript value that results after passing through the Web IDL conversion rules. (See below for more details on what that means.) Alternately, the method could throw an error, if the Web IDL algorithm is specified to do so: for example <code>conversions[&quot;float&quot;](NaN)</code> <a target="_blank" rel="noopener" href="http://heycam.github.io/webidl/#es-float">will throw a <code>TypeError</code></a>.</p>
<p>Each method also accepts a second, optional, parameter for miscellaneous options. For conversion methods that throw errors, a string option <code>&#123; context &#125;</code> may be provided to provide more information in the error message. (For example, <code>conversions[&quot;float&quot;](NaN, &#123; context: &quot;Argument 1 of Interface&#39;s operation&quot; &#125;)</code> will throw an error with message <code>&quot;Argument 1 of Interface&#39;s operation is not a finite floating-point value.&quot;</code>)</p>
<p>If we are dealing with multiple JavaScript realms (such as those created using Node.js’ <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://nodejs.org/api/vm.html" >vm</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> module or the HTML <code>iframe</code> element), and exceptions from another realm need to be thrown, one can supply an object option <code>globals</code> containing the following properties:</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">globals</span>: &#123;</span><br><span class="line">    <span class="title class_">Number</span>,</span><br><span class="line">    <span class="title class_">String</span>,</span><br><span class="line">    <span class="title class_">TypeError</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>Those specific functions will be used when throwing exceptions.</p>
<p>Specific conversions may also accept other options, the details of which can be found below.</p>

        <h2 id="Conversions-implemented"   >
          <a href="#Conversions-implemented" class="heading-link"><i class="fas fa-link"></i></a><a href="#Conversions-implemented" class="headerlink" title="Conversions implemented"></a>Conversions implemented</h2>
      <p>Conversions for all of the basic types from the Web IDL specification are implemented:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://heycam.github.io/webidl/#es-any"><code>any</code></a></li>
<li><a target="_blank" rel="noopener" href="https://heycam.github.io/webidl/#es-void"><code>void</code></a></li>
<li><a target="_blank" rel="noopener" href="https://heycam.github.io/webidl/#es-boolean"><code>boolean</code></a></li>
<li><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://heycam.github.io/webidl/#es-integer-types" >Integer types</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>, which can additionally be provided the boolean options <code>&#123; clamp, enforceRange &#125;</code> as a second parameter</li>
<li><a target="_blank" rel="noopener" href="https://heycam.github.io/webidl/#es-float"><code>float</code></a>, <a target="_blank" rel="noopener" href="https://heycam.github.io/webidl/#es-unrestricted-float"><code>unrestricted float</code></a></li>
<li><a target="_blank" rel="noopener" href="https://heycam.github.io/webidl/#es-double"><code>double</code></a>, <a target="_blank" rel="noopener" href="https://heycam.github.io/webidl/#es-unrestricted-double"><code>unrestricted double</code></a></li>
<li><a target="_blank" rel="noopener" href="https://heycam.github.io/webidl/#es-DOMString"><code>DOMString</code></a>, which can additionally be provided the boolean option <code>&#123; treatNullAsEmptyString &#125;</code> as a second parameter</li>
<li><a target="_blank" rel="noopener" href="https://heycam.github.io/webidl/#es-ByteString"><code>ByteString</code></a>, <a target="_blank" rel="noopener" href="https://heycam.github.io/webidl/#es-USVString"><code>USVString</code></a></li>
<li><a target="_blank" rel="noopener" href="https://heycam.github.io/webidl/#es-object"><code>object</code></a></li>
<li><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://heycam.github.io/webidl/#es-buffer-source-types" >Buffer source types</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>, which can additionally be provided with the boolean option <code>&#123; allowShared &#125;</code> as a second parameter</li>
</ul>
<p>Additionally, for convenience, the following derived type definitions are implemented:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://heycam.github.io/webidl/#ArrayBufferView"><code>ArrayBufferView</code></a>, which can additionally be provided with the boolean option <code>&#123; allowShared &#125;</code> as a second parameter</li>
<li><a target="_blank" rel="noopener" href="https://heycam.github.io/webidl/#BufferSource"><code>BufferSource</code></a></li>
<li><a target="_blank" rel="noopener" href="https://heycam.github.io/webidl/#DOMTimeStamp"><code>DOMTimeStamp</code></a></li>
<li><a target="_blank" rel="noopener" href="https://heycam.github.io/webidl/#Function"><code>Function</code></a></li>
<li><a target="_blank" rel="noopener" href="https://heycam.github.io/webidl/#VoidFunction"><code>VoidFunction</code></a> (although it will not censor the return type)</li>
</ul>
<p>Derived types, such as nullable types, promise types, sequences, records, etc. are not handled by this library. You may wish to investigate the <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/jsdom/webidl2js" >webidl2js</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> project.</p>

        <h3 id="A-note-on-the-long-long-types"   >
          <a href="#A-note-on-the-long-long-types" class="heading-link"><i class="fas fa-link"></i></a><a href="#A-note-on-the-long-long-types" class="headerlink" title="A note on the long long types"></a>A note on the <code>long long</code> types</h3>
      <p>The <code>long long</code> and <code>unsigned long long</code> Web IDL types can hold values that cannot be stored in JavaScript numbers. Conversions are still accurate as we make use of BigInt in the conversion process, but in the case of <code>unsigned long long</code> we simply cannot represent some possible output values in JavaScript. For example, converting the JavaScript number <code>-1</code> to a Web IDL <code>unsigned long long</code> is supposed to produce the Web IDL value <code>18446744073709551615</code>. Since we are representing our Web IDL values in JavaScript, we can’t represent <code>18446744073709551615</code>, so we instead the best we could do is <code>18446744073709551616</code> as the output.</p>
<p>To mitigate this, we could return the raw BigInt value from the conversion function, but right now it is not implemented. If your use case requires such precision, <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/jsdom/webidl-conversions/issues/new" >file an issue</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>.</p>
<p>On the other hand, <code>long long</code> conversion is always accurate, since the input value can never be more precise than the output value.</p>

        <h3 id="A-note-on-BufferSource-types"   >
          <a href="#A-note-on-BufferSource-types" class="heading-link"><i class="fas fa-link"></i></a><a href="#A-note-on-BufferSource-types" class="headerlink" title="A note on BufferSource types"></a>A note on <code>BufferSource</code> types</h3>
      <p>All of the <code>BufferSource</code> types will throw when the relevant <code>ArrayBuffer</code> has been detached. This technically is not part of the <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://heycam.github.io/webidl/#es-buffer-source-types" >specified conversion algorithm</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>, but instead part of the <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://heycam.github.io/webidl/#ref-for-dfn-get-buffer-source-reference%E2%91%A0" >getting a reference&#x2F;getting a copy</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> algorithms. We’ve consolidated them here for convenience and ease of implementation, but if there is a need to separate them in the future, please open an issue so we can investigate.</p>

        <h2 id="Background"   >
          <a href="#Background" class="heading-link"><i class="fas fa-link"></i></a><a href="#Background" class="headerlink" title="Background"></a>Background</h2>
      <p>What’s actually going on here, conceptually, is pretty weird. Let’s try to explain.</p>
<p>Web IDL, as part of its madness-inducing design, has its own type system. When people write algorithms in web platform specs, they usually operate on Web IDL values, i.e. instances of Web IDL types. For example, if they were specifying the algorithm for our <code>doStuff</code> operation above, they would treat <code>x</code> as a Web IDL value of <a target="_blank" rel="noopener" href="http://heycam.github.io/webidl/#idl-boolean">Web IDL type <code>boolean</code></a>. Crucially, they would <em>not</em> treat <code>x</code> as a JavaScript variable whose value is either the JavaScript <code>true</code> or <code>false</code>. They’re instead working in a different type system altogether, with its own rules.</p>
<p>Separately from its type system, Web IDL defines a <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://heycam.github.io/webidl/#ecmascript-binding" >“binding”</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> of the type system into JavaScript. This contains rules like: when you pass a JavaScript value to the JavaScript method that manifests a given Web IDL operation, how does that get converted into a Web IDL value? For example, a JavaScript <code>true</code> passed in the position of a Web IDL <code>boolean</code> argument becomes a Web IDL <code>true</code>. But, a JavaScript <code>true</code> passed in the position of a <a target="_blank" rel="noopener" href="http://heycam.github.io/webidl/#idl-unsigned-long">Web IDL <code>unsigned long</code></a> becomes a Web IDL <code>1</code>. And so on.</p>
<p>Finally, we have the actual implementation code. This is usually C++, although these days <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/servo/servo" >some smart people are using Rust</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>. The implementation, of course, has its own type system. So when they implement the Web IDL algorithms, they don’t actually use Web IDL values, since those aren’t “real” outside of specs. Instead, implementations apply the Web IDL binding rules in such a way as to convert incoming JavaScript values into C++ values. For example, if code in the browser called <code>doStuff(true, true)</code>, then the implementation code would eventually receive a C++ <code>bool</code> containing <code>true</code> and a C++ <code>uint32_t</code> containing <code>1</code>.</p>
<p>The upside of all this is that implementations can abstract all the conversion logic away, letting Web IDL handle it, and focus on implementing the relevant methods in C++ with values of the correct type already provided. That is payoff of Web IDL, in a nutshell.</p>
<p>And getting to that payoff is the goal of <em>this</em> project—but for JavaScript implementations, instead of C++ ones. That is, this library is designed to make it easier for JavaScript developers to write functions that behave like a given Web IDL operation. So conceptually, the conversion pipeline, which in its general form is JavaScript values ↦ Web IDL values ↦ implementation-language values, in this case becomes JavaScript values ↦ Web IDL values ↦ JavaScript values. And that intermediate step is where all the logic is performed: a JavaScript <code>true</code> becomes a Web IDL <code>1</code> in an unsigned long context, which then becomes a JavaScript <code>1</code>.</p>

        <h2 id="Don’t-use-this"   >
          <a href="#Don’t-use-this" class="heading-link"><i class="fas fa-link"></i></a><a href="#Don’t-use-this" class="headerlink" title="Don’t use this"></a>Don’t use this</h2>
      <p>Seriously, why would you ever use this? You really shouldn’t. Web IDL is … strange, and you shouldn’t be emulating its semantics. If you’re looking for a generic argument-processing library, you should find one with better rules than those from Web IDL. In general, your JavaScript should not be trying to become more like Web IDL; if anything, we should fix Web IDL to make it more like JavaScript.</p>
<p>The <em>only</em> people who should use this are those trying to create faithful implementations (or polyfills) of web platform interfaces defined in Web IDL. Its main consumer is the <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/jsdom/jsdom" >jsdom</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> project.</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2023/03/24/02_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E4%B8%8E%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/01_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8-demo/node_modules/webidl-conversions/LICENSE/">[ Untitled ]</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2023-03-24</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">1985-10-26</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="The-BSD-2-Clause-License"   >
          <a href="#The-BSD-2-Clause-License" class="heading-link"><i class="fas fa-link"></i></a><a href="#The-BSD-2-Clause-License" class="headerlink" title="The BSD 2-Clause License"></a>The BSD 2-Clause License</h1>
      <p>Copyright (c) 2014, Domenic Denicola<br>All rights reserved.</p>
<p>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</p>
<ol>
<li><p>Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</p>
</li>
<li><p>Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and&#x2F;or other materials provided with the distribution.</p>
</li>
</ol>
<p>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2023/03/24/02_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E4%B8%8E%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/01_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8-demo/node_modules/w3c-xmlserializer/README/">[ Untitled ]</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2023-03-24</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">1985-10-26</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="w3c-xmlserializer"   >
          <a href="#w3c-xmlserializer" class="heading-link"><i class="fas fa-link"></i></a><a href="#w3c-xmlserializer" class="headerlink" title="w3c-xmlserializer"></a>w3c-xmlserializer</h1>
      <p>An XML serializer that follows the <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://w3c.github.io/DOM-Parsing/" >W3C specification</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>.</p>
<p>This package can be used in Node.js, as long as you feed it a DOM node, e.g. one produced by <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/jsdom/jsdom" >jsdom</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>.</p>

        <h2 id="Basic-usage"   >
          <a href="#Basic-usage" class="heading-link"><i class="fas fa-link"></i></a><a href="#Basic-usage" class="headerlink" title="Basic usage"></a>Basic usage</h2>
      <p>Assume you have a DOM tree rooted at a node <code>node</code>. In Node.js, you could create this using <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/jsdom/jsdom" >jsdom</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> as follows:</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; <span class="variable constant_">JSDOM</span> &#125; = <span class="built_in">require</span>(<span class="string">&quot;jsdom&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="variable language_">document</span> &#125; = <span class="keyword">new</span> <span class="title function_">JSDOM</span>().<span class="property">window</span>;</span><br><span class="line"><span class="keyword">const</span> node = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;akomaNtoso&quot;</span>);</span><br></pre></td></tr></table></div></figure>

<p>Then, you use this package as follows:</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> serialize = <span class="built_in">require</span>(<span class="string">&quot;w3c-xmlserializer&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">serialize</span>(node));</span><br><span class="line"><span class="comment">// =&gt; &#x27;&lt;akomantoso xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;/akomantoso&gt;&#x27;</span></span><br></pre></td></tr></table></div></figure>


        <h2 id="requireWellFormed-option"   >
          <a href="#requireWellFormed-option" class="heading-link"><i class="fas fa-link"></i></a><a href="#requireWellFormed-option" class="headerlink" title="requireWellFormed option"></a><code>requireWellFormed</code> option</h2>
      <p>By default the input DOM tree is not required to be “well-formed”; any given input will serialize to some output string. You can instead require well-formedness via</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">serialize</span>(node, &#123; <span class="attr">requireWellFormed</span>: <span class="literal">true</span> &#125;);</span><br></pre></td></tr></table></div></figure>

<p>which will cause <code>Error</code>s to be thrown when non-well-formed constructs are encountered. <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://w3c.github.io/DOM-Parsing/#dfn-require-well-formed" >Per the spec</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>, this largely is about imposing constraints on the names of elements, attributes, etc.</p>
<p>As a point of reference, on the web platform:</p>
<ul>
<li>The <a target="_blank" rel="noopener" href="https://w3c.github.io/DOM-Parsing/#dom-innerhtml-innerhtml"><code>innerHTML</code> getter</a> uses the require-well-formed mode, i.e. trying to get the <code>innerHTML</code> of non-well-formed subtrees will throw.</li>
<li>The <a target="_blank" rel="noopener" href="https://xhr.spec.whatwg.org/#the-send()-method"><code>xhr.send()</code> method</a> does not require well-formedness, i.e. sending non-well-formed <code>Document</code>s will serialize and send them anyway.</li>
</ul>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2023/03/24/02_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E4%B8%8E%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/01_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8-demo/node_modules/w3c-xmlserializer/LICENSE/">[ Untitled ]</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2023-03-24</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">1985-10-26</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="The-MIT-License-MIT"   >
          <a href="#The-MIT-License-MIT" class="heading-link"><i class="fas fa-link"></i></a><a href="#The-MIT-License-MIT" class="headerlink" title="The MIT License (MIT)"></a>The MIT License (MIT)</h1>
      <p>Copyright © 2016 Sebastian Mayr</p>
<p>Permission is hereby granted, free of charge, to any person<br>obtaining a copy of this software and associated documentation<br>files (the “Software”), to deal in the Software without<br>restriction, including without limitation the rights to use,<br>copy, modify, merge, publish, distribute, sublicense, and&#x2F;or sell<br>copies of the Software, and to permit persons to whom the<br>Software is furnished to do so, subject to the following<br>conditions:</p>
<p>The above copyright notice and this permission notice shall be<br>included in all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND,<br>EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES<br>OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND<br>NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT<br>HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,<br>WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING<br>FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR<br>OTHER DEALINGS IN THE SOFTWARE.</p>
</div></div></article></section><nav class="paginator"><div class="paginator-inner"><a class="extend prev" rel="prev" href="/"><i class="fas fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><a class="extend next" rel="next" href="/page/3/"><i class="fas fa-angle-right"></i></a></div></nav></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><section class="sidebar-toc hide"></section><!-- ov = overview--><section class="sidebar-ov"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/icons/cat.jpg" alt="avatar"></div><p class="sidebar-ov-author__text">Hello Stun</p></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">144</div><div class="sidebar-ov-state-item__name">Archives</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="Creative Commons" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2023</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>汪汪队</span></div><div><span>Powered by <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a></span><span> v6.3.0</span><span class="footer__devider">|</span><span>Theme - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.8.0</span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="/js/utils.js?v=2.8.0"></script><script src="/js/stun-boot.js?v=2.8.0"></script><script src="/js/scroll.js?v=2.8.0"></script><script src="/js/header.js?v=2.8.0"></script><script src="/js/sidebar.js?v=2.8.0"></script></body></html>