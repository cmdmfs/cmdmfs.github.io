<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.8.0" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.8.0" type="image/png" sizes="32x32"><meta name="description" content="have a try try">
<meta property="og:type" content="website">
<meta property="og:title" content="汪汪队">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="汪汪队">
<meta property="og:description" content="have a try try">
<meta property="og:locale">
<meta property="article:author" content="汪汪队">
<meta name="twitter:card" content="summary"><title>汪汪队</title><link ref="canonical" href="http://example.com/index.html"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.8.0"><link rel="stylesheet" href="css/custom.css"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"Copiar","copySuccess":"Éxito en copia","copyError":"Error en copia"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 6.3.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">Inicio</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">Archivos</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">cmdmfs's blogs</div><div class="header-banner-info__subtitle">英年早睡</div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content content-home" id="content"><section class="postlist"><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2023/03/24/04_ES6/04_map%E4%B8%8EWeakMap/map%E4%B8%8Eweakmap/">[ Sin título ]</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Creado</span><span class="post-meta-item__value">2023-03-24</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Actualizado</span><span class="post-meta-item__value">2023-02-24</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="map与weakmap"   >
          <a href="#map与weakmap" class="heading-link"><i class="fas fa-link"></i></a><a href="#map与weakmap" class="headerlink" title="map与weakmap"></a>map与weakmap</h1>
      
        <h2 id="1-map"   >
          <a href="#1-map" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-map" class="headerlink" title="1. map"></a>1. map</h2>
      
        <h3 id="1-1-map特点（map与对象的区别？）"   >
          <a href="#1-1-map特点（map与对象的区别？）" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-1-map特点（map与对象的区别？）" class="headerlink" title="1.1 map特点（map与对象的区别？）"></a>1.1 map特点（map与对象的区别？）</h3>
      <ul>
<li><p>Map的键和值可以是任何<strong>数据类型</strong></p>
<p>object的key必须是字符串</p>
<p>weakMap的key必须是对象</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1. map的键名可以是任意数据</span></span><br><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line"><span class="keyword">var</span> o = &#123;<span class="attr">num</span>:<span class="number">1</span>&#125;;</span><br><span class="line">map.<span class="title function_">set</span>(o,<span class="string">&#x27;111&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(map);</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>键值对按照插入顺序<strong>排列</strong></p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// map有顺序</span></span><br><span class="line"> <span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">Map</span>([[<span class="number">2</span>,<span class="string">&#x27;111&#x27;</span>],[<span class="number">1</span>,<span class="string">&#x27;222&#x27;</span>]]);</span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(map);</span><br><span class="line"></span><br><span class="line"><span class="comment">// obj自动排序，只对key是字符串数值的情况，是字母不排序</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;<span class="string">&#x27;2&#x27;</span>:<span class="string">&#x27;111&#x27;</span>,<span class="string">&#x27;1&#x27;</span>:<span class="string">&#x27;222&#x27;</span>&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj);</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>map数据可迭代，object数据不可<strong>迭代</strong></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var map = new Map([[2,&#x27;111&#x27;],[1,&#x27;222&#x27;]]);</span><br><span class="line">console.log(map);</span><br><span class="line">for(var value of map)&#123;</span><br><span class="line">	console.log(value)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li>
</ul>

        <h3 id="1-2-map的常用属性"   >
          <a href="#1-2-map的常用属性" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-2-map的常用属性" class="headerlink" title="1.2 map的常用属性"></a>1.2 map的常用属性</h3>
      <div class="table-container"><table>
<thead>
<tr>
<th>操作方法</th>
<th>内容描述</th>
</tr>
</thead>
<tbody><tr>
<td>map.set(key,value)</td>
<td>添加键值对到映射中</td>
</tr>
<tr>
<td>map.get(key)</td>
<td>获取映射中某一个键的对应值</td>
</tr>
<tr>
<td>map.delete(key)</td>
<td>将某一键值对移除映射</td>
</tr>
<tr>
<td>map.clear()</td>
<td>清空映射中所有键值对</td>
</tr>
<tr>
<td><strong>map.entries()</strong></td>
<td>返回一个以二元数组（键值对）作为元素的数组</td>
</tr>
<tr>
<td>map.has(key)</td>
<td>检查映射中是否包含某一键值对</td>
</tr>
<tr>
<td><strong>map.keys()</strong></td>
<td>返回一个当前映射中所有键作为元素的可迭代对象</td>
</tr>
<tr>
<td><strong>map.values()</strong></td>
<td>返回一个当前映射中所有值作为元素的可迭代对象</td>
</tr>
<tr>
<td>map.size</td>
<td>映射中键值对的数量</td>
</tr>
</tbody></table></div>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line"><span class="keyword">let</span> o = &#123;<span class="attr">n</span>: <span class="number">1</span>&#125;;</span><br><span class="line"><span class="comment">// 给map添加o属性，值是’A‘</span></span><br><span class="line">map.<span class="title function_">set</span>(o, <span class="string">&quot;A&quot;</span>); </span><br><span class="line"><span class="comment">// 给map添加&#x27;2&#x27;属性，值是9</span></span><br><span class="line">map.<span class="title function_">set</span>(<span class="string">&quot;2&quot;</span>, <span class="number">9</span>);</span><br><span class="line"><span class="comment">// 判断是否存在’2‘属性</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(map.<span class="title function_">has</span>(<span class="string">&quot;2&quot;</span>)); </span><br><span class="line"><span class="comment">// 获取o属性值</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(map.<span class="title function_">get</span>(o)); </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(...map);</span><br><span class="line"><span class="comment">// 查看map</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(map);</span><br><span class="line"><span class="comment">// 删除’2‘属性</span></span><br><span class="line">map.<span class="title function_">delete</span>(<span class="string">&quot;2&quot;</span>); </span><br><span class="line"><span class="comment">// 清空所有属性</span></span><br><span class="line">map.<span class="title function_">clear</span>(); </span><br><span class="line"><span class="comment">//create a map from iterable object</span></span><br><span class="line"><span class="keyword">let</span> map_1 = <span class="keyword">new</span> <span class="title class_">Map</span>([[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">4</span>, <span class="number">5</span>]]);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(map_1.<span class="property">size</span>); <span class="comment">//number of keys</span></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h3 id="1-3-遍历map数据"   >
          <a href="#1-3-遍历map数据" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-3-遍历map数据" class="headerlink" title="1.3 遍历map数据"></a>1.3 遍历map数据</h3>
      <ul>
<li><code>keys()</code>：返回键名的遍历器</li>
<li><code>values()</code>：返回键值的遍历器</li>
<li><code>entries()</code>：返回键值对的遍历器</li>
<li><code>forEach()</code>：使用回调函数遍历每个成员</li>
</ul>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="title class_">Map</span>([</span><br><span class="line">  [<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>],</span><br><span class="line">  [<span class="string">&#x27;b&#x27;</span>, <span class="number">2</span>],</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> map.<span class="title function_">keys</span>()) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(key)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// &quot;a&quot;</span></span><br><span class="line"><span class="comment">// &quot;b&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> value <span class="keyword">of</span> map.<span class="title function_">values</span>()) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(value)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> map.<span class="title function_">entries</span>()) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(item)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// [&quot;a&quot;, 1]</span></span><br><span class="line"><span class="comment">// [&quot;b&quot;, 2]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 或者</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> map.<span class="title function_">entries</span>()) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(key, value)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// &quot;a&quot; 1</span></span><br><span class="line"><span class="comment">// &quot;b&quot; 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// for...of...遍历map等同于使用map.entries()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> map) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(key, value)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// &quot;a&quot; 1</span></span><br><span class="line"><span class="comment">// &quot;b&quot; 2</span></span><br></pre></td></tr></table></div></figure>


        <h2 id="2-WeakMap"   >
          <a href="#2-WeakMap" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-WeakMap" class="headerlink" title="2. WeakMap"></a>2. WeakMap</h2>
      
        <h3 id="2-1-WeakMap特点"   >
          <a href="#2-1-WeakMap特点" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-1-WeakMap特点" class="headerlink" title="2.1 WeakMap特点"></a>2.1 WeakMap特点</h3>
      <p><code>WeakMap</code> 结构与 <code>Map</code> 结构类似，也是用于生成键值对的集合。</p>
<ul>
<li><p>只接受对象作为键名（<code>null</code> 除外），不接受其他类型的值作为键名</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 只能使用对象作为键名</span></span><br><span class="line"><span class="keyword">var</span> weakmap = <span class="keyword">new</span> <span class="title class_">WeakMap</span>();</span><br><span class="line"><span class="comment">// weakmap.set(&#x27;a&#x27;,111);</span></span><br><span class="line"><span class="keyword">var</span> o = &#123;<span class="attr">num</span>:<span class="number">1</span>&#125;;</span><br><span class="line">weakmap.<span class="title function_">set</span>(o,<span class="number">111</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(weakmap);</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>键名是弱引用，键值可以是任意的，键名所指向的对象可以被垃圾回收，此时键名是无效的</p>
<blockquote>
<p>而map可以理解为是将对象类型的key进行了深拷贝，所以原对象删除也没有影响</p>
</blockquote>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2. 键名是弱引用，如果键名销毁，该属性就销毁 (IE打开)</span></span><br><span class="line"><span class="keyword">var</span> weakmap = <span class="keyword">new</span> <span class="title class_">WeakMap</span>();</span><br><span class="line"><span class="keyword">var</span> o = &#123;<span class="attr">num</span>:<span class="number">1</span>&#125;;</span><br><span class="line">weakmap.<span class="title function_">set</span>(o,<span class="number">111</span>);</span><br><span class="line">o = <span class="literal">null</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(weakmap);</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>不可枚举，枚举影响其列表将会受垃圾回收机制的影响，方法有 <code>get</code>、<code>set</code>、<code>has</code>、<code>delete</code></p>
</li>
</ul>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2023/03/24/04_ES6/03_%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0/%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0/">[ Sin título ]</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Creado</span><span class="post-meta-item__value">2023-03-24</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Actualizado</span><span class="post-meta-item__value">2023-02-24</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="箭头函数"   >
          <a href="#箭头函数" class="heading-link"><i class="fas fa-link"></i></a><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h1>
      
        <h2 id="1-箭头函数没有this-this是从外部获取的"   >
          <a href="#1-箭头函数没有this-this是从外部获取的" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-箭头函数没有this-this是从外部获取的" class="headerlink" title="1. 箭头函数没有this,this是从外部获取的"></a>1. 箭头函数没有this,this是从外部获取的</h2>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> group = &#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="string">&quot;Our Group&quot;</span>,</span><br><span class="line">  <span class="attr">students</span>: [<span class="string">&quot;John&quot;</span>, <span class="string">&quot;Pete&quot;</span>, <span class="string">&quot;Alice&quot;</span>],</span><br><span class="line"></span><br><span class="line">  <span class="title function_">showList</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">students</span>.<span class="title function_">forEach</span>(</span><br><span class="line">      <span class="function"><span class="params">student</span> =&gt;</span> <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">title</span> + <span class="string">&#x27;: &#x27;</span> + student)</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">group.<span class="title function_">showList</span>();</span><br></pre></td></tr></table></div></figure>


        <h2 id="2-箭头函数不能对箭头函数进行-new-操作"   >
          <a href="#2-箭头函数不能对箭头函数进行-new-操作" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-箭头函数不能对箭头函数进行-new-操作" class="headerlink" title="2. 箭头函数不能对箭头函数进行 new 操作"></a>2. 箭头函数<strong>不能对箭头函数进行 <code>new</code> 操作</strong></h2>
      <p>不具有 <code>this</code> 自然也就意味着另一个限制：箭头函数不能用作构造器（constructor）。不能用 <code>new</code> 调用它们。</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title function_">Foo</span> = (<span class="params"></span>) =&gt; &#123;&#125;;</span><br><span class="line"><span class="keyword">var</span> foo = <span class="keyword">new</span> <span class="title class_">Foo</span>(); <span class="comment">// TypeError: Foo is not a constructor</span></span><br></pre></td></tr></table></div></figure>


        <h2 id="3-箭头函数没有arguments"   >
          <a href="#3-箭头函数没有arguments" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-箭头函数没有arguments" class="headerlink" title="3. 箭头函数没有arguments"></a>3. 箭头函数没有arguments</h2>
      <p>箭头函数没有自己的 arguments （存放函数参数的集合）对象，但是箭头函数可以访问外围函数的 arguments 对象：</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">constant</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="variable language_">arguments</span>[<span class="number">0</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> result = <span class="title function_">constant</span>(<span class="number">1</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">result</span>()); <span class="comment">// 1</span></span><br></pre></td></tr></table></div></figure>


        <h2 id="4-箭头函数没有原型和super"   >
          <a href="#4-箭头函数没有原型和super" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-箭头函数没有原型和super" class="headerlink" title="4. 箭头函数没有原型和super"></a>4. 箭头函数没有原型和super</h2>
      <p><strong>连原型都没有，自然也不能通过 super 来访问原型的属性</strong>，所以箭头函数也是没有 super 的，不过跟 this、arguments、new.target 一样，这些值由外围最近一层非箭头函数决定。</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title function_">Foo</span> = (<span class="params"></span>) =&gt; &#123;&#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Foo</span>.<span class="property"><span class="keyword">prototype</span></span>); <span class="comment">// undefined</span></span><br></pre></td></tr></table></div></figure>

</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2023/03/24/04_ES6/02_%E8%A7%A3%E6%9E%84%E7%AC%A6%E5%8F%B7/%E8%A7%A3%E6%9E%84%E7%AC%A6%E5%8F%B7/">[ Sin título ]</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Creado</span><span class="post-meta-item__value">2023-03-24</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Actualizado</span><span class="post-meta-item__value">2023-02-23</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="解构符号"   >
          <a href="#解构符号" class="heading-link"><i class="fas fa-link"></i></a><a href="#解构符号" class="headerlink" title="解构符号"></a>解构符号</h1>
      
        <h2 id="1-解构符号的作用"   >
          <a href="#1-解构符号的作用" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-解构符号的作用" class="headerlink" title="1. 解构符号的作用"></a>1. 解构符号的作用</h2>
      <p>解构赋值是对赋值运算符的扩展，他是一种针对<strong>数组或者对象或字符串</strong>进行模式匹配，然后对其中的变量进行赋值</p>
<p>ES6 允许按照一定模式，从数组和对象中提取值，对变量进行赋值，这被称为<strong>解构</strong></p>

        <h2 id="2-使用方式"   >
          <a href="#2-使用方式" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-使用方式" class="headerlink" title="2. 使用方式"></a>2. 使用方式</h2>
      <ul>
<li><p>基本使用</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> [a, b, c] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="comment">// let a = 1,b = 2,c=3</span></span><br></pre></td></tr></table></div></figure>
</li>
<li><p>嵌套使用</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// 数组</span></span><br><span class="line"> <span class="keyword">let</span> [a, [[b], c]] = [<span class="number">1</span>, [[<span class="number">2</span>], <span class="number">3</span>]];</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(c);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对象</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;<span class="attr">p</span>: [<span class="string">&#x27;hello&#x27;</span>, &#123;<span class="attr">y</span>: <span class="string">&#x27;world&#x27;</span>&#125;] &#125;;</span><br><span class="line"><span class="keyword">let</span> &#123;<span class="attr">p</span>: [x, &#123; y &#125;] &#125; = obj;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(x);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(y);</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>忽略</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数组</span></span><br><span class="line"><span class="keyword">let</span> [a, , b] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对象</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">p</span>: [<span class="string">&#x27;hello&#x27;</span>, &#123; <span class="attr">y</span>: <span class="string">&#x27;world&#x27;</span> &#125;] &#125;;</span><br><span class="line"><span class="keyword">let</span> &#123; <span class="attr">p</span>: [x, &#123; &#125;] &#125; = obj;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(x);</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>不完全解构</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// 数组</span></span><br><span class="line"> <span class="keyword">let</span> [a = <span class="number">1</span>, b] = [];</span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(b);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对象</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">p</span>: [&#123; <span class="attr">y</span>: <span class="string">&#x27;world&#x27;</span> &#125;] &#125;;</span><br><span class="line"><span class="keyword">let</span> &#123; <span class="attr">p</span>: [&#123; y &#125;, x] &#125; = obj;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(x);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(y);</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>剩余运算符</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数组</span></span><br><span class="line"><span class="comment">// let [a, ...b] = [1, 2, 3];</span></span><br><span class="line"><span class="comment">// console.log(a);</span></span><br><span class="line"><span class="comment">// console.log(b);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 对象</span></span><br><span class="line"><span class="keyword">let</span> &#123;a, b, ...rest&#125; = &#123;<span class="attr">a</span>: <span class="number">10</span>, <span class="attr">b</span>: <span class="number">20</span>, <span class="attr">c</span>: <span class="number">30</span>, <span class="attr">d</span>: <span class="number">40</span>&#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(rest);</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>字符串</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> [a, b, c, d, e] = <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(c);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(d);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(e);</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>解构<strong>默认值</strong></p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 当解构模式有匹配结果，且匹配结果是 undefined 时，会触发默认值作为返回结果。</span></span><br><span class="line"><span class="keyword">let</span> [a = <span class="number">2</span>] = [<span class="literal">undefined</span>]; </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line"><span class="comment">// 对象</span></span><br><span class="line"><span class="keyword">let</span> &#123;a = <span class="number">10</span>, b = <span class="number">5</span>&#125; = &#123;<span class="attr">a</span>: <span class="number">3</span>&#125;;</span><br><span class="line"><span class="comment">// console.log(a);</span></span><br><span class="line"><span class="comment">// console.log(b);</span></span><br></pre></td></tr></table></div></figure>
</li>
<li><p><strong>交换变量的值</strong>.</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">let</span> b = <span class="number">2</span>;</span><br><span class="line">[a,b] = [b,a];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b);</span><br></pre></td></tr></table></div></figure></li>
</ul>

        <h2 id="3-解构赋值的应用"   >
          <a href="#3-解构赋值的应用" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-解构赋值的应用" class="headerlink" title="3. 解构赋值的应用"></a>3. 解构赋值的应用</h2>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 浅克隆与合并</span></span><br><span class="line"><span class="keyword">let</span> name = &#123; <span class="attr">name</span>: <span class="string">&quot;aaa&quot;</span> &#125;</span><br><span class="line"><span class="keyword">let</span> age = &#123; <span class="attr">age</span>: <span class="string">&#x27;bbb&#x27;</span> &#125;</span><br><span class="line"><span class="keyword">let</span> person = &#123; ...name, ...age &#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person) <span class="comment">// &#123; name: &quot;aaa&quot;, age: &#x27;bbb&#x27; &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> b = [<span class="number">4</span>,<span class="number">5</span>];</span><br><span class="line"><span class="keyword">let</span> c = [...a,...b];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(c);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 提取JSON数据</span></span><br><span class="line"><span class="keyword">let</span> <span class="title class_">JsonData</span> = &#123; <span class="attr">id</span>: <span class="number">10</span>, <span class="attr">status</span>: <span class="string">&quot;OK&quot;</span>, <span class="attr">data</span>: [<span class="number">111</span>, <span class="number">222</span>] &#125; </span><br><span class="line"><span class="keyword">let</span> &#123; id, status, <span class="attr">data</span>: numbers &#125; = <span class="title class_">JsonData</span>; </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(id, status, numbers); <span class="comment">//10 &quot;OK&quot; [111, 222]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 函数参数的定义</span></span><br><span class="line"><span class="comment">// 参数有序</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params">[a, b, c]</span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(a, b, c) &#125; </span><br><span class="line"><span class="title function_">fun1</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]); </span><br><span class="line"></span><br><span class="line"><span class="comment">// 参数无序</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fun2</span>(<span class="params">&#123; x, y, z &#125;</span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(x, y, z) &#125; </span><br><span class="line"><span class="title function_">fun2</span>(&#123; <span class="attr">z</span>: <span class="number">3</span>, <span class="attr">x</span>: <span class="number">2</span>, <span class="attr">y</span>: <span class="number">1</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 参数有默认值</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fun3</span> ([a=<span class="number">1</span>,b]) &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a,b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">fun3</span>([,<span class="number">3</span>])</span><br></pre></td></tr></table></div></figure>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2023/03/24/04_ES6/01_let_const_var/var%20let%20const/">[ Sin título ]</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Creado</span><span class="post-meta-item__value">2023-03-24</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Actualizado</span><span class="post-meta-item__value">2023-02-24</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="let-const-var"   >
          <a href="#let-const-var" class="heading-link"><i class="fas fa-link"></i></a><a href="#let-const-var" class="headerlink" title="let const var"></a>let const var</h1>
      
        <h2 id="1-var-关键字"   >
          <a href="#1-var-关键字" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-var-关键字" class="headerlink" title="1. var 关键字"></a>1. var 关键字</h2>
      <ul>
<li><p>声明的全局变量挂载在window对象下</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">window</span>.<span class="property">a</span>)</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>变量提升</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>声明的变量可以重复声明和修改</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> a = <span class="string">&#x27;111&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br></pre></td></tr></table></div></figure></li>
</ul>

        <h2 id="2-let-和-const-关键字"   >
          <a href="#2-let-和-const-关键字" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-let-和-const-关键字" class="headerlink" title="2. let 和 const 关键字"></a>2. let 和 const 关键字</h2>
      <ul>
<li><p>let和const声明的全局变量不挂载在window对象下（在script对象下）</p>
</li>
<li><p>let 和 const 定义的变量不会出现变量提升现象，let&#x2F;const 也存在<strong>变量声明提升</strong>，只是<strong>没有初始化分配内存</strong>。 </p>
<blockquote>
<p>一个变量有三个操作，声明(提到作用域顶部)，初始化(赋默认值)，赋值(继续赋值)，其实就是创建提升，因为没有初始化分配内存，所以使用该变量就会报错，这是<strong>暂时性死区</strong></p>
</blockquote>
</li>
<li><p>let 和 const 是JS中的块级作用域</p>
</li>
<li><p>let 和 const 不允许重复声明(会抛出错误)</p>
</li>
<li><p>const 声明一个只读的常量。一旦声明，常量的值就不能改变(如果声明是一个对象，那么不能改变的是对象的引用地址)</p>
</li>
</ul>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2023/03/24/03_js%E6%89%A7%E8%A1%8C%E6%9C%BA%E5%88%B6/04_this%E6%8C%87%E5%90%91/this%E6%8C%87%E5%90%91/">[ Sin título ]</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Creado</span><span class="post-meta-item__value">2023-03-24</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Actualizado</span><span class="post-meta-item__value">2023-03-24</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="this指向"   >
          <a href="#this指向" class="heading-link"><i class="fas fa-link"></i></a><a href="#this指向" class="headerlink" title="this指向"></a>this指向</h1>
      
        <h2 id="1-this关键字由来"   >
          <a href="#1-this关键字由来" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-this关键字由来" class="headerlink" title="1. this关键字由来"></a>1. <strong>this关键字由来</strong></h2>
      <p><strong>this关键字由来</strong>：<strong>在对象内部的方法中使用对象内部的属性</strong>是一个非常普遍的需求。但是 JavaScript 的作用域机制并不支持这一点，基于这个需求，JavaScript 又搞出来另外一套 this 机制。</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> bar = &#123;  <span class="comment">//bar是个对象，不是函数（函数里可以访问到myName）</span></span><br><span class="line">	<span class="attr">myName</span>:<span class="string">&quot;闷倒驴&quot;</span>, </span><br><span class="line">	<span class="attr">printName</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(myName) &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> myName = <span class="string">&#x27;王美丽&#x27;</span>;</span><br><span class="line">bar.<span class="title function_">printName</span>(); <span class="comment">// &#x27;王美丽&#x27;</span></span><br></pre></td></tr></table></div></figure>

<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> bar = &#123; </span><br><span class="line">	<span class="attr">myName</span>:<span class="string">&quot;闷倒驴&quot;</span>, </span><br><span class="line">	<span class="attr">printName</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">myName</span>) &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> myName = <span class="string">&#x27;王美丽&#x27;</span>;</span><br><span class="line">bar.<span class="title function_">printName</span>(); <span class="comment">// &#x27;王美丽&#x27;</span></span><br></pre></td></tr></table></div></figure>

<p><strong>作用域链和 this 是两套不同的系统，它们之间基本没太多联系</strong></p>

        <h2 id="2-this在哪里可以使用"   >
          <a href="#2-this在哪里可以使用" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-this在哪里可以使用" class="headerlink" title="2. this在哪里可以使用"></a>2. this在哪里可以使用</h2>
      <p><strong>全局上下文中的this</strong></p>
<p>console.log(this)来打印出来全局执行上下文中的 this，最终输出的是 window 对象。所以你可以得出这样一个结论：全局执行上下文中的 this 是指向 window 对象的。这也是 this 和作用域链的唯一交点，作用域链的最底端包含了 window 对象，全局执行上下文中的 this 也是指向 window 对象</p>
<p><strong>函数上下文中的this</strong></p>
<ul>
<li><p>在全局环境中调用一个函数，函数内部的 this 指向的是全局变量 window。</p>
</li>
<li><p>通过一个<strong>对象来调用其内部的一个方法</strong>，该方法的执行上下文中的 this 指向对象本身</p>
</li>
</ul>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">// &#x27;use strict&#x27;;</span></span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title function_">foo</span>() <span class="comment">// window</span></span><br></pre></td></tr></table></div></figure>


        <h2 id="3-this指向总结"   >
          <a href="#3-this指向总结" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-this指向总结" class="headerlink" title="3. this指向总结"></a>3. this指向总结</h2>
      <p><strong>this指向总结</strong></p>
<ul>
<li><p>&#x3D;&#x3D;当函数被正常调用时，在严格模式下，this 值是 undefined，非严格模式下 this 指向的是全局对象 window；&#x3D;&#x3D;</p>
</li>
<li><p>&#x3D;&#x3D;通过一个<strong>对象来调用其内部的一个方法</strong>，该方法的执行上下文中的 this 指向对象本身&#x3D;&#x3D;</p>
</li>
<li><p>ES6 中的&#x3D;&#x3D;箭头函数并不会创建其自身的执行上下文&#x3D;&#x3D;，所以箭头函数中的 this 取决于它的外部函数</p>
</li>
<li><p>&#x3D;&#x3D;new 关键字构建好了一个新对象，并且构造函数中的 this 其实就是新对象本身&#x3D;&#x3D;</p>
<ul>
<li>当执行 new CreateObj() 的时候，JavaScript 引擎做了如下四件事：<ul>
<li>首先创建了一个空对象 tempObj；</li>
<li>接着调用 CreateObj.call 方法，并将 tempObj 作为 call 方法的参数，这样当 CreateObj 的执行上下文创建时，它的 this 就指向了 tempObj 对象；</li>
<li>然后执行 CreateObj 函数，此时的 CreateObj 函数执行上下文中的 this 指向了 tempObj 对象；</li>
<li>最后返回 tempObj 对象。</li>
</ul>
</li>
</ul>
</li>
<li><p>&#x3D;&#x3D;嵌套函数中的 this 不会继承外层函数的 this 值。&#x3D;&#x3D;</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myObj = &#123; </span><br><span class="line">	name : <span class="string">&quot;闷倒驴&quot;</span>, </span><br><span class="line">	<span class="attr">showThis</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123; </span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>); <span class="comment">// myObj</span></span><br><span class="line">        <span class="keyword">var</span> bar = <span class="keyword">function</span>(<span class="params"></span>)&#123; </span><br><span class="line">        	<span class="variable language_">this</span>.<span class="property">name</span> = <span class="string">&quot;王美丽&quot;</span>; </span><br><span class="line">        	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>) <span class="comment">// window</span></span><br><span class="line">        &#125; </span><br><span class="line">        <span class="title function_">bar</span>(); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">myObj.<span class="title function_">showThis</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(myObj.<span class="property">name</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">window</span>.<span class="property">name</span>);</span><br></pre></td></tr></table></div></figure>

<ul>
<li><p>解决this不继承的方法</p>
<ul>
<li>内部函数使用箭头函数</li>
<li>将在外层函数中创建一个变量，用来存储this，内层函数通过作用域链即可访问</li>
</ul>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myObj = &#123; </span><br><span class="line">	name : <span class="string">&quot;闷倒驴&quot;</span>, </span><br><span class="line">	<span class="attr">showThis</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123; </span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>); <span class="comment">// myObj</span></span><br><span class="line">        <span class="keyword">var</span> <span class="title function_">bar</span> = (<span class="params"></span>)=&gt;&#123; </span><br><span class="line">        	<span class="variable language_">this</span>.<span class="property">name</span> = <span class="string">&quot;王美丽&quot;</span>; </span><br><span class="line">        	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>) <span class="comment">// window</span></span><br><span class="line">        &#125; </span><br><span class="line">        <span class="title function_">bar</span>(); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">myObj.<span class="title function_">showThis</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(myObj.<span class="property">name</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">window</span>.<span class="property">name</span>);</span><br></pre></td></tr></table></div></figure>

<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myObj = &#123; </span><br><span class="line">	name : <span class="string">&quot;闷倒驴&quot;</span>, </span><br><span class="line">	<span class="attr">showThis</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123; </span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>); <span class="comment">// myObj</span></span><br><span class="line">        <span class="keyword">var</span> self = <span class="variable language_">this</span>;</span><br><span class="line">        <span class="keyword">var</span> bar = <span class="keyword">function</span> (<span class="params"></span>)&#123; </span><br><span class="line">        	self.<span class="property">name</span> = <span class="string">&quot;王美丽&quot;</span>; </span><br><span class="line">        	<span class="variable language_">console</span>.<span class="title function_">log</span>(self) <span class="comment">// window</span></span><br><span class="line">        &#125; </span><br><span class="line">        <span class="title function_">bar</span>(); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">myObj.<span class="title function_">showThis</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(myObj.<span class="property">name</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">window</span>.<span class="property">name</span>);</span><br></pre></td></tr></table></div></figure></li>
</ul>
</li>
</ul>

        <h2 id="4-改变this指向的方法"   >
          <a href="#4-改变this指向的方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-改变this指向的方法" class="headerlink" title="4. 改变this指向的方法"></a>4. 改变this指向的方法</h2>
      <p>call、apply、bind</p>

        <h3 id="4-1-call-和-apply-的共同点"   >
          <a href="#4-1-call-和-apply-的共同点" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-1-call-和-apply-的共同点" class="headerlink" title="4.1 call 和 apply 的共同点"></a>4.1 call 和 apply 的共同点</h3>
      <p>都能够<strong>改变函数执行时的上下文</strong>，将一个对象的方法交给另一个对象来执行，并且是立即执行的</p>
<p><strong>调用 call 和 apply 的对象，必须是一个函数 Function</strong></p>

        <h3 id="4-2-call-和-apply-的区别"   >
          <a href="#4-2-call-和-apply-的区别" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-2-call-和-apply-的区别" class="headerlink" title="4.2 call 和 apply 的区别"></a>4.2 call 和 apply 的区别</h3>
      
        <h4 id="call-的写法"   >
          <a href="#call-的写法" class="heading-link"><i class="fas fa-link"></i></a><a href="#call-的写法" class="headerlink" title="call 的写法"></a>call 的写法</h4>
      <p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://blog.csdn.net/qq_35810838/article/details/87824081" >(34条消息) js中call()方法的用法_js call_鹰眼2号的博客-CSDN博客</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>call方法可以用来代替一个对象调用一个方法，call方法可以将一个函数的对象上下文从初始化改为新的对象，也就是括号里面的原本的对象改为call()前面的对象、即用thisobj代替call前面的东西，最终用thisobj这个对象去执行call前面的方法。</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Function</span>.<span class="title function_">call</span>(obj,[param1[,param2[,…[,paramN]]]])</span><br></pre></td></tr></table></div></figure>

<p>需要注意以下几点：</p>
<ul>
<li>调用 call 的对象，<strong>必须是个函数 Function</strong>。</li>
<li>call 的第一个参数，是一个对象。 Function 的调用者，将会指向这个对象。如果不传，则默认为全局对象 window。</li>
<li><strong>第二个参数开始，可以接收任意个参数</strong>。<strong>每个参数会映射到相应位置的 Function 的参数上。</strong>但是如果将所有的参数作为数组传入，它们会作为一个整体映射到 Function 对应的第一个参数上，之后参数都为空。</li>
</ul>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">func</span> (a,b,c) &#123;&#125;</span><br><span class="line"></span><br><span class="line">func.<span class="title function_">call</span>(obj, <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line"><span class="comment">// func 接收到的参数实际上是 1,2,3</span></span><br><span class="line"></span><br><span class="line">func.<span class="title function_">call</span>(obj, [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line"><span class="comment">// func 接收到的参数实际上是 [1,2,3],undefined,undefined</span></span><br></pre></td></tr></table></div></figure>


        <h4 id="apply-的写法"   >
          <a href="#apply-的写法" class="heading-link"><i class="fas fa-link"></i></a><a href="#apply-的写法" class="headerlink" title="apply 的写法"></a>apply 的写法</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Function.apply(obj,[argArray])</span><br></pre></td></tr></table></div></figure>

<p>需要注意的是：</p>
<ul>
<li>它的调用者<strong>必须是函数 Function</strong>，并且只接收两个参数，第一个参数的规则与 call 一致。</li>
<li><strong>第二个参数，必须是数组或者类数组</strong>，它们会被转换成类数组，传入 Function 中，并且会被映射到 Function 对应的参数上。这也是 call 和 apply 之间，很重要的一个区别。</li>
</ul>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">func.apply(obj, [1,2,3])</span><br><span class="line">// func 接收到的参数实际上是 1,2,3</span><br><span class="line"></span><br><span class="line">func.apply(obj, &#123;</span><br><span class="line">    0: 1,</span><br><span class="line">    1: 2,</span><br><span class="line">    2: 3,</span><br><span class="line">    length: 3</span><br><span class="line">&#125;)</span><br><span class="line">// func 接收到的参数实际上是 1,2,3</span><br></pre></td></tr></table></div></figure>


        <h3 id="4-3-call-和-apply-的用途"   >
          <a href="#4-3-call-和-apply-的用途" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-3-call-和-apply-的用途" class="headerlink" title="4.3 call 和 apply 的用途"></a>4.3 call 和 apply 的用途</h3>
      <p>下面会分别列举 call 和 apply 的一些使用场景。声明：例子中没有哪个场景是必须用 call 或者必须用 apply 的，只是个人习惯这么用而已。</p>

        <h4 id="call-的使用场景"   >
          <a href="#call-的使用场景" class="heading-link"><i class="fas fa-link"></i></a><a href="#call-的使用场景" class="headerlink" title="call 的使用场景"></a>call 的使用场景</h4>
      <p><strong>1、对象的继承</strong>。如下面这个例子：</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">superClass</span> () &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">a</span> = <span class="number">1</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">print</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">a</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">subClass</span> () &#123;</span><br><span class="line">    superClass.<span class="title function_">call</span>(<span class="variable language_">this</span>);  <span class="comment">// 执行superClass，并将superClass方法中的this指向subClass</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">print</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">subClass</span>();</span><br><span class="line"><span class="comment">// 1</span></span><br></pre></td></tr></table></div></figure>

<p>subClass 通过 call 方法，继承了 superClass 的 print 方法和 a 变量。此外，subClass 还可以扩展自己的其他方法。</p>
<p><strong>2、借用方法</strong>。还记得刚才的类数组么？如果它想使用 Array 原型链上的方法，可以这样：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">let domNodes = Array.prototype.slice.call(document.getElementsByTagName(&quot;*&quot;));</span><br></pre></td></tr></table></div></figure>

<p>这样，domNodes 就可以应用 Array 下的所有方法了。</p>
<p>原理：执行数组的slice方法,把this指向伪数组</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// slice2()</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">slice2</span> = <span class="keyword">function</span> (<span class="params">start, end</span>) &#123;</span><br><span class="line">  start = start || <span class="number">0</span></span><br><span class="line">  end = start || <span class="variable language_">this</span>.<span class="property">length</span></span><br><span class="line">  <span class="keyword">const</span> arr = []</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = start; i &lt; end; i++) &#123;</span><br><span class="line">    arr.<span class="title function_">push</span>(<span class="variable language_">this</span>[i])</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h4 id="apply-的一些妙用"   >
          <a href="#apply-的一些妙用" class="heading-link"><i class="fas fa-link"></i></a><a href="#apply-的一些妙用" class="headerlink" title="apply 的一些妙用"></a>apply 的一些妙用</h4>
      <p><strong>1、Math.max</strong>。用它来获取数组中最大的一项。</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">let max = Math.max.apply(null, array);</span><br></pre></td></tr></table></div></figure>

<p>同理，要获取数组中最小的一项，可以这样：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">let min = Math.min.apply(null, array);</span><br></pre></td></tr></table></div></figure>

<p><strong>2、实现两个数组合并</strong>。在 ES6 的扩展运算符出现之前，我们可以用 Array.prototype.push来实现。</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">let arr1 = [1, 2, 3];</span><br><span class="line">let arr2 = [4, 5, 6];</span><br><span class="line"></span><br><span class="line">Array.prototype.push.apply(arr1, arr2);</span><br><span class="line">console.log(arr1); // [1, 2, 3, 4, 5, 6]</span><br></pre></td></tr></table></div></figure>


        <h3 id="4-4-bind"   >
          <a href="#4-4-bind" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-4-bind" class="headerlink" title="4.4 bind"></a>4.4 bind</h3>
      
        <h4 id="bind-的使用"   >
          <a href="#bind-的使用" class="heading-link"><i class="fas fa-link"></i></a><a href="#bind-的使用" class="headerlink" title="bind 的使用"></a>bind 的使用</h4>
      <p>在 MDN 上的解释是：bind() 方法创建一个新的函数，在调用时设置 this 关键字为提供的值。并在调用新函数时，将给定参数列表作为原函数的参数序列的前若干项。</p>
<p>它的语法如下：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Function.bind(thisArg[, arg1[, arg2[, ...]]])</span><br></pre></td></tr></table></div></figure>

<p>bind 方法 与 apply 和 call 比较类似，也能改变函数体内的 this 指向。</p>
<p>不同的是，<strong>bind 方法的返回值是函数，并且需要稍后调用，才会执行</strong>。而 apply 和 call 则是立即调用。</p>
<p>来看下面这个例子：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function add (c) &#123;</span><br><span class="line">    return this.a + this.b + c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var obj = &#123;a:1,b:2&#125;</span><br><span class="line"></span><br><span class="line">add.bind(obj, 5); // 这时，并不会返回 8</span><br><span class="line">add.bind(sub, 5)(); // 调用后，返回 8</span><br></pre></td></tr></table></div></figure>

<p>如果 bind 的第一个参数是 null 或者 undefined，this 就指向全局对象 window。</p>
<p>在vue或者react框架中，使用bind将定义的方法中的this指向当前类</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2023/03/24/03_js%E6%89%A7%E8%A1%8C%E6%9C%BA%E5%88%B6/03_%E4%BD%9C%E7%94%A8%E5%9F%9F_%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%93%BE%E5%92%8C%E9%97%AD%E5%8C%85/%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%93%BE%E5%92%8C%E9%97%AD%E5%8C%85/">[ Sin título ]</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Creado</span><span class="post-meta-item__value">2023-03-24</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Actualizado</span><span class="post-meta-item__value">2023-02-23</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="作用域链和闭包"   >
          <a href="#作用域链和闭包" class="heading-link"><i class="fas fa-link"></i></a><a href="#作用域链和闭包" class="headerlink" title="作用域链和闭包"></a>作用域链和闭包</h1>
      
        <h2 id="1-作用域"   >
          <a href="#1-作用域" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-作用域" class="headerlink" title="1. *作用域"></a>1. *作用域</h2>
      <p><strong>作用域</strong>是指在程序中定义变量的区域，该位置决定了变量的生命周期。通俗地理解，作用域就是变量与函数的可访问范围，即作用域控制着变量和函数的可见性和生命周期。</p>
<p><strong>在 ES6 之前，ES 的作用域只有两种：全局作用域和函数作用域。</strong></p>
<ul>
<li><p><strong>全局作用域</strong>中的对象在代码中的任何地方都能访问，其生命周期伴随着页面的生命周期。</p>
</li>
<li><p><strong>函数作用域</strong>就是在函数内部定义的变量或者函数，并且定义的变量或者函数只能在函数内部被访问。函数执行结束之后，函数内部定义的变量会被销毁。</p>
</li>
</ul>
<p><strong>ES6支持块级作用域</strong></p>
<ul>
<li><p><strong>块级作用域特点</strong>：在代码块内部定义的变量在代码块外部是访问不到的，并且等该代码块中的代码执行完成之后，代码块中定义的变量会被销毁。</p>
</li>
<li><p><strong>块级作用域形式：</strong>就是使用一对大括号包裹的一段代码，比如函数、判断语句、循环语句，甚至单独的一个{}都可以被看作是一个块级作用域。</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//if块</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">1</span>)&#123;&#125;</span><br><span class="line"><span class="comment">//while块</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)&#123;&#125;</span><br><span class="line"><span class="comment">//函数块</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>)&#123;&#125; </span><br><span class="line"><span class="comment">//for循环块</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i&lt;<span class="number">100</span>; i++)&#123;&#125;</span><br><span class="line"><span class="comment">//单独一个块</span></span><br><span class="line">&#123;&#125;</span><br></pre></td></tr></table></div></figure>
</li>
<li><p><strong>ES6中如何使块级作用域生效</strong>：使用let和const关键字</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i&lt;<span class="number">100</span>; i++)&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(i)</span><br></pre></td></tr></table></div></figure>

<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i&lt;<span class="number">100</span>; i++)&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(i)</span><br></pre></td></tr></table></div></figure>

<p>引申考题：隔一秒钟打印出来一个自然数，自然数递增</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i&lt;<span class="number">10</span>; i++)&#123;</span><br><span class="line">	<span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(i)</span><br><span class="line">	&#125;,<span class="number">1000</span>*i)	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i&lt;<span class="number">10</span>; i++)&#123;</span><br><span class="line">	<span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(i)</span><br><span class="line">	&#125;,<span class="number">1000</span>*i)	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li>
</ul>
<p>&#x3D;&#x3D;<strong>let、const关键字解决var关键字变量提升的问题</strong>&#x3D;&#x3D;</p>
<ul>
<li><p>&#x3D;&#x3D;  &#x3D;&#x3D;</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myname = <span class="string">&quot;王美丽&quot;</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showName</span>(<span class="params"></span>)&#123; </span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(myname); </span><br><span class="line">	<span class="keyword">if</span>(<span class="number">0</span>)&#123; </span><br><span class="line">		<span class="keyword">var</span> myname = <span class="string">&quot;闷倒驴&quot;</span> &#125;</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(myname);</span><br><span class="line">	&#125;</span><br><span class="line"><span class="title function_">showName</span>()</span><br><span class="line"><span class="comment">//console.log(myname);</span></span><br></pre></td></tr></table></div></figure>
</li>
<li><p>本该销毁的变量销毁不掉</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i&lt;<span class="number">100</span>; i++)&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(i)</span><br></pre></td></tr></table></div></figure></li>
</ul>
<p>&#x3D;&#x3D;<strong>let、const关键字解决问题的原理</strong>&#x3D;&#x3D;</p>
<ul>
<li><p>let和const关键字创建的变量存储在词法环境中，var关键字创建的变量存储在变量环境中</p>
</li>
<li><p>块级内部代码执行结束，立马销毁内部let、const创建的变量</p>
</li>
<li><p>let和const创建的变量，初始化不提升，创建提升，所以造成暂时性死区</p>
</li>
<li><p>访问变量先在当前执行上下文的词法环境中查找，再到变量环境中查找</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fun</span>(<span class="params"></span>)&#123; </span><br><span class="line">	<span class="keyword">var</span> a = <span class="number">11</span>;</span><br><span class="line">	<span class="keyword">let</span> b = <span class="number">22</span>;</span><br><span class="line">	&#123; 	</span><br><span class="line">		<span class="keyword">let</span> b = <span class="number">33</span>;</span><br><span class="line">		<span class="keyword">var</span> c = <span class="number">44</span>;</span><br><span class="line">        <span class="keyword">let</span> d = <span class="number">55</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(b);</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(b);</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(c);</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(d);</span><br><span class="line">&#125; </span><br><span class="line"><span class="title function_">fun</span>()</span><br></pre></td></tr></table></div></figure>

<p>第一步：刚开始执行fun函数</p>
<img src="04.png" alt="image-20210602140620246" style="zoom: 50%;" />

<p>第二步：执行内部代码块</p>
<img src="05.png" alt="image-20210602140943645" style="zoom:50%;" />

<img src="06.png" alt="image-20210602141201983" style="zoom:50%;" />

<p>第三步：执行代码块中console.log(a) console.log(b) </p>
<img src="D:\秋招集训营\03_js执行机制\03_作用域_作用域链和闭包\07.png" alt="image-20210602141415364" style="zoom:50%;" />

<img src="08.png" alt="image-20210602141545515" style="zoom:50%;" /></li>
</ul>
<p>第四步：代码块执行结束，相应词法环境中的变量弹出</p>
<p>​	<img src="09.png" alt="image-20210602141759328" style="zoom:50%;" /></p>
<p>第五步：执行console.log(b);console.log(c);</p>
<img src="10.png" alt="image-20210602142018073" style="zoom:50%;" />

<img src="D:\秋招集训营\03_js执行机制\03_作用域_作用域链和闭包\11.png" alt="image-20210602142149978" style="zoom:50%;" />

<p>第六步：执行console.log(d),找不到报错</p>
<img src="12.png" alt="image-20210602142233238" style="zoom:50%;" />

<p><strong>关于变量提升问题</strong></p>
<ul>
<li>var的创建和初始化被提升，赋值不会被提升。</li>
<li>let的创建被提升，初始化和赋值不会被提升，所以会造成暂时性死区（就是访问不到）。</li>
<li>function的创建、初始化和赋值均会被提升。</li>
</ul>
<p>&#x3D;&#x3D;<strong>作用域的特点：是代码编译阶段就决定好的，和函数是怎么调用的没有关系。</strong>&#x3D;&#x3D; </p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">bar</span>(<span class="params"></span>) &#123; </span><br><span class="line">	<span class="keyword">var</span> myName = <span class="string">&quot;王美丽&quot;</span>;</span><br><span class="line">    <span class="keyword">let</span> test1 = <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">1</span>) &#123; </span><br><span class="line">    	<span class="keyword">let</span> myName = <span class="string">&quot;丑八怪&quot;</span>; </span><br><span class="line">    	<span class="variable language_">console</span>.<span class="title function_">log</span>(test);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123; </span><br><span class="line">	<span class="keyword">var</span> myName = <span class="string">&quot;闷倒驴&quot;</span>;</span><br><span class="line">    <span class="keyword">let</span> test = <span class="number">2</span>;</span><br><span class="line">    &#123; </span><br><span class="line">    	<span class="keyword">let</span> test = <span class="number">3</span>;</span><br><span class="line">        <span class="title function_">bar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> myName = <span class="string">&quot;大喇叭&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> myAge = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">let</span> test =<span class="number">1</span>;</span><br><span class="line"><span class="title function_">foo</span>();</span><br></pre></td></tr></table></div></figure>

<p><img src="/01.png" alt="image-20210416170654126"></p>

        <h2 id="2-作用域链"   >
          <a href="#2-作用域链" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-作用域链" class="headerlink" title="2. 作用域链"></a>2. 作用域链</h2>
      <p><strong>作用域链</strong>：当一个函数中使用了某个变量，首先会在自己内部作用域查找，然后再向外部一层一层查找，直到全局作用域，这个链式查找就是作用域链</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> num = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">fun1</span> ()&#123;</span><br><span class="line">            <span class="keyword">function</span> <span class="title function_">fun2</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="keyword">function</span> <span class="title function_">fun3</span>(<span class="params"></span>)&#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(num);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="title function_">fun3</span>()</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="title function_">fun2</span>()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">fun1</span>();</span><br></pre></td></tr></table></div></figure>

<img src="02.png" alt="image-20210602152930660" style="zoom:50%;" />


        <h2 id="3-闭包"   >
          <a href="#3-闭包" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-闭包" class="headerlink" title="3.闭包"></a>3.闭包</h2>
      
        <h3 id="3-1-什么是闭包"   >
          <a href="#3-1-什么是闭包" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-1-什么是闭包" class="headerlink" title="3.1 什么是闭包"></a>3.1 什么是闭包</h3>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123; </span><br><span class="line">	<span class="keyword">var</span> myName = <span class="string">&quot;王美丽&quot;</span>;</span><br><span class="line">	<span class="keyword">let</span> test1 = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">const</span> test2 = <span class="number">2</span>; </span><br><span class="line">	<span class="keyword">var</span> innerBar = &#123; </span><br><span class="line">		<span class="attr">getName</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(test1) <span class="keyword">return</span> myName &#125;, </span><br><span class="line">		<span class="attr">setName</span>:<span class="keyword">function</span>(<span class="params">newName</span>)&#123; myName = newName &#125; </span><br><span class="line">	&#125; </span><br><span class="line">	<span class="keyword">return</span> innerBar</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> bar = <span class="title function_">foo</span>();</span><br><span class="line">bar.<span class="title function_">setName</span>(<span class="string">&quot;闷倒驴&quot;</span>);</span><br><span class="line">bar.<span class="title function_">getName</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(bar.<span class="title function_">getName</span>())</span><br></pre></td></tr></table></div></figure>

<p><img src="/03.png" alt="image-20210419111708313"></p>

        <h3 id="3-2-闭包形成的原理"   >
          <a href="#3-2-闭包形成的原理" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-2-闭包形成的原理" class="headerlink" title="3.2 闭包形成的原理"></a>3.2 闭包形成的原理</h3>
      <ul>
<li>作用域链，当前作用域可以访问上级作用域中的变量</li>
<li>全局变量只用页面关闭才会销毁</li>
</ul>

        <h3 id="3-3-闭包解决的问题"   >
          <a href="#3-3-闭包解决的问题" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-3-闭包解决的问题" class="headerlink" title="3.3 闭包解决的问题"></a>3.3 闭包解决的问题</h3>
      <ul>
<li>函数作用域中的变量在函数执行结束就会销毁，但是有时候我们并不希望变量销毁</li>
<li>在函数外部可以访问函数内部的变量</li>
</ul>

        <h3 id="3-4-闭包带来的问题"   >
          <a href="#3-4-闭包带来的问题" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-4-闭包带来的问题" class="headerlink" title="3.4 闭包带来的问题"></a>3.4 闭包带来的问题</h3>
      <ul>
<li><p>容易造成内存泄露</p>
<ul>
<li><p>内存泄漏：占用的内存没有及时释放，内存泄露积累多了就容易导致内存溢出</p>
<ul>
<li><p>闭包</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fn1</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">4</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">fn2</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(++a)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> fn2</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> f = <span class="title function_">fn1</span>()</span><br><span class="line">  <span class="title function_">f</span>()</span><br></pre></td></tr></table></div></figure></li>
</ul>
</li>
</ul>
</li>
</ul>

        <h3 id="3-5-闭包的应用"   >
          <a href="#3-5-闭包的应用" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-5-闭包的应用" class="headerlink" title="3.5 闭包的应用"></a>3.5 闭包的应用</h3>
      <ul>
<li><p>模仿块级作用域</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">    (<span class="keyword">function</span>(<span class="params">j</span>)&#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(j);</span><br><span class="line">        &#125;, j * <span class="number">1000</span>);</span><br><span class="line">    &#125;)(i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; lis.<span class="property">length</span>; i++) &#123;</span><br><span class="line">          (<span class="keyword">function</span> (<span class="params">j</span>) &#123;</span><br><span class="line">              lis[j].<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                  <span class="title function_">alert</span>(j)</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;)(i)</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>*埋点计数器</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">count</span> () &#123;</span><br><span class="line">	<span class="keyword">var</span> num = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">	 num++;</span><br><span class="line">	 <span class="keyword">return</span> num;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> num = <span class="title function_">count</span>();</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>？柯里化</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">curryingCheck</span>(<span class="params">reg</span>) &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">txt</span>) &#123;</span><br><span class="line">               <span class="keyword">return</span> reg.<span class="title function_">test</span>(txt)</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">  </span><br><span class="line">       <span class="keyword">var</span> isPhone = <span class="title function_">curryingCheck</span>(<span class="regexp">/^(13[0-9]|14[5|7]|15[0|1|2|3|4|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d&#123;8&#125;$/</span>)</span><br><span class="line">       <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">isPhone</span>(<span class="string">&#x27;15810606459&#x27;</span>))    <span class="comment">// true</span></span><br><span class="line">  </span><br><span class="line">       <span class="keyword">var</span> isEmail = <span class="title function_">curryingCheck</span>(<span class="regexp">/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/</span>)</span><br><span class="line">       <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">isEmail</span>(<span class="string">&#x27;wyn@nowcoder.com&#x27;</span>))      <span class="comment">// false</span></span><br></pre></td></tr></table></div></figure></li>
</ul>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2023/03/24/03_js%E6%89%A7%E8%A1%8C%E6%9C%BA%E5%88%B6/02_%E8%B0%83%E7%94%A8%E6%A0%88/%E8%B0%83%E7%94%A8%E6%A0%88/">[ Sin título ]</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Creado</span><span class="post-meta-item__value">2023-03-24</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Actualizado</span><span class="post-meta-item__value">2023-02-21</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="调用栈"   >
          <a href="#调用栈" class="heading-link"><i class="fas fa-link"></i></a><a href="#调用栈" class="headerlink" title="调用栈"></a>调用栈</h1>
      
        <h2 id="1-在执行之前就进行编译并创建执行上下文"   >
          <a href="#1-在执行之前就进行编译并创建执行上下文" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-在执行之前就进行编译并创建执行上下文" class="headerlink" title="1. 在执行之前就进行编译并创建执行上下文"></a>1. 在执行之前就进行编译并创建执行上下文</h2>
      <ol>
<li>当 JavaScript 执行全局代码的时候，会编译全局代码并创建<strong>全局执行上下文</strong>，而且在整个页面的生存周期内，全局执行上下文只有一份。</li>
<li>当调用一个函数的时候，函数体内的代码会被编译，并创建<strong>函数执行上下文</strong>，一般情况下，函数执行结束之后，创建的函数执行上下文会被销毁。</li>
<li><blockquote>
<p>当使用 eval 函数的时候，eval 的代码也会被编译，并创建执行上下文。</p>
</blockquote>
</li>
</ol>

        <h2 id="2-调用栈"   >
          <a href="#2-调用栈" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-调用栈" class="headerlink" title="2. 调用栈"></a>2. 调用栈</h2>
      <p>JavaScript 中有很多函数，经常会出现在一个函数中调用另外一个函数的情况，<strong>调用栈就是用来管理函数调用关系的一种数据结构</strong>。</p>
<p>调用栈特点：<strong>后进先出</strong></p>
<img src="08.png" alt="image-20210531173341976" style="zoom:50%;" />

<p>JavaScript 引擎会将执行上下文压入栈中，通常把这种用来管理执行上下文的栈称为执行上下文栈，又称<strong>调用栈</strong></p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sum</span>(<span class="params">b,c</span>)&#123; </span><br><span class="line">	<span class="keyword">return</span> b+c</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">addSum</span>(<span class="params">d,e</span>)&#123;</span><br><span class="line">	<span class="keyword">var</span> f = <span class="number">10</span>;</span><br><span class="line">	result = <span class="title function_">sum</span>(d,e);</span><br><span class="line">	<span class="keyword">return</span> a+result+f</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title function_">addSum</span>(<span class="number">3</span>,<span class="number">6</span>)</span><br></pre></td></tr></table></div></figure>

<p>第一步：创建全局上下文，并将其压入栈底，a 进行变量提升，然后a&#x3D; 1;</p>
<img src="01.png" alt="image-20210531170200972" style="zoom: 33%;" />

<img src="02.png" alt="image-20210531170428802" style="zoom:33%;" />

<p>第二步：<strong>调用addSum函数</strong>，JavaScript 引擎会编译该函数，并为其创建一个执行上下文，最后还将<strong>该函数的执行上下文压入栈中</strong></p>
<img src="03.png" alt="image-20210531171407495" style="zoom:33%;" />

<img src="04.png" alt="image-20210531171554702" style="zoom:33%;" />

<p>第三步：当执行到 add 函数调用语句时，同样会为其创建执行上下文，并将其压入调用栈</p>
<img src="05.png" alt="image-20210531172320416" style="zoom: 50%;" />

<p>第四步：当 add 函数返回时，该函数的执行上下文就会从栈顶弹出，并将 result 的值设置为 add 函数的返回值，也就是 9</p>
<img src="06.png" alt="image-20210531172618329" style="zoom:50%;" />

<p>第五步：addSum 执行最后一个相加操作后并返回，addSum 的执行上下文也会从栈顶部弹出，此时调用栈中就只<strong>剩下全局上下文</strong>了</p>
<img src="07.png" alt="image-20210531172857465" style="zoom: 50%;" /></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2023/03/24/03_js%E6%89%A7%E8%A1%8C%E6%9C%BA%E5%88%B6/01_%E5%8F%98%E9%87%8F%E6%8F%90%E5%8D%87/%E6%96%B0%E5%BB%BA%20Typora/">[ Sin título ]</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Creado</span><span class="post-meta-item__value">2023-03-24</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Actualizado</span><span class="post-meta-item__value">2023-02-23</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h2 id="题3："   >
          <a href="#题3：" class="heading-link"><i class="fas fa-link"></i></a><a href="#题3：" class="headerlink" title="题3："></a>题3：</h2>
      <figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">showName</span>() <span class="comment">//1 声明被提前</span></span><br><span class="line"><span class="keyword">var</span> showName = <span class="keyword">function</span>(<span class="params"></span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>)&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showName</span>(<span class="params"></span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>)&#125;</span><br><span class="line"><span class="title function_">showName</span>()  <span class="comment">//2 赋值不可以被提前</span></span><br></pre></td></tr></table></div></figure>


        <h2 id="题4：-x2F-x2F-遇到-var-和-function-都会提前"   >
          <a href="#题4：-x2F-x2F-遇到-var-和-function-都会提前" class="heading-link"><i class="fas fa-link"></i></a><a href="#题4：-x2F-x2F-遇到-var-和-function-都会提前" class="headerlink" title="题4：  &#x2F;&#x2F;遇到 var 和 function 都会提前"></a>题4：  &#x2F;&#x2F;遇到 var 和 function 都会提前</h2>
      <figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> showName = <span class="number">1</span>;</span><br><span class="line"><span class="title function_">showName</span>()</span><br><span class="line"><span class="keyword">var</span> showName = <span class="keyword">function</span>(<span class="params"></span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>)&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showName</span>(<span class="params"></span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>)&#125;</span><br></pre></td></tr></table></div></figure>

<p>相当于：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var showName = undefined;</span><br><span class="line">var showName = undefined;</span><br><span class="line">function showName() &#123; console.log(1)&#125;  //提前！！</span><br><span class="line">showName = 1;  //</span><br><span class="line">showName()   //报错</span><br><span class="line">showName = function() &#123; console.log(2)&#125;</span><br></pre></td></tr></table></div></figure>

<p>所以会报错</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2023/03/24/02_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E4%B8%8E%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/02_%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/">[ Sin título ]</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Creado</span><span class="post-meta-item__value">2023-03-24</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Actualizado</span><span class="post-meta-item__value">2023-02-20</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="垃圾回收机制"   >
          <a href="#垃圾回收机制" class="heading-link"><i class="fas fa-link"></i></a><a href="#垃圾回收机制" class="headerlink" title="垃圾回收机制"></a>垃圾回收机制</h1>
      
        <h2 id="1-垃圾回收的方式"   >
          <a href="#1-垃圾回收的方式" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-垃圾回收的方式" class="headerlink" title="1. 垃圾回收的方式"></a>1. 垃圾回收的方式</h2>
      <p><strong>手动垃圾回收</strong>和<strong>自动垃圾回收</strong></p>
<p>c语言是手动垃圾回收</p>
<p>javaScript是自动垃圾回收</p>

        <h2 id="2-javaScript垃圾回收的方式"   >
          <a href="#2-javaScript垃圾回收的方式" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-javaScript垃圾回收的方式" class="headerlink" title="2. javaScript垃圾回收的方式"></a>2. javaScript垃圾回收的方式</h2>
      <ul>
<li><strong>调用栈</strong>中的垃圾数据回收方式</li>
<li><strong>堆</strong>中垃圾数据的回收方式</li>
</ul>

        <h2 id="3-调用栈中的垃圾数据回收方式"   >
          <a href="#3-调用栈中的垃圾数据回收方式" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-调用栈中的垃圾数据回收方式" class="headerlink" title="3. 调用栈中的垃圾数据回收方式"></a>3. 调用栈中的垃圾数据回收方式</h2>
      <p><strong>当一个函数执行结束之后，JavaScript 引擎会通过向下移动 ESP 来销毁该函数保存在栈中的执行上下文</strong></p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>)&#123; </span><br><span class="line">	<span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">var</span> b = &#123;<span class="attr">name</span>:<span class="string">&quot;王美丽&quot;</span>&#125;;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">showName</span>(<span class="params"></span>)&#123; </span><br><span class="line">    	<span class="keyword">var</span> c = <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">var</span> d = &#123;<span class="attr">name</span>:<span class="string">&quot;闷倒驴&quot;</span>&#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="title function_">showName</span>()</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title function_">foo</span>()</span><br></pre></td></tr></table></div></figure>

<p><img src="/01.png" alt="image-20210421142612861"></p>
<p><img src="/02.png" alt="image-20210421143318174"></p>

        <h2 id="4-堆中的垃圾回收方式"   >
          <a href="#4-堆中的垃圾回收方式" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-堆中的垃圾回收方式" class="headerlink" title="4. 堆中的垃圾回收方式"></a>4. 堆中的垃圾回收方式</h2>
      <p><img src="/03.png" alt="image-20210421143629274"></p>
<p>当函数直接结束，栈空间处理完成了，但是堆空间的数据虽然没有被引用，但是还是存储在堆空间中，需要垃圾回收器将堆空间中的垃圾数据回收</p>

        <h3 id="4-1-代际假说"   >
          <a href="#4-1-代际假说" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-1-代际假说" class="headerlink" title="4.1 代际假说"></a>4.1 代际假说</h3>
      <p>代际假说有以下两个特点：</p>
<ul>
<li><p>第一个是大部分对象在内存中存在的时间很短，简单来说，就是很多对象一经分配内存，很快就变得不可访问；</p>
</li>
<li><p>第二个是不死的对象，会活得更久。</p>
</li>
</ul>

        <h3 id="4-2-分代收集"   >
          <a href="#4-2-分代收集" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-2-分代收集" class="headerlink" title="4.2 分代收集"></a>4.2 分代收集</h3>
      <p><img src="/04.png" alt="image-20210531121232271"></p>
<p>为了使垃圾回收达到更好的效果，根据对象的生命周期不一样，使用不同的垃圾回收的算法</p>
<p><strong>在 V8 中会把堆分为新生代和老生代两个区域，新生代中存放的是生存时间短的对象，老生代中存放的生存时间久的对象</strong></p>
<p>新生区通常只支持 1～8M 的容量，而老生区支持的容量就大很多了。对于这两块区域，V8 分别使用两个不同的垃圾回收器，以便更高效地实施垃圾回收。</p>
<p>副垃圾回收器，主要负责新生代的垃圾回收。</p>
<p>主垃圾回收器，主要负责老生代的垃圾回收。</p>

        <h3 id="4-3-垃圾回收器的工作流程"   >
          <a href="#4-3-垃圾回收器的工作流程" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-3-垃圾回收器的工作流程" class="headerlink" title="4.3 垃圾回收器的工作流程"></a>4.3 垃圾回收器的工作流程</h3>
      <p><strong>第一步是标记</strong>空间中活动对象和非活动对象。所谓活动对象就是还在使用的对象，非活动对象就是可以进行垃圾回收的对象。</p>
<p><strong>第二步是回收</strong>非活动对象所占据的内存。其实就是在所有的标记完成之后，统一清理内存中所有被标记为可回收的对象。</p>
<p><strong>第三步是做内存整理</strong>。一般来说，频繁回收对象后，内存中就会存在大量不连续空间，我们把这些不连续的内存空间称为内存碎片。当内存中出现了大量的内存碎片之后，如果需要分配较大连续内存的时候，就有可能出现内存不足的情况。所以最后一步需要整理这些内存碎片，但这步其实是可选的，因为有的垃圾回收器不会产生内存碎片，比如接下来我们要介绍的副垃圾回收器。</p>

        <h3 id="4-4-新生区垃圾回收（副垃圾回收器）"   >
          <a href="#4-4-新生区垃圾回收（副垃圾回收器）" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-4-新生区垃圾回收（副垃圾回收器）" class="headerlink" title="4.4 新生区垃圾回收（副垃圾回收器）"></a>4.4 新生区垃圾回收（副垃圾回收器）</h3>
      <p><strong>新生区特点：</strong></p>
<ul>
<li><p>通常把小的对象分配到新生区</p>
</li>
<li><p>新生区的垃圾回收比较频繁</p>
</li>
<li><p>通常存储容量在1-8M</p>
<ul>
<li><p><strong>Scavenge算法</strong>采用复制机制，如果存储容量过大，会导致每次清理的时间过长，效率低</p>
</li>
<li><p>同时因为存储容量小，很容易就写满，所以经过两次垃圾回收依然还存活的对象，会被移动到老生区中</p>
<p>这个策略称为<strong>对象晋升策略</strong></p>
</li>
</ul>
</li>
<li><p>新生代中用 Scavenge 算法来处理垃圾回收</p>
</li>
</ul>
<p><strong>Scavenge算法</strong>：将新生区分成两部分，一部分叫对象区域，一部分叫空闲区域，新加入的对象先存放在对象区域，当对象区域写满，进行垃圾回收，具体回收步骤</p>
<ol>
<li><p>标记：对对象区域中的垃圾进行标记</p>
</li>
<li><p>清除垃圾数据和整理碎片化内存：副垃圾回收器会把这些存活的对象复制到空闲区域中，并且有序的排列起来，复制后空闲区域就没有内存碎片了</p>
</li>
<li><p>角色翻转：完成复制后，对象区域与空闲区域进行角色翻转，也就是原来的对象区域变成空闲区域，原来的空闲区域变成了对象区域，这样就完成了垃圾对象的回收操作，同时这种角色翻转的操作还能让新生代中的这两块区域无限重复使用下去</p>
<p><img src="/11.png" alt="image-20210531143456876"></p>
<p><img src="/10.png" alt="image-20210531143416592"></p>
</li>
</ol>
<p><img src="/09.png" alt="image-20210531142939452"></p>
<p><img src="/12.png" alt="image-20210531143704068"></p>
<p><img src="/13.png" alt="image-20210531143812589"></p>
<img src="14.png" alt="image-20210531143851817" style="zoom:67%;" />

<p><img src="/15.png" alt="image-20210531143931770"></p>

        <h3 id="4-5-老生区垃圾回收（主垃圾回收器）"   >
          <a href="#4-5-老生区垃圾回收（主垃圾回收器）" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-5-老生区垃圾回收（主垃圾回收器）" class="headerlink" title="4.5 老生区垃圾回收（主垃圾回收器）"></a>4.5 老生区垃圾回收（主垃圾回收器）</h3>
      <p><strong>老生区的特点：</strong></p>
<ul>
<li>对象占用空间大</li>
<li>对象存活时间长</li>
</ul>
<p><strong>垃圾回收的过程：</strong> 之前使用标记-清除算法，由于会产生碎片化空间，于是又添加<strong>标记-整理算法</strong></p>
<ul>
<li><p><strong>标记-清除算法</strong></p>
<ul>
<li>标记：标记阶段就是从一组根元素开始，递归遍历这组根元素，在这个遍历过程中，能到达的元素称为活动对象，没有到达的元素就可以判断为垃圾数据。</li>
<li>清除：将垃圾数据进行清除。</li>
<li>碎片：<br>对一块内存多次执行标记 - 清除算法后，会产生大量不连续的内存碎片。而碎片过多会导致大对象无法分配到足够的连续内存。</li>
</ul>
<p><img src="/05.png" alt="image-20210531122253648"></p>
</li>
<li><p><strong>标记-整理算法</strong>（如图会产生大量的碎片化空间，没有连续的大存储空间，如果此时要存入一个大对象，就存储不了）</p>
<ul>
<li>标记：和标记 - 清除的标记过程一样，从一组根元素开始，递归遍历这组根元素，在这个遍历过程中，能到达的元素标记为活动对象。</li>
<li>整理：让所有存活的对象都向内存的一端移动</li>
<li>清除：清理掉端边界以外的内存</li>
</ul>
<p><img src="/06.png" alt="image-20210531122656176"></p>
</li>
</ul>

        <h3 id="4-6-全停顿"   >
          <a href="#4-6-全停顿" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-6-全停顿" class="headerlink" title="4.6 全停顿"></a>4.6 全停顿</h3>
      <p>V8 是使用副垃圾回收器和主垃圾回收器处理垃圾回收的，不过由于 JavaScript 是运行在主线程之上的，&#x3D;&#x3D;一旦执行垃圾回收算法&#x3D;&#x3D;，都需要将&#x3D;&#x3D;正在执行的 JavaScript 脚本暂停下来&#x3D;&#x3D;，待垃圾回收完毕后再恢复脚本执行。我们把这种行为叫做<strong>全停顿（Stop-The-World）</strong>。</p>
<p><img src="/16.png" alt="image-20210531144954748"></p>
<p>为了降低老生代的垃圾回收而造成的卡顿，V8 将标记过程分为一个个的子标记过程，同时让垃圾回收标记和 JavaScript 应用逻辑交替进行，直到标记阶段完成，我们把这个算法称为<strong>增量标记（Incremental Marking）算法</strong></p>
<p><img src="/17.png" alt="image-20210531145546643"></p>

        <h2 id="5-避免内存泄漏的方式"   >
          <a href="#5-避免内存泄漏的方式" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-避免内存泄漏的方式" class="headerlink" title="5. 避免内存泄漏的方式"></a>5. 避免内存泄漏的方式</h2>
      <ul>
<li>内存溢出：就是你要求分配的内存超出了系统能给你的，系统不能满足需求，于是产生溢出。 </li>
<li>内存泄漏：是指你向系统申请分配内存进行使用(new)，可是使用完了以后却不归还(delete)，结果你申请到的那块内存你自己也不能再访问，而系统也不能再次将它分配给需要的程序。就是产生了不可回收的垃圾数据</li>
</ul>

        <h3 id="5-1-尽可能少地创建全局变量"   >
          <a href="#5-1-尽可能少地创建全局变量" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-1-尽可能少地创建全局变量" class="headerlink" title="5.1 尽可能少地创建全局变量"></a>5.1 尽可能少地创建全局变量</h3>
      <p>在ES5中以<code>var</code>声明的方式在全局作用域中创建一个变量时，或者在函数作用域中不以任何声明的方式创建一个变量时，都会无形地挂载到<code>window</code>全局对象上，如下所示：</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> num = <span class="number">1</span>; <span class="comment">// 等价于 window.num = 1;</span></span><br></pre></td></tr></table></div></figure>

<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fun</span>(<span class="params"></span>) &#123;</span><br><span class="line">    num = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>等价于</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fun</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">num</span> = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>我们在<code>fun</code>函数中创建了一个变量<code>num</code>但是忘记使用<code>var</code>来声明，此时会意想不到地创建一个全局变量并挂载到window对象上，另外还有一种比较隐蔽的方式来创建全局变量：</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fun</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">num</span> = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">fun</span>(); <span class="comment">// 相当于 window.fun()</span></span><br></pre></td></tr></table></div></figure>

<p>当<code>foo</code>函数在调用时，它所指向的运行上下文环境为<code>window</code>全局对象，因此函数中的<code>this</code>指向的其实是<code>window</code>，也就无意创建了一个全局变量。当进行垃圾回收时，在标记阶段因为<code>window</code>对象可以作为根节点，在<code>window</code>上挂载的属性均可以被访问到，并将其标记为活动的从而常驻内存，因此也就不会被垃圾回收，只有在整个进程退出时全局作用域才会被销毁。如果你遇到需要必须使用全局变量的场景，那么请保证一定要在全局变量使用完毕后将其设置为<code>null</code>从而触发回收机制。</p>

        <h3 id="5-2-手动清除定时器"   >
          <a href="#5-2-手动清除定时器" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-2-手动清除定时器" class="headerlink" title="5.2 手动清除定时器"></a>5.2 手动清除定时器</h3>
      <p>在我们的应用中经常会有使用<code>setTimeout</code>或者<code>setInterval</code>等定时器的场景，定时器本身是一个非常有用的功能，但是如果我们稍不注意，忘记在适当的时间手动清除定时器，那么很有可能就会导致内存泄漏，示例如下：</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> numbers = [];</span><br><span class="line"><span class="keyword">var</span> fun = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>;i &lt; <span class="number">100</span>;i++) &#123;</span><br><span class="line">        numbers.<span class="title function_">push</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="variable language_">window</span>.<span class="built_in">setInterval</span>(fun, <span class="number">1000</span>);</span><br></pre></td></tr></table></div></figure>

<p>在这个示例中，由于我们没有手动清除定时器，导致回调任务会不断地执行下去，回调中所引用的<code>numbers</code>变量也不会被垃圾回收，最终导致<code>numbers</code>数组长度无限递增，从而引发内存泄漏。</p>

        <h3 id="5-3-少用闭包"   >
          <a href="#5-3-少用闭包" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-3-少用闭包" class="headerlink" title="5.3 少用闭包"></a>5.3 少用闭包</h3>
      <p>闭包是JS中的一个高级特性，巧妙地利用闭包可以帮助我们实现很多高级功能。一般来说，我们在查找变量时，在本地作用域中查找不到就会沿着作用域链从内向外单向查找，但是闭包的特性可以让我们在外部作用域访问内部作用域中的变量，示例如下：</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> local = <span class="number">123</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> local;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> bar = <span class="title function_">foo</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">bar</span>()); <span class="comment">// -&gt; 123</span></span><br></pre></td></tr></table></div></figure>

<p>在这个示例中，<code>foo</code>函数执行完毕后会返回一个匿名函数，该函数内部引用了<code>foo</code>函数中的局部变量<code>local</code>，并且通过变量<code>bar</code>来引用这个匿名的函数定义，通过这种闭包的方式我们就可以在<code>foo</code>函数的外部作用域中访问到它的局部变量<code>local</code>。一般情况下，当<code>foo</code>函数执行完毕后，它的作用域会被销毁，但是由于存在变量引用其返回的匿名函数，导致作用域无法得到释放，也就导致<code>local</code>变量无法回收，只有当我们取消掉对匿名函数的引用才会进入垃圾回收阶段。</p>

        <h3 id="5-4-清除DOM引用"   >
          <a href="#5-4-清除DOM引用" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-4-清除DOM引用" class="headerlink" title="5.4 清除DOM引用"></a>5.4 清除DOM引用</h3>
      <p>以往我们在操作DOM元素时，为了避免多次获取DOM元素，我们会将DOM元素存储在一个数据字典中，示例如下：</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> elements = &#123;</span><br><span class="line">    <span class="attr">button</span>: <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;button&#x27;</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">removeButton</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">removeChild</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;button&#x27;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>在这个示例中，我们想调用<code>removeButton</code>方法来清除<code>button</code>元素，但是由于在<code>elements</code>字典中存在对<code>button</code>元素的引用，所以即使我们通过<code>removeChild</code>方法移除了<code>button</code>元素，它其实还是依旧存储在内存中无法得到释放，只有我们手动清除对<code>button</code>元素的引用才会被垃圾回收。</p>

        <h3 id="5-5-弱引用"   >
          <a href="#5-5-弱引用" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-5-弱引用" class="headerlink" title="5.5 弱引用"></a>5.5 弱引用</h3>
      <p>在ES6中新增了两个有效的数据结构<code>WeakMap</code>和<code>WeakSet</code>，就是为了解决内存泄漏的问题而诞生的。其表示<code>弱引用</code>，它的键名可以是对象，同时引用的对象均是弱引用，弱引用是指垃圾回收的过程中不会将键名对该对象的引用考虑进去，只要所引用的对象没有其他的引用了，垃圾回收机制就会释放该对象所占用的内存。</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line"> &#123;</span><br><span class="line">      <span class="keyword">let</span> x = &#123;&#125;</span><br><span class="line">      map.<span class="title function_">set</span>(x, <span class="string">&#x27;something&#x27;</span>);</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(map);</span><br></pre></td></tr></table></div></figure>

<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">WeakMap</span>();</span><br><span class="line"> &#123;</span><br><span class="line">      <span class="keyword">let</span> x = &#123;&#125;</span><br><span class="line">      map.<span class="title function_">set</span>(x, <span class="string">&#x27;something&#x27;</span>);</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(map); </span><br></pre></td></tr></table></div></figure>

</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2023/03/24/02_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E4%B8%8E%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/01_%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/">[ Sin título ]</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Creado</span><span class="post-meta-item__value">2023-03-24</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Actualizado</span><span class="post-meta-item__value">2023-02-20</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="数据存储"   >
          <a href="#数据存储" class="heading-link"><i class="fas fa-link"></i></a><a href="#数据存储" class="headerlink" title="数据存储"></a>数据存储</h1>
      
        <h2 id="1-javaScript数据类型"   >
          <a href="#1-javaScript数据类型" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-javaScript数据类型" class="headerlink" title="1. javaScript数据类型"></a>1. javaScript数据类型</h2>
      
        <h3 id="1-1-（6-3）"   >
          <a href="#1-1-（6-3）" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-1-（6-3）" class="headerlink" title="1.1 （6+3）"></a>1.1 （6+3）</h3>
      <p>**值类型(基本类型)**：字符串（String）、数字(Number)、布尔(Boolean)、空（Null）、未定义（Undefined）、Symbol。</p>
<p><strong>引用数据类型（对象类型）</strong>：对象(Object)、数组(Array)、函数(Function)，还有两个特殊的对象：正则（RegExp）和日期（Date）。</p>

        <h2 id="2-判断数据类型的几种方法"   >
          <a href="#2-判断数据类型的几种方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-判断数据类型的几种方法" class="headerlink" title="2. 判断数据类型的几种方法"></a>2. 判断数据类型的几种方法</h2>
      
        <h3 id="2-1-typeof-常用于判断基本数据类型，对于引用数据类型全部返回Object"   >
          <a href="#2-1-typeof-常用于判断基本数据类型，对于引用数据类型全部返回Object" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-1-typeof-常用于判断基本数据类型，对于引用数据类型全部返回Object" class="headerlink" title="2.1 typeof(常用于判断基本数据类型，对于引用数据类型全部返回Object)"></a>2.1 typeof(常用于判断基本数据类型，对于引用数据类型全部返回Object)</h3>
      <ul>
<li><p>语法： typeof   [检测数据]     返回数据的类型名称</p>
</li>
<li><p>特点</p>
<ul>
<li>对于基本类型，除 null 以外，均可以返回正确的结果。</li>
<li>对于引用类型，除 function 以外，一律返回 object 类型。</li>
<li>对于 null ，返回 object 类型。</li>
<li>对于 function 返回  function 类型。</li>
</ul>
</li>
</ul>

        <h3 id="2-2-instanceof（检测某一个实例的原型链上是否有这个类的原型属性）"   >
          <a href="#2-2-instanceof（检测某一个实例的原型链上是否有这个类的原型属性）" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-2-instanceof（检测某一个实例的原型链上是否有这个类的原型属性）" class="headerlink" title="2.2 *instanceof（检测某一个实例的原型链上是否有这个类的原型属性）"></a>2.2 *instanceof（检测某一个实例的原型链上是否有这个类的原型属性）</h3>
      <ul>
<li><p>语法：[监测数据] instanceof [class]  ：返回true或false</p>
</li>
<li><p>特点：</p>
<ul>
<li>可以区分复杂数据类型</li>
<li>只要在当前实例的原型链上，我们用其检测出来的结果都是true</li>
<li>基本类型值检测繁琐，且检测不全(undefined, null, symbol)</li>
</ul>
</li>
<li><p>原理：验证当前类的原型prototype是否会出现在实例的原型链__proto__上，只要在它的原型链上，则结果都为true。因此，<code>instanceof</code> 在查找的过程中会遍历左边变量的原型链，直到找到右边变量的 <code>prototype</code>，找到返回true，未找到返回false</p>
</li>
<li><p>*手写instanceof</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">myinstanceOf_</span>(<span class="params">left, right</span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> proto = left.<span class="property">__proto__</span>;</span><br><span class="line">            <span class="keyword">let</span> prototype = right.<span class="property"><span class="keyword">prototype</span></span></span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (proto == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">                <span class="keyword">if</span> (proto == prototype) <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">                proto = proto.<span class="property">__proto__</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></div></figure></li>
</ul>

        <h3 id="2-3-constructor-用于引用数据类型"   >
          <a href="#2-3-constructor-用于引用数据类型" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-3-constructor-用于引用数据类型" class="headerlink" title="2.3 constructor (用于引用数据类型)"></a>2.3 constructor (用于引用数据类型)</h3>
      <ul>
<li>语法： 检测数据.constructor &#x3D;&#x3D;&#x3D; class</li>
<li>特点：<ul>
<li>适合使用在引用数据类型上</li>
<li>原型链不会干扰</li>
</ul>
</li>
<li>原理：构造函数原型上有一个 constructor 属性指向构造函数自身的，如果在实例上使用 construtor 时，就会直接使用其构造函数原型的上的该属性，并指向其构造函数。</li>
</ul>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> person1 = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;Alice&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person1.<span class="property">constructor</span> === <span class="title class_">Person</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></div></figure>


        <h3 id="2-4-Object-prototype-toString-call-（对象原型链判断方法）"   >
          <a href="#2-4-Object-prototype-toString-call-（对象原型链判断方法）" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-4-Object-prototype-toString-call-（对象原型链判断方法）" class="headerlink" title="2.4 Object.prototype.toString.call()（对象原型链判断方法）"></a>2.4 Object.prototype.toString.call()（对象原型链判断方法）</h3>
      <ul>
<li>语法：Object.prototype.toString.call(检测数据)   </li>
<li>特点：适用于所有类型的判断检测</li>
<li>原理：Object.prototype.toString 表示一个返回对象类型的字符串，call()方法可以改变this的指向，那么把Object.prototype.toString()方法指向不同的数据类型上面，返回不同的结果</li>
</ul>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//由于 JavaScript 的类型检测不够严格，例如 typeof null 返回的是 &quot;object&quot;，而不是 &quot;null&quot;，因此 Object.prototype.toString.call() 方法经常用于确定对象的确切类型。以下是一些常见的用法示例</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>([]); <span class="comment">// &quot;[object Array]&quot;</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(&#123;&#125;); <span class="comment">// &quot;[object Object]&quot;</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(<span class="literal">null</span>); <span class="comment">// &quot;[object Null]&quot;</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(<span class="literal">undefined</span>); <span class="comment">// &quot;[object Undefined]&quot;</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(<span class="number">123</span>); <span class="comment">// &quot;[object Number]&quot;</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(<span class="string">&quot;hello&quot;</span>); <span class="comment">// &quot;[object String]&quot;</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(<span class="literal">true</span>); <span class="comment">// &quot;[object Boolean]&quot;</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;); <span class="comment">// &quot;[object Function]&quot;</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(<span class="keyword">new</span> <span class="title class_">Date</span>()); <span class="comment">// &quot;[object Date]&quot;</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(<span class="regexp">/regex/</span>); <span class="comment">// &quot;[object RegExp]&quot;</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(<span class="keyword">new</span> <span class="title class_">Map</span>()); <span class="comment">// &quot;[object Map]&quot;</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(<span class="keyword">new</span> <span class="title class_">Set</span>()); <span class="comment">// &quot;[object Set]&quot;</span></span><br></pre></td></tr></table></div></figure>


        <h2 id="3-内存空间"   >
          <a href="#3-内存空间" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-内存空间" class="headerlink" title="3. 内存空间"></a>3. 内存空间</h2>
      
        <h3 id="3-1-内存空间分配"   >
          <a href="#3-1-内存空间分配" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-1-内存空间分配" class="headerlink" title="3.1 内存空间分配"></a>3.1 内存空间分配</h3>
      <p>在 JavaScript 的执行过程中， 主要有三种类型内存空间，分别是<strong>代码空间、栈空间和堆空间</strong>。</p>
<p><strong>代码空间主要是存储可执行代码</strong></p>
<img src="img\02.png" style="zoom:33%;" />


        <h3 id="3-2-栈和堆空间"   >
          <a href="#3-2-栈和堆空间" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-2-栈和堆空间" class="headerlink" title="3.2 栈和堆空间"></a>3.2 栈和堆空间</h3>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>)&#123; </span><br><span class="line">	<span class="keyword">var</span> a = <span class="string">&quot;闷倒驴&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> b = a;</span><br><span class="line">    <span class="keyword">var</span> c = &#123;<span class="attr">name</span>:<span class="string">&quot;王美丽&quot;</span>&#125;;</span><br><span class="line">    <span class="keyword">var</span> d = c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">foo</span>()</span><br></pre></td></tr></table></div></figure>

<p><img src="/img%5C03.png" alt="image-20210419170906123"></p>
<p><strong>为什么不能把存储在堆中的数据存储在栈中？</strong></p>
<p>因为 JavaScript 引擎需要用栈来维护程序执行期间上下文的状态，如果栈空间大了话，所有的数据都存放在栈空间里面，那么会影响到上下文切换的效率，进而又影响到整个程序的执行效率。</p>
<p><strong>堆栈特点</strong></p>
<ul>
<li><p><strong>栈</strong>空间都不会设置太大，主要用来<strong>存放一些原始类型的小数据</strong>。而<strong>引用类型的数据</strong>占用的空间都比较大，所以这一类数据会被存放到<strong>堆</strong>中，堆空间很大，能存放很多大的数据，不过缺点是分配内存和回收内存都会占用一定的时间</p>
</li>
<li><p>原始类型的赋值会完整复制变量值，而引用类型的赋值是复制引用地址</p>
</li>
</ul>

        <h3 id="3-3-数据的赋值与引用数据类型的深浅拷贝"   >
          <a href="#3-3-数据的赋值与引用数据类型的深浅拷贝" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-3-数据的赋值与引用数据类型的深浅拷贝" class="headerlink" title="3.3 数据的赋值与引用数据类型的深浅拷贝"></a>3.3 数据的赋值与引用数据类型的深浅拷贝</h3>
      <p><strong>赋值</strong>：简单数据类型直接在栈中开辟一块新的内存，存储赋值的数据；引用数据类型，在栈中开辟一块空间，存储赋值的数据对应的堆中的存储地址，源数据和拷贝的新数据对应的是同一块堆空间中的数据</p>
<p><strong>浅拷贝</strong>：堆栈各开辟一块新空间，栈中存储堆中新开辟的空间的地址，堆中赋值了源数据的数据，如果值是基本数据类型那么新数据和源数据没有任何关系，如果值是引用数据类型那么新数据的值指向的源数据的数据存储地址</p>
<p><strong>深拷贝</strong>：堆栈各开辟一块新空间，栈中存储堆中新开辟的空间的地址，堆中存储的数据和源数据一样，但是二者没有任何联系</p>
<p>赋值例子：</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> user = &#123;<span class="attr">userName</span>:<span class="string">&#x27;闷倒驴&#x27;</span>,<span class="attr">sex</span>:<span class="string">&#x27;女&#x27;</span>,<span class="attr">body</span>:&#123;<span class="attr">weight</span>:<span class="string">&#x27;50kg&#x27;</span>,<span class="attr">height</span>:<span class="string">&#x27;160&#x27;</span>&#125;&#125;</span><br><span class="line"><span class="comment">// 赋值</span></span><br><span class="line"><span class="keyword">var</span> userCopy = user;</span><br><span class="line">user.<span class="property">sex</span> = <span class="string">&#x27;男&#x27;</span>;</span><br><span class="line">user.<span class="property">body</span>.<span class="property">weight</span> = <span class="string">&#x27;100斤&#x27;</span>;</span><br></pre></td></tr></table></div></figure>

<img src="img\10.png" alt="image-20210607171856700" style="zoom: 50%;" />

<p><strong>浅拷贝例子：</strong></p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> user = &#123;<span class="attr">userName</span>:<span class="string">&#x27;闷倒驴&#x27;</span>,<span class="attr">sex</span>:<span class="string">&#x27;女&#x27;</span>,<span class="attr">body</span>:&#123;<span class="attr">weight</span>:<span class="string">&#x27;50kg&#x27;</span>,<span class="attr">height</span>:<span class="string">&#x27;160&#x27;</span>&#125;&#125;</span><br><span class="line"><span class="comment">// 浅拷贝</span></span><br><span class="line"><span class="keyword">var</span> userCopy = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, user);  <span class="comment">//Object.assign 对象合并</span></span><br><span class="line">user.<span class="property">sex</span> = <span class="string">&#x27;男&#x27;</span>;</span><br><span class="line">user.<span class="property">body</span>.<span class="property">weight</span> = <span class="string">&#x27;100斤&#x27;</span>;</span><br></pre></td></tr></table></div></figure>

<p>当执行完userCopy浅拷贝之后，内存空间如图所示：</p>
<p><img src="/img%5C04.png" alt="image-20210426144901358"></p>
<p>执行完   user.sex &#x3D; ‘男’; user.body.weight &#x3D; ‘100斤’;  之后，如下图所示</p>
<p><img src="/img%5C05.png" alt="image-20210426145839124"></p>
<p><strong>深拷贝例子：</strong></p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> user = &#123; <span class="attr">userName</span>: <span class="string">&#x27;闷倒驴&#x27;</span>, <span class="attr">sex</span>: <span class="string">&#x27;女&#x27;</span>, <span class="attr">body</span>: &#123; <span class="attr">weight</span>: <span class="string">&#x27;50kg&#x27;</span>, <span class="attr">height</span>: <span class="string">&#x27;160&#x27;</span> &#125; &#125;</span><br><span class="line"><span class="comment">// 深拷贝</span></span><br><span class="line"><span class="keyword">var</span> userCopy = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(user));  <span class="comment">//深拷贝</span></span><br><span class="line">	<span class="comment">//JSON.stringify() 转为json字符串。JSON.parse() 再转为JS对象。</span></span><br><span class="line">user.<span class="property">sex</span> = <span class="string">&#x27;男&#x27;</span>;</span><br><span class="line">user.<span class="property">body</span>.<span class="property">weight</span> = <span class="string">&#x27;100斤&#x27;</span>;</span><br></pre></td></tr></table></div></figure>

<p>当执行完userCopy深拷贝之后，内存空间如图所示：</p>
<p><img src="/img%5C08.png" alt="image-20210426154620250"></p>
<p>当执行完userCopy深拷贝之后，内存空间如图所示：</p>
<p><img src="/img%5C09.png" alt="image-20210426154800915"></p>

        <h4 id="浅拷贝方法："   >
          <a href="#浅拷贝方法：" class="heading-link"><i class="fas fa-link"></i></a><a href="#浅拷贝方法：" class="headerlink" title="浅拷贝方法："></a><strong>浅拷贝方法</strong>：</h4>
      
        <h5 id="1-Object-assign-x2F-x2F-对象的操作多涉及到浅拷贝"   >
          <a href="#1-Object-assign-x2F-x2F-对象的操作多涉及到浅拷贝" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-Object-assign-x2F-x2F-对象的操作多涉及到浅拷贝" class="headerlink" title="1.Object.assign()   &#x2F;&#x2F;对象的操作多涉及到浅拷贝"></a>1.Object.assign()   &#x2F;&#x2F;对象的操作多涉及到浅拷贝</h5>
      <p>Object.assign() 方法可以把任意多个的源对象自身的可枚举属性拷贝给目标对象，然后返回目标对象。</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj1 = &#123; <span class="attr">person</span>: &#123;<span class="attr">name</span>: <span class="string">&quot;kobe&quot;</span>, <span class="attr">age</span>: <span class="number">41</span>&#125;,<span class="attr">sports</span>:<span class="string">&#x27;basketball&#x27;</span> &#125;;</span><br><span class="line"><span class="keyword">let</span> obj2 = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, obj1);</span><br><span class="line">obj2.<span class="property">person</span>.<span class="property">name</span> = <span class="string">&quot;wade&quot;</span>;</span><br><span class="line">obj2.<span class="property">sports</span> = <span class="string">&#x27;football&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj1); <span class="comment">// &#123; person: &#123; name: &#x27;wade&#x27;, age: 41 &#125;, sports: &#x27;basketball&#x27; &#125;</span></span><br></pre></td></tr></table></div></figure>


        <h5 id="2-函数库lodash的-clone方法"   >
          <a href="#2-函数库lodash的-clone方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-函数库lodash的-clone方法" class="headerlink" title="2.函数库lodash的_.clone方法"></a>2.函数库lodash的_.clone方法</h5>
      <p>该函数库也有提供_.clone用来做 Shallow Copy,后面我们会再介绍利用这个库实现深拷贝。</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> _ = <span class="built_in">require</span>(<span class="string">&#x27;lodash&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> obj1 = &#123;</span><br><span class="line">    <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">b</span>: &#123; <span class="attr">f</span>: &#123; <span class="attr">g</span>: <span class="number">1</span> &#125; &#125;,</span><br><span class="line">    <span class="attr">c</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> obj2 = _.<span class="title function_">clone</span>(obj1);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj1.<span class="property">b</span>.<span class="property">f</span> === obj2.<span class="property">b</span>.<span class="property">f</span>);<span class="comment">// true</span></span><br></pre></td></tr></table></div></figure>


        <h5 id="3-展开运算符…"   >
          <a href="#3-展开运算符…" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-展开运算符…" class="headerlink" title="3.展开运算符…"></a>3.展开运算符…</h5>
      <p>展开运算符是一个 es6 &#x2F; es2015特性，它提供了一种非常方便的方式来执行浅拷贝，这与 Object.assign ()的功能相同。</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj1 = &#123; <span class="attr">name</span>: <span class="string">&#x27;王美丽&#x27;</span>, <span class="attr">address</span>: &#123; <span class="attr">x</span>: <span class="number">100</span>, <span class="attr">y</span>: <span class="number">100</span> &#125; &#125;</span><br><span class="line"><span class="keyword">let</span> obj2 = &#123; ...obj1 &#125;</span><br><span class="line">obj1.<span class="property">address</span>.<span class="property">x</span> = <span class="number">200</span>;</span><br><span class="line">obj1.<span class="property">name</span> = <span class="string">&#x27;闷倒驴&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;obj2&#x27;</span>, obj2) <span class="comment">// obj2 &#123; name: &#x27;Kobe&#x27;, address: &#123; x: 200, y: 100 &#125; &#125;</span></span><br></pre></td></tr></table></div></figure>


        <h5 id="4-Array-prototype-concat"   >
          <a href="#4-Array-prototype-concat" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-Array-prototype-concat" class="headerlink" title="4.Array.prototype.concat()"></a>4.Array.prototype.concat()</h5>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">3</span>, &#123;</span><br><span class="line">    <span class="attr">username</span>: <span class="string">&#x27;王美丽&#x27;</span></span><br><span class="line">&#125;];</span><br><span class="line"><span class="keyword">let</span> arr2 = arr.<span class="title function_">concat</span>();</span><br><span class="line">arr2[<span class="number">2</span>].<span class="property">username</span> = <span class="string">&#x27;闷倒驴&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr); <span class="comment">//[ 1, 3, &#123; username: &#x27;闷倒驴&#x27; &#125; ]</span></span><br></pre></td></tr></table></div></figure>


        <h5 id="5-Array-prototype-slice"   >
          <a href="#5-Array-prototype-slice" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-Array-prototype-slice" class="headerlink" title="5.Array.prototype.slice()"></a>5.Array.prototype.slice()</h5>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">3</span>, &#123;</span><br><span class="line">    <span class="attr">username</span>: <span class="string">&#x27; 王美丽&#x27;</span></span><br><span class="line">&#125;];</span><br><span class="line"><span class="keyword">let</span> arr3 = arr.<span class="title function_">slice</span>();</span><br><span class="line">arr3[<span class="number">2</span>].<span class="property">username</span> = <span class="string">&#x27;闷倒驴&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr); <span class="comment">// [ 1, 3, &#123; username: &#x27;闷倒驴&#x27; &#125; ]</span></span><br></pre></td></tr></table></div></figure>


        <h4 id="深拷贝方法："   >
          <a href="#深拷贝方法：" class="heading-link"><i class="fas fa-link"></i></a><a href="#深拷贝方法：" class="headerlink" title="深拷贝方法："></a>深拷贝方法：</h4>
      
        <h5 id="1-JSON-parse-JSON-stringify"   >
          <a href="#1-JSON-parse-JSON-stringify" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-JSON-parse-JSON-stringify" class="headerlink" title="1.JSON.parse(JSON.stringify())"></a>1.JSON.parse(JSON.stringify())</h5>
      <figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">3</span>, &#123;</span><br><span class="line">    <span class="attr">username</span>: <span class="string">&#x27;闷倒驴&#x27;</span></span><br><span class="line">&#125;];</span><br><span class="line"><span class="keyword">let</span> arr1 = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(arr));</span><br><span class="line">arr1[<span class="number">2</span>].<span class="property">username</span> = <span class="string">&#x27;王美丽&#x27;</span>; </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr, arr1)</span><br></pre></td></tr></table></div></figure>

<p><img src="/img%5C07.png" alt="image-20210419183131174"></p>
<p>这也是利用JSON.stringify将对象转成JSON字符串，再用JSON.parse把字符串解析成对象，一去一来，新的对象产生了，而且对象会开辟新的栈，实现深拷贝。</p>
<p><strong>这种方法虽然可以实现数组或对象深拷贝,但不能处理函数和正则</strong>，因为这两者基于JSON.stringify和JSON.parse处理后，得到的正则就不再是正则（变为空对象），得到的函数就不再是函数（变为null）了。</p>
<p>比如下面的例子：</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">3</span>, &#123;</span><br><span class="line">    <span class="attr">username</span>: <span class="string">&#x27;闷倒驴&#x27;</span></span><br><span class="line">&#125;,<span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;];</span><br><span class="line"><span class="keyword">let</span> arr1 = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(arr));</span><br><span class="line">arr1[<span class="number">2</span>].<span class="property">username</span> = <span class="string">&#x27;王美丽&#x27;</span>; </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr, arr1)</span><br></pre></td></tr></table></div></figure>

<p><img src="/img%5C06.png" alt="image-20210419183036305"></p>

        <h5 id="2-函数库lodash的-cloneDeep方法"   >
          <a href="#2-函数库lodash的-cloneDeep方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-函数库lodash的-cloneDeep方法" class="headerlink" title="2.函数库lodash的_.cloneDeep方法"></a>2.函数库lodash的_.cloneDeep方法</h5>
      <p>该函数库也有提供_.cloneDeep用来做 Deep Copy</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> _ = <span class="built_in">require</span>(<span class="string">&#x27;lodash&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> obj1 = &#123;</span><br><span class="line">    <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">b</span>: &#123; <span class="attr">f</span>: &#123; <span class="attr">g</span>: <span class="number">1</span> &#125; &#125;,</span><br><span class="line">    <span class="attr">c</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> obj2 = _.<span class="title function_">cloneDeep</span>(obj1);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj1.<span class="property">b</span>.<span class="property">f</span> === obj2.<span class="property">b</span>.<span class="property">f</span>);<span class="comment">// false</span></span><br></pre></td></tr></table></div></figure>


        <h5 id="3-jQuery-extend-方法"   >
          <a href="#3-jQuery-extend-方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-jQuery-extend-方法" class="headerlink" title="3.jQuery.extend()方法"></a>3.jQuery.extend()方法</h5>
      <p>jquery 有提供一個<code>$.extend</code>可以用来做 Deep Copy</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// $.extend(deepCopy, target, object1, [objectN])//第一个参数为true,就是深拷贝</span></span><br><span class="line"><span class="keyword">var</span> $ = <span class="built_in">require</span>(<span class="string">&#x27;jquery&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> obj1 = &#123;</span><br><span class="line">    <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">b</span>: &#123; <span class="attr">f</span>: &#123; <span class="attr">g</span>: <span class="number">1</span> &#125; &#125;,</span><br><span class="line">    <span class="attr">c</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> obj2 = $.<span class="title function_">extend</span>(<span class="literal">true</span>, &#123;&#125;, obj1);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj1.<span class="property">b</span>.<span class="property">f</span> === obj2.<span class="property">b</span>.<span class="property">f</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></div></figure>


        <h5 id="4-手写递归方法"   >
          <a href="#4-手写递归方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-手写递归方法" class="headerlink" title="4.手写递归方法"></a>4.手写递归方法</h5>
      <p>递归方法实现深度克隆原理：<strong>遍历对象、数组直到里边都是基本数据类型，然后再去复制，就是深度拷贝</strong>。</p>
<p>有种特殊情况需注意就是对象存在<strong>循环引用</strong>的情况，即对象的属性直接的引用了自身的情况，解决循环引用问题，我们可以额外开辟一个存储空间，来存储当前对象和拷贝对象的对应关系，当需要拷贝当前对象时，先去存储空间中找，有没有拷贝过这个对象，如果有的话直接返回，如果没有的话继续拷贝，这样就巧妙化解的循环引用的问题。</p>
<figure class="highlight javascript"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">deepClone</span>(<span class="params">obj, hash = <span class="keyword">new</span> <span class="built_in">WeakMap</span>()</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (obj === <span class="literal">null</span>) <span class="keyword">return</span> obj; <span class="comment">// 如果是null或者undefined我就不进行拷贝操作</span></span><br><span class="line">  <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> <span class="title class_">Date</span>) <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Date</span>(obj);</span><br><span class="line">  <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> <span class="title class_">RegExp</span>) <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RegExp</span>(obj);</span><br><span class="line">  <span class="comment">// 可能是对象或者普通的值  如果是函数的话是不需要深拷贝</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> obj !== <span class="string">&quot;object&quot;</span>) <span class="keyword">return</span> obj;</span><br><span class="line">  <span class="comment">// 是对象的话就要进行深拷贝,遇到循环引用，将引用存储起来，如果存在就不再拷贝</span></span><br><span class="line">  <span class="keyword">if</span> (hash.<span class="title function_">get</span>(obj)) <span class="keyword">return</span> hash.<span class="title function_">get</span>(obj);</span><br><span class="line">  <span class="keyword">let</span> cloneObj = <span class="keyword">new</span> obj.<span class="title function_">constructor</span>(<span class="params"></span>);</span><br><span class="line">  <span class="comment">// 找到的是所属类原型上的constructor,而原型上的 constructor指向的是当前类本身</span></span><br><span class="line">  hash.<span class="title function_">set</span>(obj, cloneObj);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">    <span class="keyword">if</span> (obj.<span class="title function_">hasOwnProperty</span>(key)) &#123;</span><br><span class="line">      <span class="comment">// 实现一个递归拷贝</span></span><br><span class="line">      cloneObj[key] = <span class="title function_">deepClone</span>(obj[key], hash);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> cloneObj;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">name</span>: <span class="number">1</span>, <span class="attr">address</span>: &#123; <span class="attr">x</span>: <span class="number">100</span> &#125; &#125;;</span><br><span class="line">obj.<span class="property">o</span> = obj; <span class="comment">// 对象存在循环引用的情况</span></span><br><span class="line"><span class="keyword">let</span> d = <span class="title function_">deepClone</span>(obj);</span><br><span class="line">obj.<span class="property">address</span>.<span class="property">x</span> = <span class="number">200</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(d);</span><br></pre></td></tr></table></div></figure>

<p><strong>循环引用</strong>：</p>
<p>当对象 1 中的某个属性指向对象 2，对象 2 中的某个属性指向对象 1 就会出现循环引用，（当然不止这一种情况，不过原理是一样的）</p>
</div></div></article></section><nav class="paginator"><div class="paginator-inner"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fas fa-angle-right"></i></a></div></nav></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><section class="sidebar-toc hide"></section><!-- ov = overview--><section class="sidebar-ov"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/icons/cat.jpg" alt="avatar"></div><p class="sidebar-ov-author__text">Hello Stun</p></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">15</div><div class="sidebar-ov-state-item__name">Archivo</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="Creative Commons" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2023</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>汪汪队</span></div><div><span>Potenciado por <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a></span><span> v6.3.0</span><span class="footer__devider">|</span><span>Tema - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.8.0</span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="/js/utils.js?v=2.8.0"></script><script src="/js/stun-boot.js?v=2.8.0"></script><script src="/js/scroll.js?v=2.8.0"></script><script src="/js/header.js?v=2.8.0"></script><script src="/js/sidebar.js?v=2.8.0"></script></body></html>